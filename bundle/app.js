(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.moduleBundle=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BasicExample=void 0;var math_1=require("@daign/math");var _2d_graphics_1=require("@daign/2d-graphics");var _2d_graphics_svg_1=require("@daign/2d-graphics-svg");var polylineControl_1=require("./polylineControl");var drawing_style_1=require("./drawing.style");var BasicExample=function(){function BasicExample(){var _this=this;this.svgContext=new _2d_graphics_svg_1.SvgContext;this.svgContext.size=new math_1.Vector2(800,600);document.body.appendChild(this.svgContext.domNode);this.application=new _2d_graphics_1.Application(this.svgContext,true);this.view=new _2d_graphics_1.ApplicationView(this.application);var rendererFactory=new _2d_graphics_svg_1.RendererFactory;this.renderer=rendererFactory.createRenderer(drawing_style_1.styleSheet);this.renderer.useNativeTransforms=true;this.renderer.flattenGroups=true;this.renderer.useInlineStyles=true;this.constructGraphic();this.drawGraphic();this.application.updateManager.setRenderFunction(function(){_this.drawGraphic()})}BasicExample.prototype.constructGraphic=function(){this.application.drawingLayer.clearChildren();var points=[new math_1.Vector2(2,12),new math_1.Vector2(2,8),new math_1.Vector2(0,8),new math_1.Vector2(8,0),new math_1.Vector2(11,3),new math_1.Vector2(11,0),new math_1.Vector2(13,0),new math_1.Vector2(13,5),new math_1.Vector2(16,8),new math_1.Vector2(14,8),new math_1.Vector2(14,12),new math_1.Vector2(9,12),new math_1.Vector2(9,9),new math_1.Vector2(7,9),new math_1.Vector2(7,12),new math_1.Vector2(4,12)];var polyline=new polylineControl_1.PolylineControl(points);this.application.drawingLayer.appendChild(polyline);var text=new _2d_graphics_1.ScalableText;text.anchor=new math_1.Vector2(8,15);text.fontSize=1.5;text.content="Click on the line to show the controls.";text.textAnchor="middle";this.application.drawingLayer.appendChild(text);this.application.fitToContent(2);this.view.mountNode(this.application)};BasicExample.prototype.drawGraphic=function(){this.renderer.render(this.view,this.svgContext.contentNode)};return BasicExample}();exports.BasicExample=BasicExample},{"./drawing.style":2,"./polylineControl":3,"@daign/2d-graphics":106,"@daign/2d-graphics-svg":44,"@daign/math":135}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.styleSheet=void 0;var style_sheets_1=require("@daign/style-sheets");var _2d_graphics_1=require("@daign/2d-graphics");exports.styleSheet=new style_sheets_1.StyleSheet;exports.styleSheet.parseFromString(".polyline {\n    fill: none;\n    stroke: #6699ff;\n    stroke-width: 0.5;\n  }\n  .control-layer {\n    .controlPoint {\n      fill: #ff0000;\n    }\n  }",_2d_graphics_1.GraphicStyle)},{"@daign/2d-graphics":106,"@daign/style-sheets":156}],3:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.PolylineControl=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var PolylineControl=function(_super){__extends(PolylineControl,_super);function PolylineControl(points){var _this=_super.call(this)||this;_this.points.elements=points;return _this}PolylineControl.prototype.redraw=function(){_super.prototype.redraw.call(this);var polyline=new _2d_graphics_1.Polyline;this.appendChild(polyline);polyline.points.copyElements(this.points)};return PolylineControl}(_2d_graphics_1.ControlObject);exports.PolylineControl=PolylineControl},{"@daign/2d-graphics":106}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CircleControlsExample=void 0;var math_1=require("@daign/math");var _2d_graphics_1=require("@daign/2d-graphics");var _2d_graphics_svg_1=require("@daign/2d-graphics-svg");var circleWithRadiusControl_1=require("./circleWithRadiusControl");var circleWithDiameterControl_1=require("./circleWithDiameterControl");var threePointCircleControl_1=require("./threePointCircleControl");var drawing_style_1=require("./drawing.style");var CircleControlsExample=function(){function CircleControlsExample(){var _this=this;this.svgContext=new _2d_graphics_svg_1.SvgContext;this.svgContext.size=new math_1.Vector2(800,600);document.body.appendChild(this.svgContext.domNode);this.application=new _2d_graphics_1.Application(this.svgContext,true);this.view=new _2d_graphics_1.ApplicationView(this.application);var rendererFactory=new _2d_graphics_svg_1.RendererFactory;this.renderer=rendererFactory.createRenderer(drawing_style_1.styleSheet);this.renderer.useNativeTransforms=true;this.renderer.flattenGroups=true;this.renderer.useInlineStyles=true;this.constructGraphic();this.drawGraphic();this.application.updateManager.setRenderFunction(function(){_this.drawGraphic()})}CircleControlsExample.prototype.constructGraphic=function(){this.application.drawingLayer.clearChildren();var circle1=new circleWithRadiusControl_1.CircleWithRadiusControl(new math_1.Vector2(-6,0),new math_1.Vector2(-7,-2));this.application.drawingLayer.appendChild(circle1);var circle2=new circleWithDiameterControl_1.CircleWithDiameterControl([new math_1.Vector2(-1,-2),new math_1.Vector2(1,2)]);this.application.drawingLayer.appendChild(circle2);var circle3=new threePointCircleControl_1.ThreePointCircleControl([new math_1.Vector2(5,-2),new math_1.Vector2(5,2),new math_1.Vector2(8,-1)]);this.application.drawingLayer.appendChild(circle3);var text=new _2d_graphics_1.ScalableText;text.anchor=new math_1.Vector2(0,5);text.fontSize=1;text.content="Click on a circle to show the controls.";text.textAnchor="middle";this.application.drawingLayer.appendChild(text);this.application.fitToContent(2);this.view.mountNode(this.application)};CircleControlsExample.prototype.drawGraphic=function(){this.renderer.render(this.view,this.svgContext.contentNode)};return CircleControlsExample}();exports.CircleControlsExample=CircleControlsExample},{"./circleWithDiameterControl":5,"./circleWithRadiusControl":6,"./drawing.style":7,"./threePointCircleControl":8,"@daign/2d-graphics":106,"@daign/2d-graphics-svg":44,"@daign/math":135}],5:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.CircleWithDiameterControl=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var CircleWithDiameterControl=function(_super){__extends(CircleWithDiameterControl,_super);function CircleWithDiameterControl(points){var _this=_super.call(this)||this;_this.baseClass="circle-with-diameter";_this.points.elements=points;return _this}CircleWithDiameterControl.prototype.redraw=function(){_super.prototype.redraw.call(this);var circle=new _2d_graphics_1.TwoPointCircle;this.appendChild(circle);if(this.points.length>=2){var point1=this.points.getElement(0);var point2=this.points.getElement(1);var center=point1.clone().add(point2).multiplyScalar(.5);circle.center=center;circle.circlePoint=point1}};return CircleWithDiameterControl}(_2d_graphics_1.ControlObject);exports.CircleWithDiameterControl=CircleWithDiameterControl},{"@daign/2d-graphics":106}],6:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.CircleWithRadiusControl=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var CircleWithRadiusControl=function(_super){__extends(CircleWithRadiusControl,_super);function CircleWithRadiusControl(center,circlePoint){var _this=_super.call(this)||this;_this.baseClass="circle-with-radius";_this.points.elements=[center,circlePoint];return _this}CircleWithRadiusControl.prototype.redraw=function(){_super.prototype.redraw.call(this);var circle=new _2d_graphics_1.TwoPointCircle;this.appendChild(circle);var center=this.points.getElement(0);if(center!==undefined){circle.center=center}var circlePoint=this.points.getElement(1);if(circlePoint!==undefined){circle.circlePoint=circlePoint}};return CircleWithRadiusControl}(_2d_graphics_1.ControlObject);exports.CircleWithRadiusControl=CircleWithRadiusControl},{"@daign/2d-graphics":106}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.styleSheet=void 0;var style_sheets_1=require("@daign/style-sheets");var _2d_graphics_1=require("@daign/2d-graphics");exports.styleSheet=new style_sheets_1.StyleSheet;exports.styleSheet.parseFromString(".circle-with-radius {\n    fill: #99ccff;\n    stroke: #6699ff;\n    stroke-width: 0.2;\n  }\n  .circle-with-diameter {\n    fill: #ff99cc;\n    stroke: #ff6699;\n    stroke-width: 0.2;\n  }\n  .three-point-circle {\n    fill: #ccff99;\n    stroke: #99ff66;\n    stroke-width: 0.2;\n  }\n  .control-layer {\n    .controlPoint {\n      fill: #ff0000;\n    }\n  }",_2d_graphics_1.GraphicStyle)},{"@daign/2d-graphics":106,"@daign/style-sheets":156}],8:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ThreePointCircleControl=void 0;var math_1=require("@daign/math");var _2d_graphics_1=require("@daign/2d-graphics");var ThreePointCircleControl=function(_super){__extends(ThreePointCircleControl,_super);function ThreePointCircleControl(points){var _this=_super.call(this)||this;_this.baseClass="three-point-circle";_this.points.elements=points;return _this}ThreePointCircleControl.prototype.redraw=function(){_super.prototype.redraw.call(this);var circle=new _2d_graphics_1.TwoPointCircle;this.appendChild(circle);if(this.points.length>=3){var triangle=new math_1.Triangle2(this.points.getElement(0),this.points.getElement(1),this.points.getElement(2));var center=triangle.getCircumcenter();if(center!==null){circle.center=center;circle.circlePoint=this.points.getElement(0)}}};return ThreePointCircleControl}(_2d_graphics_1.ControlObject);exports.ThreePointCircleControl=ThreePointCircleControl},{"@daign/2d-graphics":106,"@daign/math":135}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ControlModifiersExample=void 0;var math_1=require("@daign/math");var _2d_pipeline_1=require("@daign/2d-pipeline");var _2d_graphics_1=require("@daign/2d-graphics");var _2d_graphics_svg_1=require("@daign/2d-graphics-svg");var polylineControl_1=require("./polylineControl");var drawing_style_1=require("./drawing.style");var ControlModifiersExample=function(){function ControlModifiersExample(){var _this=this;this.svgContext=new _2d_graphics_svg_1.SvgContext;this.svgContext.size=new math_1.Vector2(800,600);document.body.appendChild(this.svgContext.domNode);this.application=new _2d_graphics_1.Application(this.svgContext,true);this.view=new _2d_graphics_1.ApplicationView(this.application);var rendererFactory=new _2d_graphics_svg_1.RendererFactory;this.renderer=rendererFactory.createRenderer(drawing_style_1.styleSheet);this.renderer.useNativeTransforms=true;this.renderer.flattenGroups=true;this.renderer.useInlineStyles=true;this.constructGraphic();this.drawGraphic();this.application.updateManager.setRenderFunction(function(){_this.drawGraphic()})}ControlModifiersExample.prototype.constructGraphic=function(){this.application.drawingLayer.clearChildren();var generatePoints=function(){return[new math_1.Vector2(2,12),new math_1.Vector2(2,8),new math_1.Vector2(0,8),new math_1.Vector2(8,0),new math_1.Vector2(11,3),new math_1.Vector2(11,0),new math_1.Vector2(13,0),new math_1.Vector2(13,5),new math_1.Vector2(16,8),new math_1.Vector2(14,8),new math_1.Vector2(14,12),new math_1.Vector2(9,12),new math_1.Vector2(9,9),new math_1.Vector2(7,9),new math_1.Vector2(7,12),new math_1.Vector2(4,12)]};var polyline1=new polylineControl_1.PolylineControl(generatePoints());this.application.drawingLayer.appendChild(polyline1);var polyline2=new polylineControl_1.PolylineControl(generatePoints());polyline2.controlModifier=new _2d_graphics_1.FollowAlongModifier;var matrixTransform=new _2d_pipeline_1.MatrixTransform;matrixTransform.matrix.applyTranslation(new math_1.Vector2(20,0));polyline2.transformation.push(matrixTransform);this.application.drawingLayer.appendChild(polyline2);var polyline3=new polylineControl_1.PolylineControl(generatePoints());var modifierChain=new _2d_graphics_1.ControlModifierChain;modifierChain.addModifier(new _2d_graphics_1.OrthogonalModifier);modifierChain.addModifier(new _2d_graphics_1.FollowAlongModifier);polyline3.controlModifier=modifierChain;var matrixTransform2=new _2d_pipeline_1.MatrixTransform;matrixTransform2.matrix.applyTranslation(new math_1.Vector2(0,18));polyline3.transformation.push(matrixTransform2);this.application.drawingLayer.appendChild(polyline3);var polyline4=new polylineControl_1.PolylineControl(generatePoints());polyline4.controlModifier=new _2d_graphics_1.RoundingModifier(0);var matrixTransform3=new _2d_pipeline_1.MatrixTransform;matrixTransform3.matrix.applyTranslation(new math_1.Vector2(20,18));polyline4.transformation.push(matrixTransform3);this.application.drawingLayer.appendChild(polyline4);var text1=new _2d_graphics_1.ScalableText;text1.anchor=new math_1.Vector2(8,15);text1.fontSize=1.5;text1.content="no modifier";text1.textAnchor="middle";this.application.drawingLayer.appendChild(text1);var text2=new _2d_graphics_1.ScalableText;text2.anchor=new math_1.Vector2(28,15);text2.fontSize=1.5;text2.content="follow along";text2.textAnchor="middle";this.application.drawingLayer.appendChild(text2);var text3=new _2d_graphics_1.ScalableText;text3.anchor=new math_1.Vector2(8,33);text3.fontSize=1.5;text3.content="orthogonal";text3.textAnchor="middle";this.application.drawingLayer.appendChild(text3);var text4=new _2d_graphics_1.ScalableText;text4.anchor=new math_1.Vector2(28,33);text4.fontSize=1.5;text4.content="grid";text4.textAnchor="middle";this.application.drawingLayer.appendChild(text4);this.application.fitToContent(2);this.view.mountNode(this.application)};ControlModifiersExample.prototype.drawGraphic=function(){this.renderer.render(this.view,this.svgContext.contentNode)};return ControlModifiersExample}();exports.ControlModifiersExample=ControlModifiersExample},{"./drawing.style":10,"./polylineControl":11,"@daign/2d-graphics":106,"@daign/2d-graphics-svg":44,"@daign/2d-pipeline":110,"@daign/math":135}],10:[function(require,module,exports){arguments[4][2][0].apply(exports,arguments)},{"@daign/2d-graphics":106,"@daign/style-sheets":156,dup:2}],11:[function(require,module,exports){arguments[4][3][0].apply(exports,arguments)},{"@daign/2d-graphics":106,dup:3}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WindTurbinePlanner=exports.ControlModifiersExample=exports.CircleControlsExample=exports.BasicExample=void 0;var basicExample_1=require("./basic-example/basicExample");Object.defineProperty(exports,"BasicExample",{enumerable:true,get:function(){return basicExample_1.BasicExample}});var circleControlsExample_1=require("./circle-controls/circleControlsExample");Object.defineProperty(exports,"CircleControlsExample",{enumerable:true,get:function(){return circleControlsExample_1.CircleControlsExample}});var controlModifiersExample_1=require("./control-modifiers/controlModifiersExample");Object.defineProperty(exports,"ControlModifiersExample",{enumerable:true,get:function(){return controlModifiersExample_1.ControlModifiersExample}});var windTurbinePlanner_1=require("./wind-turbine-planner/windTurbinePlanner");Object.defineProperty(exports,"WindTurbinePlanner",{enumerable:true,get:function(){return windTurbinePlanner_1.WindTurbinePlanner}})},{"./basic-example/basicExample":1,"./circle-controls/circleControlsExample":4,"./control-modifiers/controlModifiersExample":9,"./wind-turbine-planner/windTurbinePlanner":43}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.roundedRectangleModule=exports.RoundedRectangle=void 0;var roundedRectangle_1=require("./roundedRectangle");Object.defineProperty(exports,"RoundedRectangle",{enumerable:true,get:function(){return roundedRectangle_1.RoundedRectangle}});var roundedRectangleModule_1=require("./roundedRectangleModule");Object.defineProperty(exports,"roundedRectangleModule",{enumerable:true,get:function(){return roundedRectangleModule_1.roundedRectangleModule}})},{"./roundedRectangle":14,"./roundedRectangleModule":15}],14:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.RoundedRectangle=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var RoundedRectangle=function(_super){__extends(RoundedRectangle,_super);function RoundedRectangle(){var _this=_super.call(this)||this;_this.rx=0;_this.ry=0;return _this}return RoundedRectangle}(_2d_graphics_1.TwoPointRectangle);exports.RoundedRectangle=RoundedRectangle},{"@daign/2d-graphics":106}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.roundedRectangleModule=void 0;var dom_pool_1=require("@daign/dom-pool");var _2d_graphics_svg_1=require("@daign/2d-graphics-svg");var roundedRectangle_1=require("./roundedRectangle");exports.roundedRectangleModule=new _2d_graphics_svg_1.RenderModule(roundedRectangle_1.RoundedRectangle,function(currentNode,projection,selectorChain){var rectangle=currentNode.sourceNode;selectorChain.addSelector(rectangle.styleSelector);var startPoint=rectangle.getStartTransformed(projection);var size=rectangle.getSizeTransformed(projection);var rectNode=dom_pool_1.WrappedDomPool.getSvg("rect");rectNode.setAttribute("x",String(startPoint.x));rectNode.setAttribute("y",String(startPoint.y));rectNode.setAttribute("width",String(size.x));rectNode.setAttribute("height",String(size.y));rectNode.setAttribute("rx",String(rectangle.rx));rectNode.setAttribute("ry",String(rectangle.ry));return rectNode})},{"./roundedRectangle":14,"@daign/2d-graphics-svg":44,"@daign/dom-pool":121}],16:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.AreaControl=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var math_1=require("@daign/math");var types_1=require("../types");var AreaControl=function(_super){__extends(AreaControl,_super);function AreaControl(areaManager){var _this=_super.call(this)||this;_this.areaManager=areaManager;_this.currentTool=types_1.Tool.Edit;_this.polygon=new math_1.Polygon2;_this.addClass("area");_this.updatePolygon();_this.subscriptionRemover=_this.points.subscribeToChanges(function(){_this.updatePolygon();_this.areaManager.sendChangeNotification()});return _this}AreaControl.prototype.setTool=function(tool){this.currentTool=tool;this.redraw()};AreaControl.prototype.redraw=function(){_super.prototype.redraw.call(this);var polygon=new _2d_graphics_1.Polygon;this.appendChild(polygon);polygon.points.copyElements(this.points);if(this.currentTool===types_1.Tool.Delete){this.addDeleteButton()}};AreaControl.prototype.addDeleteButton=function(){var _this=this;var deletionCallback=function(){if(_this.areaManager){_this.areaManager.removeArea(_this)}};var buttonShape=new _2d_graphics_1.UseElement;buttonShape.href="#deleteButton";var button=new _2d_graphics_1.ButtonObject(deletionCallback);button.buttonShape=buttonShape;button.anchor.copy(this.polygon.getBoxCenter());this.buttons.push(button)};AreaControl.prototype.updatePolygon=function(){this.polygon.elements=this.points.elements};AreaControl.prototype.removeSubscriptions=function(){this.subscriptionRemover()};return AreaControl}(_2d_graphics_1.ControlObject);exports.AreaControl=AreaControl},{"../types":40,"@daign/2d-graphics":106,"@daign/math":135}],17:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.AreaControlManager=void 0;var observable_1=require("@daign/observable");var AreaControlManager=function(_super){__extends(AreaControlManager,_super);function AreaControlManager(application){var _this=_super.call(this)||this;_this.application=application;_this.areas=[];_this.layer=null;return _this}AreaControlManager.prototype.setLayer=function(layer){this.layer=layer};AreaControlManager.prototype.addArea=function(area){this.areas.push(area);if(this.layer){this.layer.appendChild(area)}this.notifyObservers()};AreaControlManager.prototype.removeArea=function(area){area.removeSubscriptions();var index=this.areas.indexOf(area);if(index!==-1){this.areas.splice(index,1)}if(this.layer){this.layer.removeChild(area)}this.notifyObservers();this.application.selectionManager.setSelection(null,null);this.application.redraw()};AreaControlManager.prototype.setTool=function(tool){this.areas.forEach(function(area){area.setTool(tool)})};AreaControlManager.prototype.sendChangeNotification=function(){this.notifyObservers()};return AreaControlManager}(observable_1.Observable);exports.AreaControlManager=AreaControlManager},{"@daign/observable":150}],18:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.AreaControlWood=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var areaControl_1=require("./areaControl");var types_1=require("../types");var AreaControlWood=function(_super){__extends(AreaControlWood,_super);function AreaControlWood(areaManager){return _super.call(this,areaManager)||this}AreaControlWood.prototype.redraw=function(){this.clearChildren();this.buttons=[];var randomMaskId=Math.floor(Math.random()*(1e4+1));var woodMask=new _2d_graphics_1.Mask;woodMask.id="woodMask".concat(randomMaskId);woodMask.addClass("woodMask");this.appendChild(woodMask);var woodMaskPolygon=new _2d_graphics_1.Polygon;woodMaskPolygon.points.copyElements(this.points);woodMask.appendChild(woodMaskPolygon);var woodMaskCutout=new _2d_graphics_1.UseElement;woodMaskCutout.href="#deforestationArea";woodMaskCutout.addClass("woodMaskCutout");woodMask.appendChild(woodMaskCutout);var woodArea=new _2d_graphics_1.Polygon;woodArea.addClass("woodArea");woodArea.points.copyElements(this.points);woodArea.mask="url(#woodMask".concat(randomMaskId,")");this.appendChild(woodArea);var deforestationMask=new _2d_graphics_1.Mask;deforestationMask.id="deforestationMask".concat(randomMaskId);deforestationMask.addClass("deforestationMask");this.appendChild(deforestationMask);var deforestationMaskElement=new _2d_graphics_1.UseElement;deforestationMaskElement.href="#deforestationArea";deforestationMaskElement.addClass("woodMaskCutout");deforestationMask.appendChild(deforestationMaskElement);var deforestationArea=new _2d_graphics_1.Polygon;deforestationArea.addClass("deforestationArea");deforestationArea.points.copyElements(this.points);deforestationArea.mask="url(#deforestationMask".concat(randomMaskId,")");this.appendChild(deforestationArea);var deforestationBorderMask=new _2d_graphics_1.Mask;deforestationBorderMask.id="deforestationBorderMask".concat(randomMaskId);deforestationBorderMask.addClass("deforestationBorderMask");this.appendChild(deforestationBorderMask);var borderMaskPositive=new _2d_graphics_1.UseElement;borderMaskPositive.href="#deforestationArea";borderMaskPositive.addClass("borderMaskPositive");deforestationBorderMask.appendChild(borderMaskPositive);var borderMaskNegative=new _2d_graphics_1.UseElement;borderMaskNegative.href="#deforestationArea";borderMaskNegative.addClass("borderMaskNegative");deforestationBorderMask.appendChild(borderMaskNegative);var deforestationBorder=new _2d_graphics_1.Polygon;deforestationBorder.addClass("deforestationBorder");deforestationBorder.points.copyElements(this.points);deforestationBorder.mask="url(#deforestationBorderMask".concat(randomMaskId,")");this.appendChild(deforestationBorder);var dashedBorder=new _2d_graphics_1.Polygon;dashedBorder.addClass("dashedBorder");dashedBorder.points.copyElements(this.points);this.appendChild(dashedBorder);if(this.currentTool===types_1.Tool.Delete){this.addDeleteButton()}};return AreaControlWood}(areaControl_1.AreaControl);exports.AreaControlWood=AreaControlWood},{"../types":40,"./areaControl":16,"@daign/2d-graphics":106}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AreaFactory=void 0;var areaControl_1=require("./areaControl");var areaControlWood_1=require("./areaControlWood");var AreaFactory=function(){function AreaFactory(makeWoodArea,manager){this.makeWoodArea=makeWoodArea;this.manager=manager}AreaFactory.prototype.createArea=function(){var area;if(this.makeWoodArea){area=new areaControlWood_1.AreaControlWood(this.manager)}else{area=new areaControl_1.AreaControl(this.manager)}this.manager.addArea(area);return area};return AreaFactory}();exports.AreaFactory=AreaFactory},{"./areaControl":16,"./areaControlWood":18}],20:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.BackgroundImage=void 0;var math_1=require("@daign/math");var _2d_pipeline_1=require("@daign/2d-pipeline");var _2d_graphics_1=require("@daign/2d-graphics");var backgroundImageModifier_1=require("./backgroundImageModifier");var backgroundImageGuide_1=require("./backgroundImageGuide");var types_1=require("../types");var BackgroundImage=function(_super){__extends(BackgroundImage,_super);function BackgroundImage(application,points){var _this=_super.call(this)||this;_this.currentTool=types_1.Tool.Edit;_this._imageData=null;_this._useReference=null;_this.scalePointsLocked=false;_this.addClass("background-image");_this.application=application;_this.points.elements=points;_this.backgroundImageModifier=new backgroundImageModifier_1.BackgroundImageModifier;_this.controlModifier=_this.backgroundImageModifier;_this.controlGuides.push(new backgroundImageGuide_1.BackgroundImageGuide);_this.setControlShapes();return _this}Object.defineProperty(BackgroundImage.prototype,"imageData",{set:function(value){this._imageData=value;this._useReference=null;this.redraw()},enumerable:false,configurable:true});Object.defineProperty(BackgroundImage.prototype,"useReference",{set:function(value){this._useReference=value;this._imageData=null;this.redraw()},enumerable:false,configurable:true});BackgroundImage.prototype.setTool=function(tool){this.currentTool=tool;this.setControlShapes();this.redraw()};BackgroundImage.prototype.setControlShapes=function(){if(this.currentTool===types_1.Tool.Scale){var targetShape1=new _2d_graphics_1.FixedRadiusCircle;targetShape1.radius=15;targetShape1.addClass("scale-pin");var targetShape2=new _2d_graphics_1.FixedRadiusCircle;targetShape2.radius=15;targetShape2.addClass("scale-pin");this.controlPointShapes=[null,null,targetShape1,targetShape2]}else{this.controlPointShapes=[undefined,undefined,null,null]}};BackgroundImage.prototype.redraw=function(){var _this=this;_super.prototype.redraw.call(this);if(this.points.length>=2&&(this._imageData||this._useReference)){var centerPoint=this.points.getElement(0);var extensionPoint=this.points.getElement(1);var extensionLine=extensionPoint.clone().sub(centerPoint);var size=Math.max(extensionLine.length(),1);var scale=new math_1.Vector2(size,size);var group=new _2d_graphics_1.Group;this.appendChild(group);var frame=new _2d_graphics_1.TwoPointRectangle;frame.start=new math_1.Vector2(1,1);frame.end=new math_1.Vector2(-1,-1);group.appendChild(frame);if(this._imageData){var image=new _2d_graphics_1.TwoPointImage;image.href=this._imageData;image.start=new math_1.Vector2(1,1);image.end=new math_1.Vector2(-1,-1);group.appendChild(image)}else if(this._useReference){var useElement=new _2d_graphics_1.UseElement;useElement.href=this._useReference;var useScaling=new _2d_pipeline_1.NativeScaleTransform;useScaling.scaling.set(2/800,2/800);var useTranslation=new _2d_pipeline_1.NativeTranslateTransform;useTranslation.translation.set(-400,-300);useElement.transformation.push(useScaling);useElement.transformation.push(useTranslation);group.appendChild(useElement)}var scaleTransform=new _2d_pipeline_1.NativeScaleTransform;scaleTransform.scaling.copy(scale);var translateTransform=new _2d_pipeline_1.NativeTranslateTransform;translateTransform.translation.copy(centerPoint);group.transformation.push(translateTransform);group.transformation.push(scaleTransform);if(this.currentTool===types_1.Tool.Scale){var lockCallback=function(){_this.scalePointsLocked=!_this.scalePointsLocked;_this.backgroundImageModifier.scalePointsLocked=_this.scalePointsLocked;_this.redraw();_this.application.redraw()};var lockButton=new _2d_graphics_1.UseElement;lockButton.href=this.scalePointsLocked?"#lockClosedButton":"#lockOpenButton";var button=new _2d_graphics_1.ButtonObject(lockCallback);button.buttonShape=lockButton;var buttonAnchor=centerPoint.clone();button.anchor.copy(buttonAnchor);this.buttons.push(button)}}};return BackgroundImage}(_2d_graphics_1.ControlObject);exports.BackgroundImage=BackgroundImage},{"../types":40,"./backgroundImageGuide":21,"./backgroundImageModifier":22,"@daign/2d-graphics":106,"@daign/2d-pipeline":110,"@daign/math":135}],21:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BackgroundImageGuide=void 0;var math_1=require("@daign/math");var _2d_graphics_1=require("@daign/2d-graphics");var types_1=require("../types");var unitFormatter_1=require("./unitFormatter");var BackgroundImageGuide=function(){function BackgroundImageGuide(){}BackgroundImageGuide.prototype.redraw=function(activeObject){var backgroundImage=activeObject;if(backgroundImage.currentTool===types_1.Tool.Scale&&backgroundImage.points.length>=4){var transformation=backgroundImage.presentationNodes[0].projectNodeToView;var start=backgroundImage.points.getElement(2);var end=backgroundImage.points.getElement(3);var distance=start.distanceTo(end);var center=new math_1.Line2(start.clone(),end.clone()).getCenter();var startTransformed=start.clone().transform(transformation);var endTransformed=end.clone().transform(transformation);var centerTransformed=center.clone().transform(transformation);var group=new _2d_graphics_1.Group;group.addClass("scale-distance");var line=new _2d_graphics_1.Line;line.start=startTransformed;line.end=endTransformed;group.appendChild(line);var textContent=unitFormatter_1.UnitFormatter.printLengthAdapted(distance);var textBox=new _2d_graphics_1.TwoPointRectangle;var textBoxHeight=24;var textBoxWidth=textBoxHeight*textContent.length*.5;var textBoxCorner=new math_1.Vector2(textBoxWidth,textBoxHeight).multiplyScalar(.5);textBox.start.copy(centerTransformed).add(textBoxCorner);textBox.end.copy(centerTransformed).sub(textBoxCorner);group.appendChild(textBox);var text=new _2d_graphics_1.ScalableText;text.anchor.copy(centerTransformed).add(new math_1.Vector2(0,5.5));text.fontSize=16;text.content=textContent;text.textAnchor="middle";group.appendChild(text);return group}else{return null}};return BackgroundImageGuide}();exports.BackgroundImageGuide=BackgroundImageGuide},{"../types":40,"./unitFormatter":26,"@daign/2d-graphics":106,"@daign/math":135}],22:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BackgroundImageModifier=void 0;var math_1=require("@daign/math");var BackgroundImageModifier=function(){function BackgroundImageModifier(){this.enabled=true;this.scalePointsLocked=false}BackgroundImageModifier.prototype.modifyPoints=function(updatedPoints,pointIndex,controlObject){if(!this.enabled){return updatedPoints}if(pointIndex===1){var extensionPoint=updatedPoints[1];var centerPoint=updatedPoints[0];var alignedPoint=extensionPoint.clone().setX(centerPoint.x);var minimumDistance=10;var yValue=Math.min(extensionPoint.y,centerPoint.y-minimumDistance);alignedPoint.setY(yValue);extensionPoint.copy(alignedPoint)}if(pointIndex>1&&this.scalePointsLocked){var scale1=controlObject.points.getElement(2);var scale2=controlObject.points.getElement(3);var line=new math_1.Line2(scale1.clone(),scale2.clone());var scalePointProjected=updatedPoints[pointIndex].projectOnLine(line);updatedPoints[pointIndex]=scalePointProjected}if(pointIndex===0){var pointBefore=controlObject.points.getElement(0);var pointAfter=updatedPoints[0];var diff=pointAfter.clone().sub(pointBefore);updatedPoints[1].add(diff)}if(pointIndex<2){var scale1Transformed=this.transformPointRelative(controlObject.points.getElement(2),controlObject.points.getElement(0),controlObject.points.getElement(1),updatedPoints[0],updatedPoints[1]);var scale2Transformed=this.transformPointRelative(controlObject.points.getElement(3),controlObject.points.getElement(0),controlObject.points.getElement(1),updatedPoints[0],updatedPoints[1]);updatedPoints[2]=scale1Transformed;updatedPoints[3]=scale2Transformed}if(pointIndex>1&&this.scalePointsLocked){var centerTransformed=this.transformPointRelative(controlObject.points.getElement(0),controlObject.points.getElement(2),controlObject.points.getElement(3),updatedPoints[2],updatedPoints[3]);var extensionPointTransformed=this.transformPointRelative(controlObject.points.getElement(1),controlObject.points.getElement(2),controlObject.points.getElement(3),updatedPoints[2],updatedPoints[3]);updatedPoints[0]=centerTransformed;updatedPoints[1]=extensionPointTransformed}return updatedPoints};BackgroundImageModifier.prototype.transformPointRelative=function(point,refA0,refB0,refA1,refB1){var v0=refB0.clone().sub(refA0);var v1=refB1.clone().sub(refA1);var o0=v0.perpendicular();var o1=v1.perpendicular();var v0n=v0.clone().normalize();var v1n=v1.clone().normalize();var o0n=o0.clone().normalize();var o1n=o1.clone().normalize();var scale=v1.length()/v0.length();var support=point.clone().sub(refA0);var dotV=support.dot(v0n);var dotO=support.dot(o0n);var componentV=v1n.clone().multiplyScalar(dotV*scale);var componentO=o1n.clone().multiplyScalar(dotO*scale);var transformedPoint=refA1.clone().add(componentV).add(componentO);return transformedPoint};return BackgroundImageModifier}();exports.BackgroundImageModifier=BackgroundImageModifier},{"@daign/math":135}],23:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.DeforestationEstimate=void 0;var math_1=require("@daign/math");var _2d_graphics_1=require("@daign/2d-graphics");var unitFormatter_1=require("./unitFormatter");var deforestationRadius=50;var DeforestationEstimate=function(_super){__extends(DeforestationEstimate,_super);function DeforestationEstimate(){var _this=_super.call(this)||this;_this.addClass("deforestation-estimate");return _this}DeforestationEstimate.prototype.redraw=function(turbines,woodAreas){var _this=this;this.clearChildren();woodAreas.forEach(function(area){if(area.points.length<3){return}var center=area.polygon.getBoxCenter();var deforestationAreaEstimateValue=0;turbines.points.iterate(function(point){var estimate=_this.estimateCirclePolygonIntersection(point,deforestationRadius,area.polygon);deforestationAreaEstimateValue+=estimate});if(deforestationAreaEstimateValue>0){var textContent="-".concat(unitFormatter_1.UnitFormatter.printAreaAdapted(deforestationAreaEstimateValue));var textBox=new _2d_graphics_1.TwoPointRectangle;var textBoxHeight=90;var textBoxWidth=textBoxHeight*textContent.length*.5;var textBoxCorner=new math_1.Vector2(textBoxWidth,textBoxHeight).multiplyScalar(.5);textBox.start.copy(center).add(textBoxCorner);textBox.end.copy(center).sub(textBoxCorner);_this.appendChild(textBox);var text=new _2d_graphics_1.ScalableText;text.anchor.copy(center).add(new math_1.Vector2(0,20));text.fontSize=60;text.content=textContent;text.textAnchor="middle";_this.appendChild(text)}})};DeforestationEstimate.prototype.estimateCirclePolygonIntersection=function(circleCenter,circleRadius,polygon){var circleArea=circleRadius*circleRadius*Math.PI;var centerIsInside=polygon.isPointInside(circleCenter);var shortestDistance=Infinity;polygon.iterateLineSegments(function(line){var nearestPoint=line.getNearestPointOnLineSegment(circleCenter);var distance=circleCenter.distanceTo(nearestPoint);if(distance<shortestDistance){shortestDistance=distance}});if(centerIsInside){var factor=Math.min(shortestDistance/circleRadius/2+.5,1);return circleArea*factor}else{var factor=Math.max(-shortestDistance/circleRadius/2+.5,0);return circleArea*factor}};return DeforestationEstimate}(_2d_graphics_1.Group);exports.DeforestationEstimate=DeforestationEstimate},{"./unitFormatter":26,"@daign/2d-graphics":106,"@daign/math":135}],24:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.DistanceAlert=void 0;var math_1=require("@daign/math");var _2d_graphics_1=require("@daign/2d-graphics");var distanceToResidentialAreas=600;var distanceBetweenTurbines=300;var DistanceAlert=function(_super){__extends(DistanceAlert,_super);function DistanceAlert(){var _this=_super.call(this)||this;_this.addClass("distance-alert");return _this}DistanceAlert.prototype.redraw=function(turbines,restrictedAreas){var _this=this;this.clearChildren();turbines.points.iterate(function(point1,index1){var isTooNear=false;var currentNearestDistance=Infinity;var collisionPoint=null;turbines.points.iterate(function(point2,index2){if(index1!==index2){var distance=point1.distanceTo(point2);if(distance<distanceBetweenTurbines&&distance<currentNearestDistance){currentNearestDistance=distance;isTooNear=true;collisionPoint=point2}}});if(isTooNear){if(collisionPoint){var line=new _2d_graphics_1.Line;line.start.copy(point1);line.end.copy(collisionPoint);_this.appendChild(line)}var warnArea=new _2d_graphics_1.TwoPointCircle;warnArea.center.copy(point1);warnArea.circlePoint.copy(point1).add(new math_1.Vector2(distanceBetweenTurbines,0));_this.appendChild(warnArea)}isTooNear=false;currentNearestDistance=Infinity;collisionPoint=null;restrictedAreas.forEach(function(area){if(area.polygon.isPointInside(point1)){currentNearestDistance=0;isTooNear=true;collisionPoint=null}else{area.polygon.iterateLineSegments(function(line){var nearestPoint=line.getNearestPointOnLineSegment(point1);var distance=nearestPoint.distanceTo(point1);if(distance<distanceToResidentialAreas&&distance<currentNearestDistance){currentNearestDistance=distance;isTooNear=true;collisionPoint=nearestPoint}})}});if(isTooNear){if(collisionPoint){var line=new _2d_graphics_1.Line;line.start.copy(point1);line.end.copy(collisionPoint);_this.appendChild(line)}var warnArea=new _2d_graphics_1.TwoPointCircle;warnArea.center.copy(point1);warnArea.circlePoint.copy(point1).add(new math_1.Vector2(distanceToResidentialAreas,0));_this.appendChild(warnArea)}})};return DistanceAlert}(_2d_graphics_1.Group);exports.DistanceAlert=DistanceAlert},{"@daign/2d-graphics":106,"@daign/math":135}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WindTurbineControl=exports.DistanceAlert=exports.DeforestationEstimate=exports.BackgroundImageModifier=exports.BackgroundImageGuide=exports.BackgroundImage=exports.AreaFactory=exports.AreaControlWood=exports.AreaControlManager=exports.AreaControl=void 0;var areaControl_1=require("./areaControl");Object.defineProperty(exports,"AreaControl",{enumerable:true,get:function(){return areaControl_1.AreaControl}});var areaControlManager_1=require("./areaControlManager");Object.defineProperty(exports,"AreaControlManager",{enumerable:true,get:function(){return areaControlManager_1.AreaControlManager}});var areaControlWood_1=require("./areaControlWood");Object.defineProperty(exports,"AreaControlWood",{enumerable:true,get:function(){return areaControlWood_1.AreaControlWood}});var areaFactory_1=require("./areaFactory");Object.defineProperty(exports,"AreaFactory",{enumerable:true,get:function(){return areaFactory_1.AreaFactory}});var backgroundImage_1=require("./backgroundImage");Object.defineProperty(exports,"BackgroundImage",{enumerable:true,get:function(){return backgroundImage_1.BackgroundImage}});var backgroundImageGuide_1=require("./backgroundImageGuide");Object.defineProperty(exports,"BackgroundImageGuide",{enumerable:true,get:function(){return backgroundImageGuide_1.BackgroundImageGuide}});var backgroundImageModifier_1=require("./backgroundImageModifier");Object.defineProperty(exports,"BackgroundImageModifier",{enumerable:true,get:function(){return backgroundImageModifier_1.BackgroundImageModifier}});var deforestationEstimate_1=require("./deforestationEstimate");Object.defineProperty(exports,"DeforestationEstimate",{enumerable:true,get:function(){return deforestationEstimate_1.DeforestationEstimate}});var distanceAlert_1=require("./distanceAlert");Object.defineProperty(exports,"DistanceAlert",{enumerable:true,get:function(){return distanceAlert_1.DistanceAlert}});var windTurbineControl_1=require("./windTurbineControl");Object.defineProperty(exports,"WindTurbineControl",{enumerable:true,get:function(){return windTurbineControl_1.WindTurbineControl}})},{"./areaControl":16,"./areaControlManager":17,"./areaControlWood":18,"./areaFactory":19,"./backgroundImage":20,"./backgroundImageGuide":21,"./backgroundImageModifier":22,"./deforestationEstimate":23,"./distanceAlert":24,"./windTurbineControl":27}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.UnitFormatter=void 0;var math_1=require("@daign/math");var UnitFormatter=function(){function UnitFormatter(){}UnitFormatter.printLengthAdapted=function(input){var value=input;var unit="m";var valueString="";if(value>=995){unit="km";value=value/1e3}if(value<1){valueString=value.toFixed(2)}else{var numberOfDigits=Math.floor(Math.log10(value))+1;if(numberOfDigits===1){valueString=value.toFixed(1)}else{valueString=math_1.MathHelper.precisionRound(value,2-numberOfDigits).toFixed(0)}}var output="".concat(valueString," ").concat(unit);return output};UnitFormatter.printAreaAdapted=function(input){var value=input;var unit="qm";var valueString="";if(value>=995){unit="ha";value=value/1e3}if(value<1){valueString=value.toFixed(2)}else{var numberOfDigits=Math.floor(Math.log10(value))+1;if(numberOfDigits===1){valueString=value.toFixed(1)}else{valueString=math_1.MathHelper.precisionRound(value,2-numberOfDigits).toFixed(0)}}var output="".concat(valueString," ").concat(unit);return output};return UnitFormatter}();exports.UnitFormatter=UnitFormatter},{"@daign/math":135}],27:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.WindTurbineControl=void 0;var math_1=require("@daign/math");var _2d_graphics_1=require("@daign/2d-graphics");var types_1=require("../types");var deforestationRadius=50;var WindTurbineControl=function(_super){__extends(WindTurbineControl,_super);function WindTurbineControl(application){var _this=_super.call(this)||this;_this.application=application;_this.currentTool=types_1.Tool.Edit;_this.addClass("wind-turbines");return _this}WindTurbineControl.prototype.setTool=function(tool){this.currentTool=tool;this.redraw()};WindTurbineControl.prototype.redraw=function(){var _this=this;_super.prototype.redraw.call(this);this.points.elements.forEach(function(point){var useElement=new _2d_graphics_1.UseElement;useElement.href="#turbineGraphic";useElement.anchor=point.clone();_this.appendChild(useElement)});var deforestationTemplate=new _2d_graphics_1.Group;deforestationTemplate.addClass("deforestationTemplate");this.appendChild(deforestationTemplate);var deforestationArea=new _2d_graphics_1.Group;deforestationArea.id="deforestationArea";deforestationArea.addClass("deforestationArea");deforestationTemplate.appendChild(deforestationArea);this.points.elements.forEach(function(point){var circle=new _2d_graphics_1.TwoPointCircle;circle.center.copy(point);circle.circlePoint.copy(point).add(new math_1.Vector2(deforestationRadius,0));deforestationArea.appendChild(circle)});if(this.currentTool===types_1.Tool.Delete){this.points.iterate(function(point,index){var deletionCallback=function(){_this.deletePoint(index)};var buttonShape=new _2d_graphics_1.UseElement;buttonShape.href="#deleteButton";var button=new _2d_graphics_1.ButtonObject(deletionCallback);button.buttonShape=buttonShape;button.anchor.copy(point);_this.buttons.push(button)})}};WindTurbineControl.prototype.deletePoint=function(index){this.points.remove(index);this.redraw();this.application.redraw()};return WindTurbineControl}(_2d_graphics_1.ControlObject);exports.WindTurbineControl=WindTurbineControl},{"../types":40,"@daign/2d-graphics":106,"@daign/math":135}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FileUploader=void 0;var FileUploader=function(){function FileUploader(application,inputId,backgroundImageObject){var _this=this;this.application=application;this.inputId=inputId;this.backgroundImageObject=backgroundImageObject;var fileInput=document.getElementById(this.inputId);fileInput.addEventListener("change",function(event){var selectedFile=event.target.files[0];if(selectedFile){var reader=new FileReader;reader.onload=function(e){var imageDataUri=e.target.result;_this.backgroundImageObject.imageData=imageDataUri;_this.application.selectionManager.setSelection(_this.backgroundImageObject,null);_this.application.redraw()};reader.readAsDataURL(selectedFile)}})}FileUploader.prototype.triggerFileUpload=function(){var fileInput=document.getElementById(this.inputId);fileInput.click()};return FileUploader}();exports.FileUploader=FileUploader},{}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MenuButton=exports.ToolMenu=exports.ScaleBar=exports.LayerMenu=exports.FileUploader=void 0;var fileUploader_1=require("./fileUploader");Object.defineProperty(exports,"FileUploader",{enumerable:true,get:function(){return fileUploader_1.FileUploader}});var layerMenu_1=require("./layerMenu");Object.defineProperty(exports,"LayerMenu",{enumerable:true,get:function(){return layerMenu_1.LayerMenu}});var scaleBar_1=require("./scaleBar");Object.defineProperty(exports,"ScaleBar",{enumerable:true,get:function(){return scaleBar_1.ScaleBar}});var toolMenu_1=require("./toolMenu");Object.defineProperty(exports,"ToolMenu",{enumerable:true,get:function(){return toolMenu_1.ToolMenu}});var menuButton_1=require("./menuButton");Object.defineProperty(exports,"MenuButton",{enumerable:true,get:function(){return menuButton_1.MenuButton}})},{"./fileUploader":28,"./layerMenu":30,"./menuButton":31,"./scaleBar":32,"./toolMenu":33}],30:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.LayerMenu=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var LayerMenu=function(_super){__extends(LayerMenu,_super);function LayerMenu(){var _this=_super.call(this)||this;_this.buttons=[];_this.addClass("layer-menu");_this.redraw();return _this}LayerMenu.prototype.drawButtons=function(buttons){this.buttons=buttons;this.redraw()};LayerMenu.prototype.redraw=function(){var _this=this;this.clearChildren();this.buttons.forEach(function(button,index){button.position.set(10,10+65*index);button.redraw();_this.appendChild(button)})};return LayerMenu}(_2d_graphics_1.Group);exports.LayerMenu=LayerMenu},{"@daign/2d-graphics":106}],31:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.MenuButton=void 0;var math_1=require("@daign/math");var _2d_graphics_1=require("@daign/2d-graphics");var _2d_pipeline_1=require("@daign/2d-pipeline");var basic_elements_1=require("../basic-elements");var MenuButton=function(_super){__extends(MenuButton,_super);function MenuButton(activatable,action,iconName,application,mainButton){if(mainButton===void 0){mainButton=false}var _this=_super.call(this)||this;_this.activatable=activatable;_this.action=action;_this.iconName=iconName;_this.application=application;_this.mainButton=mainButton;_this._active=false;_this.position=new math_1.Vector2;_this.rectangle=null;_this.addClass("menu-button");_this.redraw();return _this}Object.defineProperty(MenuButton.prototype,"active",{get:function(){return this._active},set:function(value){if(this.activatable){this._active=value;if(this.rectangle){this.rectangle.setVariableClass("state",value?"active":"inactive")}}},enumerable:false,configurable:true});MenuButton.prototype.redraw=function(){var _this=this;this.clearChildren();var cornerRadius=this.mainButton?30:20;var rectangleSize=this.mainButton?60:40;var usePosition=this.mainButton?7.5:5;var useScale=this.mainButton?1.5:1;this.rectangle=new basic_elements_1.RoundedRectangle;this.rectangle.start=this.position;this.rectangle.end=this.position.clone().addScalar(rectangleSize);this.rectangle.rx=cornerRadius;this.rectangle.ry=cornerRadius;if(this.activatable){this.rectangle.setVariableClass("state",this.active?"active":"inactive")}this.rectangle.onclick=function(){_this.action();_this.active=true;if(_this.application){_this.application.redraw()}};this.appendChild(this.rectangle);var useElement=new _2d_graphics_1.UseElement;useElement.href=this.iconName;var scaleTransform=new _2d_pipeline_1.NativeScaleTransform;scaleTransform.scaling.set(useScale,useScale);var translateTransform=new _2d_pipeline_1.NativeTranslateTransform;translateTransform.translation.copy(this.position).addScalar(usePosition);useElement.transformation.push(translateTransform);useElement.transformation.push(scaleTransform);this.appendChild(useElement)};return MenuButton}(_2d_graphics_1.Group);exports.MenuButton=MenuButton},{"../basic-elements":13,"@daign/2d-graphics":106,"@daign/2d-pipeline":110,"@daign/math":135}],32:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ScaleBar=void 0;var math_1=require("@daign/math");var _2d_graphics_1=require("@daign/2d-graphics");var _2d_pipeline_1=require("@daign/2d-pipeline");var ScaleBar=function(_super){__extends(ScaleBar,_super);function ScaleBar(svgContext,viewport){var _this=_super.call(this)||this;_this.svgContext=svgContext;_this.viewport=viewport;_this.addClass("scale-bar");_this.scalePosition=new _2d_pipeline_1.NativeTranslateTransform;_this.transformation.push(_this.scalePosition);_this.redraw();return _this}ScaleBar.prototype.redraw=function(){this.clearChildren();var contextSize=this.svgContext.size.clone();this.scalePosition.translation.set(20,contextSize.y-15);var scale=this.viewport.viewScale.x;var maxScaleWidth=200;var distance=maxScaleWidth/scale;if(distance>=1){var numberOfDigits=Math.floor(Math.log10(distance))+1;var roundingFactor=Math.pow(10,1-numberOfDigits);var roundedBaseValue=Math.floor((distance+Number.EPSILON)*roundingFactor);var roundedValue=roundedBaseValue/roundingFactor;var scaleSize=roundedValue*scale;var endLabel="".concat(roundedValue," m");if(roundedValue>999){endLabel="".concat(Math.round(roundedValue/1e3)," km")}var line=new _2d_graphics_1.Polyline;line.points.elements=[new math_1.Vector2(0,-10),new math_1.Vector2(0,0),new math_1.Vector2(scaleSize,0),new math_1.Vector2(scaleSize,-10)];this.appendChild(line);var subScaleDivisions=roundedBaseValue;if(subScaleDivisions===1){subScaleDivisions=10}for(var i=1;i<subScaleDivisions;i+=1){var subLinePosition=i*scaleSize/subScaleDivisions;var subLine=new _2d_graphics_1.Line;subLine.start=new math_1.Vector2(subLinePosition,0);subLine.end=new math_1.Vector2(subLinePosition,-7);this.appendChild(subLine)}var textZero=new _2d_graphics_1.Text;textZero.anchor.set(0,-13);textZero.content="0";textZero.textAnchor="middle";this.appendChild(textZero);var textEnd=new _2d_graphics_1.Text;textEnd.anchor.set(scaleSize,-13);textEnd.content=endLabel;textEnd.textAnchor="middle";this.appendChild(textEnd)}};return ScaleBar}(_2d_graphics_1.Group);exports.ScaleBar=ScaleBar},{"@daign/2d-graphics":106,"@daign/2d-pipeline":110,"@daign/math":135}],33:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ToolMenu=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var ToolMenu=function(_super){__extends(ToolMenu,_super);function ToolMenu(){var _this=_super.call(this)||this;_this.buttons=[];_this.addClass("tool-menu");_this.redraw();return _this}ToolMenu.prototype.drawButtons=function(buttons){this.buttons=buttons;this.redraw()};ToolMenu.prototype.redraw=function(){var _this=this;this.clearChildren();this.buttons.forEach(function(button,index){button.position.set(85,10+45*index);button.redraw();_this.appendChild(button)})};return ToolMenu}(_2d_graphics_1.Group);exports.ToolMenu=ToolMenu},{"@daign/2d-graphics":106}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DrawAreaHandle=void 0;var handle_1=require("@daign/handle");var math_1=require("@daign/math");var controls_1=require("../controls");var minimumDragDistance=5;var extractFromEvent=function(event){return(new math_1.Vector2).setFromEventRelative(event)};var DrawAreaHandle=function(){function DrawAreaHandle(domNode,application,areaFactory){var activeArea=null;var newPoint=null;var drawAreaHandle=new handle_1.Handle;drawAreaHandle.setStartNode(domNode);drawAreaHandle.minimumDragDistance=minimumDragDistance;drawAreaHandle.extractFromEvent=extractFromEvent;drawAreaHandle.enabled=false;drawAreaHandle.beginning=function(){var activeObject=application.selectionManager.activeObject;if(activeObject&&activeObject instanceof controls_1.AreaControl){activeArea=activeObject}else{activeArea=areaFactory.createArea()}newPoint=drawAreaHandle.start.clone();newPoint.transform(application.drawingLayer.transformation.inverseTransformMatrix);activeArea.points.push(newPoint);application.selectionManager.setSelection(activeArea,newPoint);application.redraw();return true};drawAreaHandle.continuing=function(){if(activeArea&&newPoint){var updatedPoint=drawAreaHandle.temp.clone();updatedPoint.transform(application.drawingLayer.transformation.inverseTransformMatrix);newPoint.copy(updatedPoint);application.redraw()}};this.handle=drawAreaHandle}Object.defineProperty(DrawAreaHandle.prototype,"enabled",{get:function(){return this.handle.enabled},set:function(value){this.handle.enabled=value},enumerable:false,configurable:true});return DrawAreaHandle}();exports.DrawAreaHandle=DrawAreaHandle},{"../controls":25,"@daign/handle":126,"@daign/math":135}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DrawTurbineHandle=void 0;var handle_1=require("@daign/handle");var math_1=require("@daign/math");var minimumDragDistance=5;var extractFromEvent=function(event){return(new math_1.Vector2).setFromEventRelative(event)};var DrawTurbineHandle=function(){function DrawTurbineHandle(domNode,application,control){var _this=this;this.currentControl=control;var newPoint=null;var drawHandle=new handle_1.Handle;drawHandle.setStartNode(domNode);drawHandle.minimumDragDistance=minimumDragDistance;drawHandle.extractFromEvent=extractFromEvent;drawHandle.enabled=false;drawHandle.beginning=function(){newPoint=drawHandle.start.clone();newPoint.transform(application.drawingLayer.transformation.inverseTransformMatrix);_this.currentControl.points.push(newPoint);application.selectionManager.setSelection(_this.currentControl,newPoint);application.redraw();return true};drawHandle.continuing=function(){if(newPoint){var updatedPoint=drawHandle.temp.clone();updatedPoint.transform(application.drawingLayer.transformation.inverseTransformMatrix);newPoint.copy(updatedPoint);application.redraw()}};this.handle=drawHandle}Object.defineProperty(DrawTurbineHandle.prototype,"enabled",{get:function(){return this.handle.enabled},set:function(value){this.handle.enabled=value},enumerable:false,configurable:true});return DrawTurbineHandle}();exports.DrawTurbineHandle=DrawTurbineHandle},{"@daign/handle":126,"@daign/math":135}],36:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DrawTurbineHandle=exports.DrawAreaHandle=void 0;var drawAreaHandle_1=require("./drawAreaHandle");Object.defineProperty(exports,"DrawAreaHandle",{enumerable:true,get:function(){return drawAreaHandle_1.DrawAreaHandle}});var drawTurbineHandle_1=require("./drawTurbineHandle");Object.defineProperty(exports,"DrawTurbineHandle",{enumerable:true,get:function(){return drawTurbineHandle_1.DrawTurbineHandle}})},{"./drawAreaHandle":34,"./drawTurbineHandle":35}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ToolManager=exports.LayerManager=void 0;var layerManager_1=require("./layerManager");Object.defineProperty(exports,"LayerManager",{enumerable:true,get:function(){return layerManager_1.LayerManager}});var toolManager_1=require("./toolManager");Object.defineProperty(exports,"ToolManager",{enumerable:true,get:function(){return toolManager_1.ToolManager}})},{"./layerManager":38,"./toolManager":39}],38:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var _a;Object.defineProperty(exports,"__esModule",{value:true});exports.LayerManager=void 0;var observable_1=require("@daign/observable");var types_1=require("../types");var gui_1=require("../gui");var layerTitles=(_a={},_a[types_1.Layer.BackgroundImage]="Background Image",_a[types_1.Layer.CityArea]="Residential Areas",_a[types_1.Layer.WoodArea]="Forest Areas",_a[types_1.Layer.Turbines]="Wind Turbine Placement",_a);var LayerManager=function(_super){__extends(LayerManager,_super);function LayerManager(project,layerMenu){var _this=_super.call(this)||this;_this.project=project;_this.layerMenu=layerMenu;_this.buttons=[];_this._currentLayer=types_1.Layer.BackgroundImage;_this.layerTitle=document.getElementById("layerTitle");var turbinesButton=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.setLayer(types_1.Layer.Turbines)},"#turbineIcon",_this.project.application,true);var backgroundButton=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.setLayer(types_1.Layer.BackgroundImage)},"#mapIcon",_this.project.application,true);var cityButton=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.setLayer(types_1.Layer.CityArea)},"#houseIcon",_this.project.application,true);var woodButton=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.setLayer(types_1.Layer.WoodArea)},"#treeIcon",_this.project.application,true);_this.buttons=[turbinesButton,backgroundButton,cityButton,woodButton];backgroundButton.active=true;_this.layerMenu.drawButtons(_this.buttons);return _this}Object.defineProperty(LayerManager.prototype,"currentLayer",{get:function(){return this._currentLayer},enumerable:false,configurable:true});LayerManager.prototype.setLayer=function(layer){this._currentLayer=layer;this.layerTitle.innerHTML=layerTitles[layer];this.notifyObservers()};LayerManager.prototype.deactivateAll=function(){this.buttons.forEach(function(button){button.active=false})};return LayerManager}(observable_1.Observable);exports.LayerManager=LayerManager},{"../gui":29,"../types":40,"@daign/observable":150}],39:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ToolManager=void 0;var observable_1=require("@daign/observable");var gui_1=require("../gui");var types_1=require("../types");var ToolManager=function(_super){__extends(ToolManager,_super);function ToolManager(project,toolMenu){var _this=_super.call(this)||this;_this.project=project;_this.toolMenu=toolMenu;_this.currentButtons=[];_this._currentTool=types_1.Tool.None;return _this}Object.defineProperty(ToolManager.prototype,"currentTool",{get:function(){return this._currentTool},set:function(value){this._currentTool=value;this.notifyObservers()},enumerable:false,configurable:true});ToolManager.prototype.setLayer=function(layer){var _this=this;this.currentButtons=[];if(layer===types_1.Layer.BackgroundImage){var uploadTool=new gui_1.MenuButton(false,function(){_this.project.fileUploader.triggerFileUpload()},"#uploadIcon",this.project.application);var exampleMapTool=new gui_1.MenuButton(false,function(){_this.project.setExampleMap()},"#starMapIcon",this.project.application);var editTool=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.currentTool=types_1.Tool.Edit},"#resizeIcon",this.project.application);var scaleTool=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.currentTool=types_1.Tool.Scale},"#rulerIcon",this.project.application);this.currentButtons=[uploadTool,exampleMapTool,editTool,scaleTool];this._currentTool=types_1.Tool.Edit;editTool.active=true}else if(layer===types_1.Layer.CityArea){var drawTool=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.currentTool=types_1.Tool.Draw},"#drawIcon",this.project.application);var moveTool=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.currentTool=types_1.Tool.Edit},"#moveIcon",this.project.application);var deleteTool=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.currentTool=types_1.Tool.Delete},"#deleteIcon",this.project.application);this.currentButtons=[moveTool,drawTool,deleteTool];this._currentTool=types_1.Tool.Edit;moveTool.active=true}else if(layer===types_1.Layer.WoodArea){var drawTool=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.currentTool=types_1.Tool.Draw},"#drawIcon",this.project.application);var moveTool=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.currentTool=types_1.Tool.Edit},"#moveIcon",this.project.application);var deleteTool=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.currentTool=types_1.Tool.Delete},"#deleteIcon",this.project.application);this.currentButtons=[moveTool,drawTool,deleteTool];this._currentTool=types_1.Tool.Edit;moveTool.active=true}else if(layer===types_1.Layer.Turbines){var drawTool=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.currentTool=types_1.Tool.Draw},"#drawIcon",this.project.application);var moveTool=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.currentTool=types_1.Tool.Edit},"#moveIcon",this.project.application);var deleteTool=new gui_1.MenuButton(true,function(){_this.deactivateAll();_this.currentTool=types_1.Tool.Delete},"#deleteIcon",this.project.application);this.currentButtons=[moveTool,drawTool,deleteTool];this._currentTool=types_1.Tool.Edit;moveTool.active=true}this.toolMenu.drawButtons(this.currentButtons);this.notifyObservers()};ToolManager.prototype.deactivateAll=function(){this.currentButtons.forEach(function(button){button.active=false})};return ToolManager}(observable_1.Observable);exports.ToolManager=ToolManager},{"../gui":29,"../types":40,"@daign/observable":150}],40:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Tool=exports.Layer=void 0;var layer_1=require("./layer");Object.defineProperty(exports,"Layer",{enumerable:true,get:function(){return layer_1.Layer}});var tool_1=require("./tool");Object.defineProperty(exports,"Tool",{enumerable:true,get:function(){return tool_1.Tool}})},{"./layer":41,"./tool":42}],41:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Layer=void 0;var Layer;(function(Layer){Layer[Layer["BackgroundImage"]=0]="BackgroundImage";Layer[Layer["CityArea"]=1]="CityArea";Layer[Layer["WoodArea"]=2]="WoodArea";Layer[Layer["Turbines"]=3]="Turbines"})(Layer||(exports.Layer=Layer={}))},{}],42:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Tool=void 0;var Tool;(function(Tool){Tool[Tool["Edit"]=0]="Edit";Tool[Tool["Draw"]=1]="Draw";Tool[Tool["Delete"]=2]="Delete";Tool[Tool["Scale"]=3]="Scale";Tool[Tool["None"]=4]="None"})(Tool||(exports.Tool=Tool={}))},{}],43:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WindTurbinePlanner=void 0;var math_1=require("@daign/math");var _2d_graphics_1=require("@daign/2d-graphics");var _2d_graphics_svg_1=require("@daign/2d-graphics-svg");var schedule_1=require("@daign/schedule");var style_sheets_1=require("@daign/style-sheets");var controls_1=require("./controls");var types_1=require("./types");var handles_1=require("./handles");var basic_elements_1=require("./basic-elements");var gui_1=require("./gui");var managers_1=require("./managers");var WindTurbinePlanner=function(){function WindTurbinePlanner(){var _a;var _this=this;this.renderer=null;this.distanceAlert=new controls_1.DistanceAlert;this.deforestationEstimate=new controls_1.DeforestationEstimate;this.layers=(_a={},_a[types_1.Layer.BackgroundImage]=new _2d_graphics_1.Group,_a[types_1.Layer.CityArea]=new _2d_graphics_1.Group,_a[types_1.Layer.WoodArea]=new _2d_graphics_1.Group,_a[types_1.Layer.Turbines]=new _2d_graphics_1.Group,_a);this.svgContext=new _2d_graphics_svg_1.SvgContext;this.calculateContextSize();var svgContainer=document.getElementById("svg-container");if(svgContainer){svgContainer.appendChild(this.svgContext.domNode)}this.application=new _2d_graphics_1.Application(this.svgContext,true);this.view=new _2d_graphics_1.ApplicationView(this.application);this.layerMenu=new gui_1.LayerMenu;this.layerManager=new managers_1.LayerManager(this,this.layerMenu);this.layerManager.subscribeToChanges(function(){_this.setLayer();_this.toolManager.setLayer(_this.layerManager.currentLayer)});this.toolMenu=new gui_1.ToolMenu;this.toolManager=new managers_1.ToolManager(this,this.toolMenu);this.toolManager.subscribeToChanges(function(){_this.setTool();_this.application.redraw()});this.scaleBar=new gui_1.ScaleBar(this.svgContext,this.application.drawingLayer);this.application.updateManager.subscribeToRedrawEvent(function(){_this.scaleBar.redraw()});this.application.appendChild(this.layerMenu);this.application.appendChild(this.toolMenu);this.application.appendChild(this.scaleBar);this.toolManager.setLayer(this.layerManager.currentLayer);this.backgroundImage=new controls_1.BackgroundImage(this.application,[new math_1.Vector2(0,0),new math_1.Vector2(0,-1500),new math_1.Vector2(-500,500),new math_1.Vector2(500,500)]);this.turbines=new controls_1.WindTurbineControl(this.application);this.cityAreaManager=new controls_1.AreaControlManager(this.application);this.cityAreaManager.setLayer(this.layers[types_1.Layer.CityArea]);this.woodAreaManager=new controls_1.AreaControlManager(this.application);this.woodAreaManager.setLayer(this.layers[types_1.Layer.WoodArea]);this.turbines.points.subscribeToChanges(function(){var cityAreas=_this.cityAreaManager.areas;var woodAreas=_this.woodAreaManager.areas;_this.distanceAlert.redraw(_this.turbines,cityAreas);_this.deforestationEstimate.redraw(_this.turbines,woodAreas)});this.cityAreaManager.subscribeToChanges(function(){var cityAreas=_this.cityAreaManager.areas;_this.distanceAlert.redraw(_this.turbines,cityAreas)});this.woodAreaManager.subscribeToChanges(function(){var woodAreas=_this.woodAreaManager.areas;_this.deforestationEstimate.redraw(_this.turbines,woodAreas)});var cityAreaFactory=new controls_1.AreaFactory(false,this.cityAreaManager);var woodAreaFactory=new controls_1.AreaFactory(true,this.woodAreaManager);this.constructGraphic();this.fileUploader=new gui_1.FileUploader(this.application,"fileInput",this.backgroundImage);this.drawCityHandle=new handles_1.DrawAreaHandle(this.svgContext.domNode,this.application,cityAreaFactory);this.drawWoodHandle=new handles_1.DrawAreaHandle(this.svgContext.domNode,this.application,woodAreaFactory);this.drawTurbineHandle=new handles_1.DrawTurbineHandle(this.svgContext.domNode,this.application,this.turbines);this.setLayer();var resizeCallback=function(){_this.calculateContextSize();_this.application.drawingLayer.updateViewport();_this.application.redraw()};var throttledResizeCallback=schedule_1.Schedule.deferringThrottle(resizeCallback,100,this);window.addEventListener("resize",throttledResizeCallback);this.application.updateManager.setRenderFunction(function(){_this.drawGraphic()});Promise.all([this.loadStyleSheet().then(function(styleSheet){var rendererFactory=new _2d_graphics_svg_1.RendererFactory;_this.renderer=rendererFactory.createRenderer(styleSheet);_this.renderer.addRenderModule(basic_elements_1.roundedRectangleModule);_this.renderer.useNativeTransforms=true;_this.renderer.flattenGroups=false;_this.renderer.useInlineStyles=true}),this.loadSvgFile("./assets/icons.svg").then(function(svgContent){_this.svgContext.defsNode.domNode.innerHTML+=svgContent}),this.loadSvgFile("./assets/map.svg").then(function(svgContent){_this.svgContext.defsNode.domNode.innerHTML+=svgContent})]).then(function(){_this.drawGraphic()})}WindTurbinePlanner.prototype.loadStyleSheet=function(){return fetch("./graphicStyle.scss").then(function(response){if(!response.ok){throw new Error("Failed to load the graphics style.")}return response.text().then(function(content){var styleSheet=new style_sheets_1.StyleSheet;styleSheet.parseFromString(content,_2d_graphics_1.GraphicStyle);return styleSheet})})};WindTurbinePlanner.prototype.loadSvgFile=function(filePath){return fetch(filePath).then(function(response){if(!response.ok){throw new Error("Failed to load SVG file.")}return response.text().then(function(content){var parser=new DOMParser;var svg=parser.parseFromString(content,"image/svg+xml").documentElement;if(!svg.firstElementChild){throw new Error("SVG file is empty.")}return svg.firstElementChild.innerHTML})})};WindTurbinePlanner.prototype.constructGraphic=function(){this.application.drawingLayer.clearChildren();this.layers[types_1.Layer.BackgroundImage].addClass("background-image-layer");this.application.drawingLayer.appendChild(this.layers[types_1.Layer.BackgroundImage]);this.layers[types_1.Layer.CityArea].addClass("city-layer");this.application.drawingLayer.appendChild(this.layers[types_1.Layer.CityArea]);this.layers[types_1.Layer.WoodArea].addClass("wood-layer");this.application.drawingLayer.appendChild(this.layers[types_1.Layer.WoodArea]);this.layers[types_1.Layer.Turbines].addClass("turbine-layer");this.application.drawingLayer.appendChild(this.layers[types_1.Layer.Turbines]);this.application.drawingLayer.appendChild(this.deforestationEstimate);this.application.drawingLayer.appendChild(this.distanceAlert);this.layers[types_1.Layer.BackgroundImage].appendChild(this.backgroundImage);this.layers[types_1.Layer.Turbines].appendChild(this.turbines);this.application.drawingLayer.viewScale.x=.4;this.application.drawingLayer.viewCenter.set(0,0);this.application.drawingLayer.scaleMin=.01;this.application.drawingLayer.scaleMax=100;var viewLimit=Math.pow(10,6);var viewCenterLimit=this.application.drawingLayer.viewCenterLimit;viewCenterLimit.makeEmpty();viewCenterLimit.expandByPoint(new math_1.Vector2(-viewLimit,-viewLimit));viewCenterLimit.expandByPoint(new math_1.Vector2(viewLimit,viewLimit));this.view.mountNode(this.application)};WindTurbinePlanner.prototype.calculateContextSize=function(){var toolbarHeight=60;this.svgContext.size=new math_1.Vector2(window.innerWidth,window.innerHeight-toolbarHeight)};WindTurbinePlanner.prototype.setLayer=function(){this.layers[types_1.Layer.BackgroundImage].setVariableClass("state","inactive");this.layers[types_1.Layer.CityArea].setVariableClass("state","inactive");this.layers[types_1.Layer.WoodArea].setVariableClass("state","inactive");this.layers[types_1.Layer.Turbines].setVariableClass("state","inactive");this.application.selectionManager.setSelection(null,null);var currentLayer=this.layerManager.currentLayer;this.layers[currentLayer].setVariableClass("state","active")};WindTurbinePlanner.prototype.setTool=function(){this.application.drawingLayer.enableViewportActions(true);if(this.drawCityHandle){this.drawCityHandle.enabled=false}if(this.drawWoodHandle){this.drawWoodHandle.enabled=false}if(this.drawTurbineHandle){this.drawTurbineHandle.enabled=false}var currentLayer=this.layerManager.currentLayer;var currentTool=this.toolManager.currentTool;if(currentLayer===types_1.Layer.BackgroundImage){if(this.backgroundImage){this.backgroundImage.setTool(currentTool)}}else if(currentLayer===types_1.Layer.CityArea){this.cityAreaManager.setTool(currentTool);if(currentTool===types_1.Tool.Draw){this.drawCityHandle.enabled=true;this.application.drawingLayer.enableViewportActions(false)}}else if(currentLayer===types_1.Layer.WoodArea){this.woodAreaManager.setTool(currentTool);if(currentTool===types_1.Tool.Draw){this.drawWoodHandle.enabled=true;this.application.drawingLayer.enableViewportActions(false)}}else if(currentLayer===types_1.Layer.Turbines){this.turbines.setTool(currentTool);if(currentTool===types_1.Tool.Draw){this.drawTurbineHandle.enabled=true;this.application.drawingLayer.enableViewportActions(false)}}};WindTurbinePlanner.prototype.setExampleMap=function(){this.backgroundImage.useReference="#exampleMap";this.application.selectionManager.setSelection(this.backgroundImage,null);this.application.redraw()};WindTurbinePlanner.prototype.drawGraphic=function(){if(this.renderer){this.renderer.render(this.view,this.svgContext.contentNode)}};return WindTurbinePlanner}();exports.WindTurbinePlanner=WindTurbinePlanner},{"./basic-elements":13,"./controls":25,"./gui":29,"./handles":36,"./managers":37,"./types":40,"@daign/2d-graphics":106,"@daign/2d-graphics-svg":44,"@daign/math":135,"@daign/schedule":154,"@daign/style-sheets":156}],44:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RendererFactory=exports.RenderModule=exports.SvgRenderer=exports.SvgContext=void 0;var svgContext_1=require("./svgContext");Object.defineProperty(exports,"SvgContext",{enumerable:true,get:function(){return svgContext_1.SvgContext}});var svgRenderer_1=require("./svgRenderer");Object.defineProperty(exports,"SvgRenderer",{enumerable:true,get:function(){return svgRenderer_1.SvgRenderer}});var renderModule_1=require("./renderModule");Object.defineProperty(exports,"RenderModule",{enumerable:true,get:function(){return renderModule_1.RenderModule}});var rendererFactory_1=require("./rendererFactory");Object.defineProperty(exports,"RendererFactory",{enumerable:true,get:function(){return rendererFactory_1.RendererFactory}})},{"./renderModule":45,"./rendererFactory":67,"./svgContext":68,"./svgRenderer":69}],45:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RenderModule=void 0;var RenderModule=function(){function RenderModule(type,callback){this.type=type;this.callback=callback}return RenderModule}();exports.RenderModule=RenderModule},{}],46:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.buttonControlModule=void 0;var handle_1=require("@daign/handle");var _2d_graphics_1=require("@daign/2d-graphics");var renderModule_1=require("../renderModule");exports.buttonControlModule=new renderModule_1.RenderModule(_2d_graphics_1.ButtonControl,function(currentNode,_p,_s,node){if(node!==null){var buttonControl_1=currentNode.sourceNode;var handle=new handle_1.Handle;handle.setStartNode(node);handle.beginning=function(){return true};handle.clicked=function(){buttonControl_1.click()}}return null})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/handle":126}],47:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.clipPathModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.clipPathModule=new renderModule_1.RenderModule(_2d_graphics_1.ClipPath,function(currentNode,_p,selectorChain,_n,renderer){var clipPath=currentNode.sourceNode;selectorChain.addSelector(clipPath.styleSelector);var clipPathNode=dom_pool_1.WrappedDomPool.getSvg("clipPath");currentNode.children.forEach(function(child){var selectorChainCopy=selectorChain.clone();var renderedNode=renderer.renderRecursive(child,selectorChainCopy);renderer.appendRenderedNode(clipPathNode,renderedNode)});return clipPathNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],48:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.controlObjectModule=void 0;var handle_1=require("@daign/handle");var _2d_graphics_1=require("@daign/2d-graphics");var renderModule_1=require("../renderModule");exports.controlObjectModule=new renderModule_1.RenderModule(_2d_graphics_1.ControlObject,function(currentNode,_p,_s,node){if(node!==null){var controlObject_1=currentNode.sourceNode;var handle=new handle_1.Handle;handle.setStartNode(node);handle.beginning=function(){return true};handle.clicked=function(){if(controlObject_1){controlObject_1.presentationNodes.forEach(function(pn){if(pn.view instanceof _2d_graphics_1.ApplicationView){pn.view.application.selectionManager.setSelection(controlObject_1,null);pn.view.application.redraw()}})}}}return null})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/handle":126}],49:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.controlPointModule=void 0;var handle_1=require("@daign/handle");var _2d_graphics_1=require("@daign/2d-graphics");var renderModule_1=require("../renderModule");exports.controlPointModule=new renderModule_1.RenderModule(_2d_graphics_1.ControlPoint,function(currentNode,_p,_s,node){if(node!==null){var controlPoint_1=currentNode.sourceNode;var handle_2=new handle_1.Handle;handle_2.setStartNode(node);handle_2.beginning=function(){controlPoint_1.snap();controlPoint_1.application.selectionManager.setSelection(controlPoint_1.controlObject,controlPoint_1.targetPoint);controlPoint_1.application.redraw();return true};handle_2.continuing=function(){if(handle_2.delta){controlPoint_1.drag(handle_2.delta.clone())}}}return null})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/handle":126}],50:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fixedRadiusCircleModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.fixedRadiusCircleModule=new renderModule_1.RenderModule(_2d_graphics_1.FixedRadiusCircle,function(currentNode,projection,selectorChain){var circle=currentNode.sourceNode;selectorChain.addSelector(circle.styleSelector);var center=circle.getCenterTransformed(projection);var radius=circle.radius;var circleNode=dom_pool_1.WrappedDomPool.getSvg("circle");circleNode.setAttribute("cx",String(center.x));circleNode.setAttribute("cy",String(center.y));circleNode.setAttribute("r",String(radius));return circleNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],51:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.groupModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.groupModule=new renderModule_1.RenderModule(_2d_graphics_1.Group,function(currentNode,_p,selectorChain,_n,renderer){var group=currentNode.sourceNode;selectorChain.addSelector(group.styleSelector);var groupNode=dom_pool_1.WrappedDomPool.getSvg("g");currentNode.children.forEach(function(child){var selectorChainCopy=selectorChain.clone();var renderedNode=renderer.renderRecursive(child,selectorChainCopy);renderer.appendRenderedNode(groupNode,renderedNode)});return groupNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],52:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.viewModule=exports.useElementModule=exports.twoPointRectangleModule=exports.twoPointPatternModule=exports.twoPointImageModule=exports.twoPointCircleModule=exports.textModule=exports.symbolElementModule=exports.scalableTextModule=exports.quadraticCurveModule=exports.polylineModule=exports.polygonModule=exports.maskModule=exports.lineModule=exports.groupModule=exports.fixedRadiusCircleModule=exports.controlPointModule=exports.controlObjectModule=exports.clipPathModule=exports.buttonControlModule=void 0;var buttonControlModule_1=require("./buttonControlModule");Object.defineProperty(exports,"buttonControlModule",{enumerable:true,get:function(){return buttonControlModule_1.buttonControlModule}});var clipPathModule_1=require("./clipPathModule");Object.defineProperty(exports,"clipPathModule",{enumerable:true,get:function(){return clipPathModule_1.clipPathModule}});var controlObjectModule_1=require("./controlObjectModule");Object.defineProperty(exports,"controlObjectModule",{enumerable:true,get:function(){return controlObjectModule_1.controlObjectModule}});var controlPointModule_1=require("./controlPointModule");Object.defineProperty(exports,"controlPointModule",{enumerable:true,get:function(){return controlPointModule_1.controlPointModule}});var fixedRadiusCircleModule_1=require("./fixedRadiusCircleModule");Object.defineProperty(exports,"fixedRadiusCircleModule",{enumerable:true,get:function(){return fixedRadiusCircleModule_1.fixedRadiusCircleModule}});var groupModule_1=require("./groupModule");Object.defineProperty(exports,"groupModule",{enumerable:true,get:function(){return groupModule_1.groupModule}});var lineModule_1=require("./lineModule");Object.defineProperty(exports,"lineModule",{enumerable:true,get:function(){return lineModule_1.lineModule}});var maskModule_1=require("./maskModule");Object.defineProperty(exports,"maskModule",{enumerable:true,get:function(){return maskModule_1.maskModule}});var polygonModule_1=require("./polygonModule");Object.defineProperty(exports,"polygonModule",{enumerable:true,get:function(){return polygonModule_1.polygonModule}});var polylineModule_1=require("./polylineModule");Object.defineProperty(exports,"polylineModule",{enumerable:true,get:function(){return polylineModule_1.polylineModule}});var quadraticCurveModule_1=require("./quadraticCurveModule");Object.defineProperty(exports,"quadraticCurveModule",{enumerable:true,get:function(){return quadraticCurveModule_1.quadraticCurveModule}});var scalableTextModule_1=require("./scalableTextModule");Object.defineProperty(exports,"scalableTextModule",{enumerable:true,get:function(){return scalableTextModule_1.scalableTextModule}});var symbolElementModule_1=require("./symbolElementModule");Object.defineProperty(exports,"symbolElementModule",{enumerable:true,get:function(){return symbolElementModule_1.symbolElementModule}});var textModule_1=require("./textModule");Object.defineProperty(exports,"textModule",{enumerable:true,get:function(){return textModule_1.textModule}});var twoPointCircleModule_1=require("./twoPointCircleModule");Object.defineProperty(exports,"twoPointCircleModule",{enumerable:true,get:function(){return twoPointCircleModule_1.twoPointCircleModule}});var twoPointImageModule_1=require("./twoPointImageModule");Object.defineProperty(exports,"twoPointImageModule",{enumerable:true,get:function(){return twoPointImageModule_1.twoPointImageModule}});var twoPointPatternModule_1=require("./twoPointPatternModule");Object.defineProperty(exports,"twoPointPatternModule",{enumerable:true,get:function(){return twoPointPatternModule_1.twoPointPatternModule}});var twoPointRectangleModule_1=require("./twoPointRectangleModule");Object.defineProperty(exports,"twoPointRectangleModule",{enumerable:true,get:function(){return twoPointRectangleModule_1.twoPointRectangleModule}});var useElementModule_1=require("./useElementModule");Object.defineProperty(exports,"useElementModule",{enumerable:true,get:function(){return useElementModule_1.useElementModule}});var viewModule_1=require("./viewModule");Object.defineProperty(exports,"viewModule",{enumerable:true,get:function(){return viewModule_1.viewModule}})},{"./buttonControlModule":46,"./clipPathModule":47,"./controlObjectModule":48,"./controlPointModule":49,"./fixedRadiusCircleModule":50,"./groupModule":51,"./lineModule":53,"./maskModule":54,"./polygonModule":55,"./polylineModule":56,"./quadraticCurveModule":57,"./scalableTextModule":58,"./symbolElementModule":59,"./textModule":60,"./twoPointCircleModule":61,"./twoPointImageModule":62,"./twoPointPatternModule":63,"./twoPointRectangleModule":64,"./useElementModule":65,"./viewModule":66}],53:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.lineModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.lineModule=new renderModule_1.RenderModule(_2d_graphics_1.Line,function(currentNode,projection,selectorChain){var line=currentNode.sourceNode;selectorChain.addSelector(line.styleSelector);var startPoint=line.getStartTransformed(projection);var endPoint=line.getEndTransformed(projection);var lineNode=dom_pool_1.WrappedDomPool.getSvg("line");lineNode.setAttribute("x1",String(startPoint.x));lineNode.setAttribute("y1",String(startPoint.y));lineNode.setAttribute("x2",String(endPoint.x));lineNode.setAttribute("y2",String(endPoint.y));return lineNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],54:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.maskModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.maskModule=new renderModule_1.RenderModule(_2d_graphics_1.Mask,function(currentNode,_p,selectorChain,_n,renderer){var mask=currentNode.sourceNode;selectorChain.addSelector(mask.styleSelector);var maskNode=dom_pool_1.WrappedDomPool.getSvg("mask");currentNode.children.forEach(function(child){var selectorChainCopy=selectorChain.clone();var renderedNode=renderer.renderRecursive(child,selectorChainCopy);renderer.appendRenderedNode(maskNode,renderedNode)});return maskNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],55:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.polygonModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.polygonModule=new renderModule_1.RenderModule(_2d_graphics_1.Polygon,function(currentNode,projection,selectorChain){var polygon=currentNode.sourceNode;selectorChain.addSelector(polygon.styleSelector);var points=polygon.getPointsTransformed(projection);var pointsString=points.map(function(p){return"".concat(p.x,",").concat(p.y)}).join(" ");var polygonNode=dom_pool_1.WrappedDomPool.getSvg("polygon");polygonNode.setAttribute("points",pointsString);return polygonNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],56:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.polylineModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.polylineModule=new renderModule_1.RenderModule(_2d_graphics_1.Polyline,function(currentNode,projection,selectorChain){var polyline=currentNode.sourceNode;selectorChain.addSelector(polyline.styleSelector);var points=polyline.getPointsTransformed(projection);var pointsString=points.map(function(p){return"".concat(p.x,",").concat(p.y)}).join(" ");var polylineNode=dom_pool_1.WrappedDomPool.getSvg("polyline");polylineNode.setAttribute("points",pointsString);return polylineNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],57:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.quadraticCurveModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.quadraticCurveModule=new renderModule_1.RenderModule(_2d_graphics_1.QuadraticCurve,function(currentNode,projection,selectorChain){var curve=currentNode.sourceNode;selectorChain.addSelector(curve.styleSelector);var points=curve.getPointsTransformed(projection);var pathString=points.map(function(p,index){if(index===0){return"M ".concat(p.x,",").concat(p.y," Q")}return"".concat(p.x,",").concat(p.y)}).join(" ");var pathNode=dom_pool_1.WrappedDomPool.getSvg("path");pathNode.setAttribute("d",pathString);return pathNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],58:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.scalableTextModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.scalableTextModule=new renderModule_1.RenderModule(_2d_graphics_1.ScalableText,function(currentNode,projection,selectorChain){var text=currentNode.sourceNode;selectorChain.addSelector(text.styleSelector);var anchor=text.getAnchorTransformed(projection);var fontSize=text.getFontSizeTransformed(projection);var textNode=dom_pool_1.WrappedDomPool.getSvg("text");textNode.setAttribute("x",String(anchor.x));textNode.setAttribute("y",String(anchor.y));textNode.setAttribute("text-anchor",text.textAnchor);textNode.textContent=text.content;textNode.setAttribute("font-size",String(fontSize));return textNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],59:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.symbolElementModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.symbolElementModule=new renderModule_1.RenderModule(_2d_graphics_1.SymbolElement,function(currentNode,_p,selectorChain,_n,renderer){var symbolElement=currentNode.sourceNode;selectorChain.addSelector(symbolElement.styleSelector);var symbolElementNode=dom_pool_1.WrappedDomPool.getSvg("symbol");currentNode.children.forEach(function(child){var selectorChainCopy=selectorChain.clone();var renderedNode=renderer.renderRecursive(child,selectorChainCopy);renderer.appendRenderedNode(symbolElementNode,renderedNode)});return symbolElementNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],60:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.textModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.textModule=new renderModule_1.RenderModule(_2d_graphics_1.Text,function(currentNode,projection,selectorChain){var text=currentNode.sourceNode;selectorChain.addSelector(text.styleSelector);var anchor=text.getAnchorTransformed(projection);var textNode=dom_pool_1.WrappedDomPool.getSvg("text");textNode.setAttribute("x",String(anchor.x));textNode.setAttribute("y",String(anchor.y));textNode.setAttribute("text-anchor",text.textAnchor);textNode.textContent=text.content;return textNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],61:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.twoPointCircleModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.twoPointCircleModule=new renderModule_1.RenderModule(_2d_graphics_1.TwoPointCircle,function(currentNode,projection,selectorChain){var circle=currentNode.sourceNode;selectorChain.addSelector(circle.styleSelector);var center=circle.getCenterTransformed(projection);var radius=circle.getRadiusTransformed(projection);var circleNode=dom_pool_1.WrappedDomPool.getSvg("circle");circleNode.setAttribute("cx",String(center.x));circleNode.setAttribute("cy",String(center.y));circleNode.setAttribute("r",String(radius));return circleNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],62:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.twoPointImageModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.twoPointImageModule=new renderModule_1.RenderModule(_2d_graphics_1.TwoPointImage,function(currentNode,projection,selectorChain){var image=currentNode.sourceNode;selectorChain.addSelector(image.styleSelector);var startPoint=image.getStartTransformed(projection);var size=image.getSizeTransformed(projection);var imageNode=dom_pool_1.WrappedDomPool.getSvg("image");imageNode.setAttribute("x",String(startPoint.x));imageNode.setAttribute("y",String(startPoint.y));imageNode.setAttribute("width",String(size.x));imageNode.setAttribute("height",String(size.y));imageNode.setAttributeNS(dom_pool_1.WrappedDomPool.xlinkNamespace,"href",image.href);return imageNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],63:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.twoPointPatternModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.twoPointPatternModule=new renderModule_1.RenderModule(_2d_graphics_1.TwoPointPattern,function(currentNode,projection,selectorChain,_n,renderer){var pattern=currentNode.sourceNode;selectorChain.addSelector(pattern.styleSelector);var startPoint=pattern.getStartTransformed(projection);var size=pattern.getSizeTransformed(projection);var patternNode=dom_pool_1.WrappedDomPool.getSvg("pattern");patternNode.setAttribute("x",String(startPoint.x));patternNode.setAttribute("y",String(startPoint.y));patternNode.setAttribute("width",String(size.x));patternNode.setAttribute("height",String(size.y));currentNode.children.forEach(function(child){var selectorChainCopy=selectorChain.clone();var renderedNode=renderer.renderRecursive(child,selectorChainCopy);renderer.appendRenderedNode(patternNode,renderedNode)});return patternNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],64:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.twoPointRectangleModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.twoPointRectangleModule=new renderModule_1.RenderModule(_2d_graphics_1.TwoPointRectangle,function(currentNode,projection,selectorChain){var rectangle=currentNode.sourceNode;selectorChain.addSelector(rectangle.styleSelector);var startPoint=rectangle.getStartTransformed(projection);var size=rectangle.getSizeTransformed(projection);var rectNode=dom_pool_1.WrappedDomPool.getSvg("rect");rectNode.setAttribute("x",String(startPoint.x));rectNode.setAttribute("y",String(startPoint.y));rectNode.setAttribute("width",String(size.x));rectNode.setAttribute("height",String(size.y));return rectNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],65:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.useElementModule=void 0;var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.useElementModule=new renderModule_1.RenderModule(_2d_graphics_1.UseElement,function(currentNode,projection,selectorChain){var useElement=currentNode.sourceNode;selectorChain.addSelector(useElement.styleSelector);var anchorPoint=useElement.getAnchorTransformed(projection);var useNode=dom_pool_1.WrappedDomPool.getSvg("use");useNode.setAttribute("x",String(anchorPoint.x));useNode.setAttribute("y",String(anchorPoint.y));useNode.setAttributeNS(dom_pool_1.WrappedDomPool.xlinkNamespace,"href",useElement.href);return useNode})},{"../renderModule":45,"@daign/2d-graphics":106,"@daign/dom-pool":121}],66:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.viewModule=void 0;var _2d_pipeline_1=require("@daign/2d-pipeline");var dom_pool_1=require("@daign/dom-pool");var renderModule_1=require("../renderModule");exports.viewModule=new renderModule_1.RenderModule(_2d_pipeline_1.View,function(currentNode,_p,selectorChain,_n,renderer){var groupNode=dom_pool_1.WrappedDomPool.getSvg("g");currentNode.children.forEach(function(child){var selectorChainCopy=selectorChain.clone();var renderedNode=renderer.renderRecursive(child,selectorChainCopy);renderer.appendRenderedNode(groupNode,renderedNode)});return groupNode})},{"../renderModule":45,"@daign/2d-pipeline":110,"@daign/dom-pool":121}],67:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RendererFactory=void 0;var svgRenderer_1=require("./svgRenderer");var renderModules_1=require("./renderModules");var RendererFactory=function(){function RendererFactory(){}RendererFactory.prototype.createRenderer=function(styleSheet){var renderer=new svgRenderer_1.SvgRenderer(styleSheet);renderer.addRenderModule(renderModules_1.lineModule);renderer.addRenderModule(renderModules_1.twoPointRectangleModule);renderer.addRenderModule(renderModules_1.polygonModule);renderer.addRenderModule(renderModules_1.polylineModule);renderer.addRenderModule(renderModules_1.twoPointCircleModule);renderer.addRenderModule(renderModules_1.fixedRadiusCircleModule);renderer.addRenderModule(renderModules_1.quadraticCurveModule);renderer.addRenderModule(renderModules_1.textModule);renderer.addRenderModule(renderModules_1.scalableTextModule);renderer.addRenderModule(renderModules_1.twoPointImageModule);renderer.addRenderModule(renderModules_1.twoPointPatternModule);renderer.addRenderModule(renderModules_1.useElementModule);renderer.addRenderModule(renderModules_1.maskModule);renderer.addRenderModule(renderModules_1.clipPathModule);renderer.addRenderModule(renderModules_1.symbolElementModule);renderer.addRenderModule(renderModules_1.groupModule);renderer.addRenderModule(renderModules_1.viewModule);renderer.addRenderModule(renderModules_1.controlObjectModule);renderer.addRenderModule(renderModules_1.controlPointModule);renderer.addRenderModule(renderModules_1.buttonControlModule);return renderer};return RendererFactory}();exports.RendererFactory=RendererFactory},{"./renderModules":52,"./svgRenderer":69}],68:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SvgContext=void 0;var math_1=require("@daign/math");var dom_pool_1=require("@daign/dom-pool");var SvgContext=function(){function SvgContext(){this._size=new math_1.Vector2(1,1);this.svgNode=dom_pool_1.WrappedDomPool.getSvg("svg");this.styleNode=dom_pool_1.WrappedDomPool.getSvg("style");this.svgNode.appendChild(this.styleNode);this.defsNode=dom_pool_1.WrappedDomPool.getSvg("defs");this.svgNode.appendChild(this.defsNode);this.contentNode=dom_pool_1.WrappedDomPool.getSvg("g");this.svgNode.appendChild(this.contentNode)}Object.defineProperty(SvgContext.prototype,"domNode",{get:function(){return this.svgNode.domNode},enumerable:false,configurable:true});Object.defineProperty(SvgContext.prototype,"size",{get:function(){return this._size},set:function(size){this._size.copy(size);this.domNode.setAttribute("xmlns",dom_pool_1.WrappedDomPool.svgNamespace);this.domNode.setAttribute("xmlns:xlink",dom_pool_1.WrappedDomPool.xlinkNamespace);this.domNode.style.width="".concat(size.x,"px");this.domNode.style.height="".concat(size.y,"px");this.domNode.setAttribute("viewBox","0,0,".concat(size.x,",").concat(size.y))},enumerable:false,configurable:true});return SvgContext}();exports.SvgContext=SvgContext},{"@daign/dom-pool":121,"@daign/math":135}],69:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SvgRenderer=void 0;var style_sheets_1=require("@daign/style-sheets");var _2d_graphics_1=require("@daign/2d-graphics");var dom_pool_1=require("@daign/dom-pool");var handle_1=require("@daign/handle");var SvgRenderer=function(){function SvgRenderer(styleSheet){this.styleSheet=styleSheet;this.renderModules=[];this.flattenGroups=false;this.useNativeTransforms=false;this.useInlineStyles=false}SvgRenderer.prototype.addRenderModule=function(renderModule){this.renderModules.push(renderModule)};SvgRenderer.prototype.applyStyle=function(node,style){if(style.fill){node.setAttribute("fill",style.fill)}if(style.fillOpacity!==null){node.setAttribute("fill-opacity",String(style.fillOpacity))}if(style.fillRule){node.setAttribute("fill-rule",style.fillRule)}if(style.stroke){node.setAttribute("stroke",style.stroke)}if(style.strokeWidth!==null){node.setAttribute("stroke-width",String(style.strokeWidth))}if(style.strokeOpacity!==null){node.setAttribute("stroke-opacity",String(style.strokeOpacity))}if(style.strokeLinecap){node.setAttribute("stroke-linecap",style.strokeLinecap)}if(style.strokeLinejoin){node.setAttribute("stroke-linejoin",style.strokeLinejoin)}if(style.strokeMiterlimit!==null){node.setAttribute("stroke-miterlimit",String(style.strokeMiterlimit))}if(style.strokeDasharray){node.setAttribute("stroke-dasharray",style.strokeDasharray)}if(style.strokeDashoffset!==null){node.setAttribute("stroke-dashoffset",String(style.strokeDashoffset))}if(style.vectorEffect){node.setAttribute("vector-effect",style.vectorEffect)}if(style.display){node.setAttribute("display",style.display)}if(style.visibility){node.setAttribute("visibility",style.visibility)}if(style.opacity!==null){node.setAttribute("opacity",String(style.opacity))}if(style.paintOrder){node.setAttribute("paint-order",style.paintOrder)}if(style.mask){node.setAttribute("mask",style.mask)}if(style.fontFamily){node.style.fontFamily=style.fontFamily}if(style.fontSize){node.style.fontSize=style.fontSize}if(style.fontStyle){node.style.fontStyle=style.fontStyle}if(style.fontVariant){node.style.fontVariant=style.fontVariant}if(style.fontWeight){node.style.fontWeight=style.fontWeight}if(style.fontStretch){node.style.fontStretch=style.fontStretch}if(style.letterSpacing){node.style.letterSpacing=style.letterSpacing}if(style.wordSpacing){node.style.wordSpacing=style.wordSpacing}if(style.textDecoration){node.style.textDecoration=style.textDecoration}if(style.pointerEvents){node.setAttribute("pointer-events",style.pointerEvents)}if(style.cursor){node.setAttribute("cursor",style.cursor)}};SvgRenderer.prototype.renderRecursive=function(currentNode,selectorChain){var _this=this;var sourceNode=currentNode.sourceNode;var node=null;var projection=this.useNativeTransforms?currentNode.projectNodeToViewNonNative:currentNode.projectNodeToView;this.renderModules.forEach(function(module){if(_this.doesModuleMatchToNode(sourceNode,module.type)){var result=module.callback(currentNode,projection,selectorChain,node,_this);if(result!==null){node=result}}});if(node!==null){node=node;if(this.useNativeTransforms){var transformCommand=currentNode.sourceNode.transformation.nativeSvgTransform;if(transformCommand){node.setAttribute("transform",transformCommand)}}if(sourceNode instanceof _2d_graphics_1.StyledGraphicNode){if(this.useInlineStyles){var styleProcessor=new style_sheets_1.StyleProcessor;var calculatedStyle=styleProcessor.calculateStyle(this.styleSheet,selectorChain,_2d_graphics_1.GraphicStyle,sourceNode.elementStyle||undefined);this.applyStyle(node,calculatedStyle)}else{var classNames=sourceNode.styleSelector.printSelectorSpaced();node.setAttribute("class",classNames);if(sourceNode.elementStyle){this.applyStyle(node,sourceNode.elementStyle)}}if(sourceNode.id){node.setAttribute("id",sourceNode.id)}if(sourceNode.mask){node.setAttribute("mask",sourceNode.mask)}if(sourceNode.clipPath){node.setAttribute("clip-path",sourceNode.clipPath)}if(sourceNode.onclick){var handle=new handle_1.Handle;handle.setStartNode(node);handle.beginning=function(){return true};handle.clicked=function(){sourceNode.onclick()}}}}return node};SvgRenderer.prototype.clearRecursive=function(node){var _this=this;node.children.forEach(function(child){_this.clearRecursive(child)});dom_pool_1.WrappedDomPool.giveBack(node)};SvgRenderer.prototype.render=function(view,target){var _this=this;target.children.forEach(function(child){_this.clearRecursive(child)});target.clearChildren();var presentationNode=view.viewPresentationNode;var selectorChain=new style_sheets_1.StyleSelectorChain;if(presentationNode!==null){var renderedNode=this.renderRecursive(presentationNode,selectorChain);this.appendRenderedNode(target,renderedNode)}};SvgRenderer.prototype.doesModuleMatchToNode=function(graphicNode,moduleType){return graphicNode instanceof moduleType};SvgRenderer.prototype.appendRenderedNode=function(parent,renderedNode){if(renderedNode!==null){if(this.flattenGroups&&renderedNode.nodeName==="g"&&renderedNode.isPristine){renderedNode.children.forEach(function(subChild){parent.appendChild(subChild)});dom_pool_1.WrappedDomPool.giveBack(renderedNode)}else{parent.appendChild(renderedNode)}}};return SvgRenderer}();exports.SvgRenderer=SvgRenderer},{"@daign/2d-graphics":106,"@daign/dom-pool":121,"@daign/handle":126,"@daign/style-sheets":156}],70:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Application=void 0;var group_1=require("../basic-elements/group");var controlLayer_1=require("./controlLayer");var interactiveViewport_1=require("./interactiveViewport");var selectionManager_1=require("./selectionManager");var viewport_1=require("./viewport");var updateManager_1=require("./updateManager");var Application=function(_super){__extends(Application,_super);function Application(context,interactive){if(interactive===void 0){interactive=false}var _this=_super.call(this)||this;_this.controlLayer=null;_this.selectionManager=new selectionManager_1.SelectionManager;_this.updateManager=new updateManager_1.UpdateManager;if(interactive){_this.drawingLayer=new interactiveViewport_1.InteractiveViewport(context,_this);_this.appendChild(_this.drawingLayer);_this.controlLayer=new controlLayer_1.ControlLayer(_this);_this.appendChild(_this.controlLayer)}else{_this.drawingLayer=new viewport_1.Viewport(context,_this);_this.appendChild(_this.drawingLayer)}return _this}Application.prototype.fitToContent=function(margin){this.drawingLayer.fitToContent(margin)};Application.prototype.redraw=function(){this.updateManager.redraw()};return Application}(group_1.Group);exports.Application=Application},{"../basic-elements/group":79,"./controlLayer":72,"./interactiveViewport":73,"./selectionManager":74,"./updateManager":75,"./viewport":76}],71:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ApplicationView=void 0;var _2d_pipeline_1=require("@daign/2d-pipeline");var ApplicationView=function(_super){__extends(ApplicationView,_super);function ApplicationView(application){var _this=_super.call(this)||this;_this.application=application;return _this}return ApplicationView}(_2d_pipeline_1.View);exports.ApplicationView=ApplicationView},{"@daign/2d-pipeline":110}],72:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ControlLayer=void 0;var basic_elements_1=require("../basic-elements");var ControlLayer=function(_super){__extends(ControlLayer,_super);function ControlLayer(application){var _this=_super.call(this)||this;_this.application=application;_this.baseClass="control-layer";_this.application.updateManager.setRedrawControlsFunction(function(){_this.redrawControls()});return _this}ControlLayer.prototype.redrawControls=function(){this.clearChildren();var activeObject=this.application.selectionManager.activeObject;var activePoint=this.application.selectionManager.activePoint;if(activeObject){var node=activeObject.redrawControlObjects(activePoint,this.application);this.appendChild(node)}};return ControlLayer}(basic_elements_1.Group);exports.ControlLayer=ControlLayer},{"../basic-elements":80}],73:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.InteractiveViewport=void 0;var handle_1=require("@daign/handle");var math_1=require("@daign/math");var viewport_1=require("./viewport");var InteractiveViewport=function(_super){__extends(InteractiveViewport,_super);function InteractiveViewport(context,application){var _this=_super.call(this,context,application)||this;_this.viewportHandle=undefined;_this.extractFromTouchEventRelativeToContext=function(event,touchIndex){if(!_this.context.domNode||!_this.context.domNode.getBoundingClientRect){throw new Error("Unable to read offset of context node.")}var rect=_this.context.domNode.getBoundingClientRect();if(!rect||rect.left===undefined||rect.top===undefined){throw new Error("Unable to read offset of context node.")}if(!event||!event.touches||!event.touches[touchIndex]||event.touches[touchIndex].pageX===undefined||event.touches[touchIndex].pageY===undefined){throw new Error("Unable to extract position from event.")}var x=event.touches[touchIndex].pageX-rect.left;var y=event.touches[touchIndex].pageY-rect.top;return new math_1.Vector2(x,y)};if(context.domNode){var minimumDragDistance=5;var extractFromEvent=function(event){return(new math_1.Vector2).setFromEventRelative(event)};var extractFromTouchEvent=_this.extractFromTouchEventRelativeToContext;var handle_2=new handle_1.MultiTouchScrollHandle;handle_2.setStartNode(context.domNode);handle_2.minimumDragDistance=minimumDragDistance;handle_2.extractFromEvent=extractFromEvent;handle_2.extractFromTouchEvent=extractFromTouchEvent;_this.viewportHandle=handle_2;var transformationSnapshot_1;handle_2.beginning=function(){_this.viewCenter.snap();_this.viewScale.snap();transformationSnapshot_1=_this.transformation.inverseTransformMatrix.clone();return true};handle_2.continuing=function(){var startPosition1=handle_2.getStartPosition(0);var startPosition2=handle_2.getStartPosition(1);var tempPosition1=handle_2.getTempPosition(0);var tempPosition2=handle_2.getTempPosition(1);var delta1=handle_2.getDelta(0);if(startPosition1!==undefined&&startPosition2!==undefined&&tempPosition1!==undefined&&tempPosition2!==undefined&&_this.viewCenter.snapshot!==undefined&&_this.viewScale.snapshot!==undefined){var distanceStart=startPosition2.clone().sub(startPosition1).length();var distanceTemp=tempPosition2.clone().sub(tempPosition1).length();distanceStart=Math.max(distanceStart,1);distanceTemp=Math.max(distanceTemp,1);var zoomFactor=distanceTemp/distanceStart;var newScale=_this.viewScale.snapshot.x*zoomFactor;_this.viewScale.setSilent(newScale);var transformedTempPosition1=tempPosition1.clone().transform(transformationSnapshot_1);var transformedstartPosition1=startPosition1.clone().transform(transformationSnapshot_1);var newCenter=_this.viewCenter.snapshot.clone().sub(transformedTempPosition1).multiplyScalar(1/zoomFactor).add(transformedstartPosition1);_this.viewCenter.copySilent(newCenter)}else if(delta1!==undefined&&_this.viewCenter.snapshot!==undefined){var drag=delta1.clone().multiplyScalar(-1/_this.viewScale.x);var newCenter=_this.viewCenter.snapshot.clone().add(drag);_this.viewCenter.copySilent(newCenter)}_this.updateViewport();_this.application.redraw()};handle_2.clicked=function(){_this.application.selectionManager.setSelection(null,null);_this.application.redraw()};handle_2.scrolling=function(){var sign=Math.sign(handle_2.scroll.y);var factor=Math.pow(1.1,-sign);var oldScale=_this.viewScale.x;_this.viewScale.setSilent(oldScale*factor);factor=_this.viewScale.x/oldScale;var mousePosition=handle_2.scrollPosition.clone();mousePosition.transform(_this.transformation.inverseTransformMatrix);var newCenter=_this.viewCenter.clone().sub(mousePosition).multiplyScalar(1/factor).add(mousePosition);_this.viewCenter.copySilent(newCenter);_this.updateViewport();_this.application.redraw()}}return _this}InteractiveViewport.prototype.enableViewportActions=function(enabled){if(this.viewportHandle){this.viewportHandle.enabled=enabled}};return InteractiveViewport}(viewport_1.Viewport);exports.InteractiveViewport=InteractiveViewport},{"./viewport":76,"@daign/handle":126,"@daign/math":135}],74:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.SelectionManager=void 0;var observable_1=require("@daign/observable");var SelectionManager=function(_super){__extends(SelectionManager,_super);function SelectionManager(){var _this=_super.call(this)||this;_this.activeObject=null;_this.activePoint=null;return _this}SelectionManager.prototype.setSelection=function(activeObject,activePoint){if(activeObject===null&&activePoint!==null){return}if(activeObject!==null&&activePoint!==null){var points=activeObject.points.elements;if(points.indexOf(activePoint)===-1){return}}if(this.activeObject!==activeObject||this.activePoint!==activePoint){this.activeObject=activeObject;this.activePoint=activePoint;this.notifyObservers()}};return SelectionManager}(observable_1.Observable);exports.SelectionManager=SelectionManager},{"@daign/observable":150}],75:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.UpdateManager=void 0;var observable_1=require("@daign/observable");var UpdateManager=function(){function UpdateManager(){this.redrawEvent=new observable_1.EventEmitter;this.redrawControlsSignal=new observable_1.UnicastEventEmitter;this.renderSignal=new observable_1.UnicastEventEmitter}UpdateManager.prototype.subscribeToRedrawEvent=function(callback){this.redrawEvent.subscribeToChanges(callback)};UpdateManager.prototype.setRedrawControlsFunction=function(callback){this.redrawControlsSignal.setObserver(callback)};UpdateManager.prototype.setRenderFunction=function(callback){this.renderSignal.setObserver(callback)};UpdateManager.prototype.redraw=function(){this.redrawEvent.emit();this.redrawControlsSignal.emit();this.renderSignal.emit()};return UpdateManager}();exports.UpdateManager=UpdateManager},{"@daign/observable":150}],76:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Viewport=void 0;var math_1=require("@daign/math");var _2d_pipeline_1=require("@daign/2d-pipeline");var group_1=require("../basic-elements/group");var Viewport=function(_super){__extends(Viewport,_super);function Viewport(context,application){var _this=_super.call(this)||this;_this.context=context;_this.application=application;_this.decenteringTransform=new _2d_pipeline_1.NativeTranslateTransform;_this.scaleTransform=new _2d_pipeline_1.NativeScaleTransform;_this.translateTransform=new _2d_pipeline_1.NativeTranslateTransform;_this.viewCenter=new math_1.Vector2;_this.viewScale=new math_1.Value(1);_this.scaleMin=.001;_this.scaleMax=1e3;_this.viewCenterLimit=new math_1.Box2;_this.context=context;_this.application=application;_this.viewCenterLimit.makeUnlimited();_this.scaleTransform.scaling.set(1,1);_this.transformation.push(_this.translateTransform);_this.transformation.push(_this.scaleTransform);_this.transformation.push(_this.decenteringTransform);_this.viewCenter.subscribeToChanges(function(){_this.updateViewport()});_this.viewScale.subscribeToChanges(function(){_this.updateViewport()});return _this}Viewport.prototype.fitToContent=function(margin){var contentBox=this.getBox();if(margin){contentBox.expandByScalar(margin)}var scaling=this.context.size.clone().divide(contentBox.size);this.viewScale.setSilent(Math.min(scaling.x,scaling.y));var newCenter=contentBox.min.clone().add(contentBox.size.clone().multiplyScalar(.5));this.viewCenter.copySilent(newCenter);this.updateViewport()};Viewport.prototype.fitToContextSize=function(){var newCenter=this.context.size.clone().multiplyScalar(.5);this.viewCenter.copySilent(newCenter);this.viewScale.setSilent(1);this.updateViewport()};Viewport.prototype.updateViewport=function(){var limitedCenter=this.viewCenter.clone().clampInBox(this.viewCenterLimit);this.viewCenter.copySilent(limitedCenter);var limitedScale=this.viewScale.clone().clamp(this.scaleMin,this.scaleMax);this.viewScale.setSilent(limitedScale.x);var decentering=new math_1.Vector2(-this.viewCenter.x,-this.viewCenter.y);var scaling=new math_1.Vector2(this.viewScale.x,this.viewScale.x);var translation=this.context.size.clone().multiplyScalar(.5);this.decenteringTransform.translation.copy(decentering);this.scaleTransform.scaling.copy(scaling);this.translateTransform.translation.copy(translation)};return Viewport}(group_1.Group);exports.Viewport=Viewport},{"../basic-elements/group":79,"@daign/2d-pipeline":110,"@daign/math":135}],77:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ClipPath=void 0;var math_1=require("@daign/math");var styledGraphicNode_1=require("../styledGraphicNode");var ClipPath=function(_super){__extends(ClipPath,_super);function ClipPath(){var _this=_super.call(this)||this;_this.baseClass="clip-path";return _this}ClipPath.prototype.getBox=function(){var box=new math_1.Box2;this.children.forEach(function(child){if(child instanceof styledGraphicNode_1.StyledGraphicNode){box.expandByBox(child.getBoxTransformed())}});return box};return ClipPath}(styledGraphicNode_1.StyledGraphicNode);exports.ClipPath=ClipPath},{"../styledGraphicNode":107,"@daign/math":135}],78:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.FixedRadiusCircle=void 0;var styledGraphicNode_1=require("../styledGraphicNode");var FixedRadiusCircle=function(_super){__extends(FixedRadiusCircle,_super);function FixedRadiusCircle(){var _this=_super.call(this)||this;_this.radius=1;_this.baseClass="circle";_this.points.initializeElements(1);_this.points.assignName("center",0);return _this}Object.defineProperty(FixedRadiusCircle.prototype,"center",{get:function(){return this.points.getByName("center")},set:function(position){this.points.getByName("center").copy(position)},enumerable:false,configurable:true});FixedRadiusCircle.prototype.getCenterTransformed=function(transformation){var centerPoint=this.center.clone().transform(transformation);return centerPoint};return FixedRadiusCircle}(styledGraphicNode_1.StyledGraphicNode);exports.FixedRadiusCircle=FixedRadiusCircle},{"../styledGraphicNode":107}],79:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Group=void 0;var math_1=require("@daign/math");var styledGraphicNode_1=require("../styledGraphicNode");var Group=function(_super){__extends(Group,_super);function Group(){var _this=_super.call(this)||this;_this.baseClass="group";return _this}Group.prototype.getBox=function(){var box=new math_1.Box2;this.children.forEach(function(child){if(child instanceof styledGraphicNode_1.StyledGraphicNode){box.expandByBox(child.getBoxTransformed())}});return box};return Group}(styledGraphicNode_1.StyledGraphicNode);exports.Group=Group},{"../styledGraphicNode":107,"@daign/math":135}],80:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.UseElement=exports.TwoPointRectangle=exports.TwoPointPattern=exports.TwoPointImage=exports.TwoPointCircle=exports.Text=exports.SymbolElement=exports.SinglePointElement=exports.ScalableText=exports.QuadraticCurve=exports.Polyline=exports.Polygon=exports.Mask=exports.Line=exports.Group=exports.FixedRadiusCircle=exports.ClipPath=void 0;var clipPath_1=require("./clipPath");Object.defineProperty(exports,"ClipPath",{enumerable:true,get:function(){return clipPath_1.ClipPath}});var fixedRadiusCircle_1=require("./fixedRadiusCircle");Object.defineProperty(exports,"FixedRadiusCircle",{enumerable:true,get:function(){return fixedRadiusCircle_1.FixedRadiusCircle}});var group_1=require("./group");Object.defineProperty(exports,"Group",{enumerable:true,get:function(){return group_1.Group}});var line_1=require("./line");Object.defineProperty(exports,"Line",{enumerable:true,get:function(){return line_1.Line}});var mask_1=require("./mask");Object.defineProperty(exports,"Mask",{enumerable:true,get:function(){return mask_1.Mask}});var polygon_1=require("./polygon");Object.defineProperty(exports,"Polygon",{enumerable:true,get:function(){return polygon_1.Polygon}});var polyline_1=require("./polyline");Object.defineProperty(exports,"Polyline",{enumerable:true,get:function(){return polyline_1.Polyline}});var quadraticCurve_1=require("./quadraticCurve");Object.defineProperty(exports,"QuadraticCurve",{enumerable:true,get:function(){return quadraticCurve_1.QuadraticCurve}});var scalableText_1=require("./scalableText");Object.defineProperty(exports,"ScalableText",{enumerable:true,get:function(){return scalableText_1.ScalableText}});var singlePointElement_1=require("./singlePointElement");Object.defineProperty(exports,"SinglePointElement",{enumerable:true,get:function(){return singlePointElement_1.SinglePointElement}});var symbolElement_1=require("./symbolElement");Object.defineProperty(exports,"SymbolElement",{enumerable:true,get:function(){return symbolElement_1.SymbolElement}});var text_1=require("./text");Object.defineProperty(exports,"Text",{enumerable:true,get:function(){return text_1.Text}});var twoPointCircle_1=require("./twoPointCircle");Object.defineProperty(exports,"TwoPointCircle",{enumerable:true,get:function(){return twoPointCircle_1.TwoPointCircle}});var twoPointImage_1=require("./twoPointImage");Object.defineProperty(exports,"TwoPointImage",{enumerable:true,get:function(){return twoPointImage_1.TwoPointImage}});var twoPointPattern_1=require("./twoPointPattern");Object.defineProperty(exports,"TwoPointPattern",{enumerable:true,get:function(){return twoPointPattern_1.TwoPointPattern}});var twoPointRectangle_1=require("./twoPointRectangle");Object.defineProperty(exports,"TwoPointRectangle",{enumerable:true,get:function(){return twoPointRectangle_1.TwoPointRectangle}});var useElement_1=require("./useElement");Object.defineProperty(exports,"UseElement",{enumerable:true,get:function(){return useElement_1.UseElement}})},{"./clipPath":77,"./fixedRadiusCircle":78,"./group":79,"./line":81,"./mask":82,"./polygon":83,"./polyline":84,"./quadraticCurve":85,"./scalableText":86,"./singlePointElement":87,"./symbolElement":88,"./text":89,"./twoPointCircle":90,"./twoPointImage":91,"./twoPointPattern":92,"./twoPointRectangle":93,"./useElement":94}],81:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Line=void 0;var styledGraphicNode_1=require("../styledGraphicNode");var Line=function(_super){__extends(Line,_super);function Line(){var _this=_super.call(this)||this;_this.baseClass="line";_this.points.initializeElements(2);_this.points.assignName("start",0);_this.points.assignName("end",1);return _this}Object.defineProperty(Line.prototype,"start",{get:function(){return this.points.getByName("start")},set:function(position){this.points.getByName("start").copy(position)},enumerable:false,configurable:true});Object.defineProperty(Line.prototype,"end",{get:function(){return this.points.getByName("end")},set:function(position){this.points.getByName("end").copy(position)},enumerable:false,configurable:true});Line.prototype.getStartTransformed=function(transformation){var startPoint=this.start.clone().transform(transformation);return startPoint};Line.prototype.getEndTransformed=function(transformation){var endPoint=this.end.clone().transform(transformation);return endPoint};return Line}(styledGraphicNode_1.StyledGraphicNode);exports.Line=Line},{"../styledGraphicNode":107}],82:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Mask=void 0;var math_1=require("@daign/math");var styledGraphicNode_1=require("../styledGraphicNode");var Mask=function(_super){__extends(Mask,_super);function Mask(){var _this=_super.call(this)||this;_this.baseClass="mask";return _this}Mask.prototype.getBox=function(){var box=new math_1.Box2;this.children.forEach(function(child){if(child instanceof styledGraphicNode_1.StyledGraphicNode){box.expandByBox(child.getBoxTransformed())}});return box};return Mask}(styledGraphicNode_1.StyledGraphicNode);exports.Mask=Mask},{"../styledGraphicNode":107,"@daign/math":135}],83:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Polygon=void 0;var styledGraphicNode_1=require("../styledGraphicNode");var Polygon=function(_super){__extends(Polygon,_super);function Polygon(){var _this=_super.call(this)||this;_this.baseClass="polygon";return _this}return Polygon}(styledGraphicNode_1.StyledGraphicNode);exports.Polygon=Polygon},{"../styledGraphicNode":107}],84:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Polyline=void 0;var styledGraphicNode_1=require("../styledGraphicNode");var Polyline=function(_super){__extends(Polyline,_super);function Polyline(){var _this=_super.call(this)||this;_this.baseClass="polyline";return _this}return Polyline}(styledGraphicNode_1.StyledGraphicNode);exports.Polyline=Polyline},{"../styledGraphicNode":107}],85:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.QuadraticCurve=void 0;var styledGraphicNode_1=require("../styledGraphicNode");var QuadraticCurve=function(_super){__extends(QuadraticCurve,_super);function QuadraticCurve(){var _this=_super.call(this)||this;_this.baseClass="quadratic-curve";return _this}return QuadraticCurve}(styledGraphicNode_1.StyledGraphicNode);exports.QuadraticCurve=QuadraticCurve},{"../styledGraphicNode":107}],86:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ScalableText=void 0;var math_1=require("@daign/math");var styledGraphicNode_1=require("../styledGraphicNode");var ScalableText=function(_super){__extends(ScalableText,_super);function ScalableText(){var _this=_super.call(this)||this;_this.content="";_this.textAnchor="end";_this._fontSize=1;_this.baseClass="scalableText";_this.points.initializeElements(2);_this.points.assignName("anchor",0);_this.points.assignName("heightPoint",1);return _this}Object.defineProperty(ScalableText.prototype,"anchor",{get:function(){return this.points.getByName("anchor")},set:function(position){this.points.getByName("anchor").copy(position)},enumerable:false,configurable:true});Object.defineProperty(ScalableText.prototype,"heightPoint",{get:function(){return this.points.getByName("heightPoint")},enumerable:false,configurable:true});Object.defineProperty(ScalableText.prototype,"fontSize",{get:function(){return this._fontSize},set:function(size){this._fontSize=size;var position=this.anchor.clone().add(new math_1.Vector2(0,-size));this.points.getByName("heightPoint").copy(position)},enumerable:false,configurable:true});ScalableText.prototype.getFontSizeTransformed=function(transformation){var anchorPoint=this.anchor.clone().transform(transformation);var heightPoint=this.heightPoint.clone().transform(transformation);var fontSize=anchorPoint.distanceTo(heightPoint);return fontSize};ScalableText.prototype.getAnchorTransformed=function(transformation){var anchorPoint=this.anchor.clone().transform(transformation);return anchorPoint};ScalableText.prototype.getBox=function(){var box=new math_1.Box2;box.expandByPoint(this.anchor);box.expandByPoint(this.heightPoint);var estimatedWidth=this.content.length*this.fontSize*.5;if(this.textAnchor==="end"){box.expandByPoint(this.anchor.clone().add(new math_1.Vector2(-estimatedWidth,0)))}else if(this.textAnchor==="start"){box.expandByPoint(this.anchor.clone().add(new math_1.Vector2(estimatedWidth,0)))}else if(this.textAnchor==="middle"){box.expandByPoint(this.anchor.clone().add(new math_1.Vector2(.5*estimatedWidth,0)));box.expandByPoint(this.anchor.clone().add(new math_1.Vector2(-.5*estimatedWidth,0)))}return box};return ScalableText}(styledGraphicNode_1.StyledGraphicNode);exports.ScalableText=ScalableText},{"../styledGraphicNode":107,"@daign/math":135}],87:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.SinglePointElement=void 0;var styledGraphicNode_1=require("../styledGraphicNode");var SinglePointElement=function(_super){__extends(SinglePointElement,_super);function SinglePointElement(){var _this=_super.call(this)||this;_this.points.initializeElements(1);_this.points.assignName("anchor",0);return _this}Object.defineProperty(SinglePointElement.prototype,"anchor",{get:function(){return this.points.getByName("anchor")},set:function(position){this.points.getByName("anchor").copy(position)},enumerable:false,configurable:true});SinglePointElement.prototype.getAnchorTransformed=function(transformation){var anchorPoint=this.anchor.clone().transform(transformation);return anchorPoint};return SinglePointElement}(styledGraphicNode_1.StyledGraphicNode);exports.SinglePointElement=SinglePointElement},{"../styledGraphicNode":107}],88:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.SymbolElement=void 0;var math_1=require("@daign/math");var styledGraphicNode_1=require("../styledGraphicNode");var SymbolElement=function(_super){__extends(SymbolElement,_super);function SymbolElement(){var _this=_super.call(this)||this;_this.baseClass="symbol";return _this}SymbolElement.prototype.getBox=function(){var box=new math_1.Box2;this.children.forEach(function(child){if(child instanceof styledGraphicNode_1.StyledGraphicNode){box.expandByBox(child.getBoxTransformed())}});return box};return SymbolElement}(styledGraphicNode_1.StyledGraphicNode);exports.SymbolElement=SymbolElement},{"../styledGraphicNode":107,"@daign/math":135}],89:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Text=void 0;var singlePointElement_1=require("./singlePointElement");var Text=function(_super){__extends(Text,_super);function Text(){var _this=_super.call(this)||this;_this.content="";_this.textAnchor="end";_this.baseClass="text";return _this}return Text}(singlePointElement_1.SinglePointElement);exports.Text=Text},{"./singlePointElement":87}],90:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.TwoPointCircle=void 0;var math_1=require("@daign/math");var styledGraphicNode_1=require("../styledGraphicNode");var TwoPointCircle=function(_super){__extends(TwoPointCircle,_super);function TwoPointCircle(){var _this=_super.call(this)||this;_this.baseClass="circle";_this.points.initializeElements(2);_this.points.assignName("center",0);_this.points.assignName("circlePoint",1);return _this}Object.defineProperty(TwoPointCircle.prototype,"center",{get:function(){return this.points.getByName("center")},set:function(position){this.points.getByName("center").copy(position)},enumerable:false,configurable:true});Object.defineProperty(TwoPointCircle.prototype,"circlePoint",{get:function(){return this.points.getByName("circlePoint")},set:function(position){this.points.getByName("circlePoint").copy(position)},enumerable:false,configurable:true});TwoPointCircle.prototype.getRadiusTransformed=function(transformation){var centerPoint=this.center.clone().transform(transformation);var circlePoint=this.circlePoint.clone().transform(transformation);var radius=centerPoint.distanceTo(circlePoint);return radius};TwoPointCircle.prototype.getCenterTransformed=function(transformation){var centerPoint=this.center.clone().transform(transformation);return centerPoint};TwoPointCircle.prototype.getBox=function(){var box=new math_1.Box2;var radius=this.center.distanceTo(this.circlePoint);box.expandByPoint(this.center);box.expandByScalar(radius);return box};return TwoPointCircle}(styledGraphicNode_1.StyledGraphicNode);exports.TwoPointCircle=TwoPointCircle},{"../styledGraphicNode":107,"@daign/math":135}],91:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.TwoPointImage=void 0;var twoPointRectangle_1=require("./twoPointRectangle");var TwoPointImage=function(_super){__extends(TwoPointImage,_super);function TwoPointImage(){var _this=_super.call(this)||this;_this.href="";_this.baseClass="image";return _this}return TwoPointImage}(twoPointRectangle_1.TwoPointRectangle);exports.TwoPointImage=TwoPointImage},{"./twoPointRectangle":93}],92:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.TwoPointPattern=void 0;var math_1=require("@daign/math");var styledGraphicNode_1=require("../styledGraphicNode");var TwoPointPattern=function(_super){__extends(TwoPointPattern,_super);function TwoPointPattern(){var _this=_super.call(this)||this;_this.baseClass="pattern";_this.points.initializeElements(2);_this.points.assignName("start",0);_this.points.assignName("end",1);return _this}Object.defineProperty(TwoPointPattern.prototype,"start",{get:function(){return this.points.getByName("start")},set:function(position){this.points.getByName("start").copy(position)},enumerable:false,configurable:true});Object.defineProperty(TwoPointPattern.prototype,"end",{get:function(){return this.points.getByName("end")},set:function(position){this.points.getByName("end").copy(position)},enumerable:false,configurable:true});TwoPointPattern.prototype.getStartTransformed=function(transformation){var area=new math_1.Box2;var startPoint=this.start.clone().transform(transformation);area.expandByPoint(startPoint);var endPoint=this.end.clone().transform(transformation);area.expandByPoint(endPoint);return area.min};TwoPointPattern.prototype.getEndTransformed=function(transformation){var area=new math_1.Box2;var startPoint=this.start.clone().transform(transformation);area.expandByPoint(startPoint);var endPoint=this.end.clone().transform(transformation);area.expandByPoint(endPoint);return area.max};TwoPointPattern.prototype.getSizeTransformed=function(transformation){var area=new math_1.Box2;var startPoint=this.start.clone().transform(transformation);area.expandByPoint(startPoint);var endPoint=this.end.clone().transform(transformation);area.expandByPoint(endPoint);return area.size};return TwoPointPattern}(styledGraphicNode_1.StyledGraphicNode);exports.TwoPointPattern=TwoPointPattern},{"../styledGraphicNode":107,"@daign/math":135}],93:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.TwoPointRectangle=void 0;var math_1=require("@daign/math");var styledGraphicNode_1=require("../styledGraphicNode");var TwoPointRectangle=function(_super){__extends(TwoPointRectangle,_super);function TwoPointRectangle(){var _this=_super.call(this)||this;_this.baseClass="rectangle";_this.points.initializeElements(2);_this.points.assignName("start",0);_this.points.assignName("end",1);return _this}Object.defineProperty(TwoPointRectangle.prototype,"start",{get:function(){return this.points.getByName("start")},set:function(position){this.points.getByName("start").copy(position)},enumerable:false,configurable:true});Object.defineProperty(TwoPointRectangle.prototype,"end",{get:function(){return this.points.getByName("end")},set:function(position){this.points.getByName("end").copy(position)},enumerable:false,configurable:true});TwoPointRectangle.prototype.getStartTransformed=function(transformation){var area=new math_1.Box2;var startPoint=this.start.clone().transform(transformation);area.expandByPoint(startPoint);var endPoint=this.end.clone().transform(transformation);area.expandByPoint(endPoint);return area.min};TwoPointRectangle.prototype.getEndTransformed=function(transformation){var area=new math_1.Box2;var startPoint=this.start.clone().transform(transformation);area.expandByPoint(startPoint);var endPoint=this.end.clone().transform(transformation);area.expandByPoint(endPoint);return area.max};TwoPointRectangle.prototype.getSizeTransformed=function(transformation){var area=new math_1.Box2;var startPoint=this.start.clone().transform(transformation);area.expandByPoint(startPoint);var endPoint=this.end.clone().transform(transformation);area.expandByPoint(endPoint);return area.size};return TwoPointRectangle}(styledGraphicNode_1.StyledGraphicNode);exports.TwoPointRectangle=TwoPointRectangle},{"../styledGraphicNode":107,"@daign/math":135}],94:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.UseElement=void 0;var singlePointElement_1=require("./singlePointElement");var UseElement=function(_super){__extends(UseElement,_super);function UseElement(){var _this=_super.call(this)||this;_this.href="";_this.baseClass="use";return _this}return UseElement}(singlePointElement_1.SinglePointElement);exports.UseElement=UseElement},{"./singlePointElement":87}],95:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ButtonControl=void 0;var _2d_pipeline_1=require("@daign/2d-pipeline");var basic_elements_1=require("../basic-elements");var ButtonControl=function(_super){__extends(ButtonControl,_super);function ButtonControl(buttonObject,targetTransformation){var _this=_super.call(this)||this;_this.callback=buttonObject.callback;var center=buttonObject.anchor.clone().transform(targetTransformation);var offset=new _2d_pipeline_1.MatrixTransform;offset.matrix.setTranslation(center);_this.transformation.push(offset);_this.baseClass="buttonControl";if(buttonObject.buttonShape){_this.appendChild(buttonObject.buttonShape)}else{var defaultShape=new basic_elements_1.FixedRadiusCircle;defaultShape.radius=15;_this.appendChild(defaultShape)}return _this}ButtonControl.prototype.click=function(){this.callback()};return ButtonControl}(basic_elements_1.Group);exports.ButtonControl=ButtonControl},{"../basic-elements":80,"@daign/2d-pipeline":110}],96:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ButtonObject=void 0;var basic_elements_1=require("../basic-elements");var ButtonObject=function(_super){__extends(ButtonObject,_super);function ButtonObject(callback){var _this=_super.call(this)||this;_this.callback=callback;_this.baseClass="button";return _this}return ButtonObject}(basic_elements_1.SinglePointElement);exports.ButtonObject=ButtonObject},{"../basic-elements":80}],97:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ControlObject=void 0;var basic_elements_1=require("../basic-elements");var buttonControl_1=require("./buttonControl");var controlPoint_1=require("./controlPoint");var ControlObject=function(_super){__extends(ControlObject,_super);function ControlObject(){var _this=_super.call(this)||this;_this.controlModifier=null;_this.controlGuides=[];_this.controlPointShapes=[];_this.buttons=[];_this.redraw();_this.points.subscribeToChanges(function(){_this.redraw()});return _this}ControlObject.prototype.redraw=function(){this.clearChildren();this.buttons=[]};ControlObject.prototype.redrawControlObjects=function(activePoint,application){var _this=this;var group=new basic_elements_1.Group;var transformation=this.presentationNodes[0].projectNodeToView;this.controlGuides.forEach(function(controlGuide){var node=controlGuide.redraw(_this,activePoint);if(node){group.appendChild(node)}});this.points.iterate(function(point,index){var controlPoint=new controlPoint_1.ControlPoint(point,transformation,application,_this,index,_this.controlPointShapes[index]);group.appendChild(controlPoint);if(point===activePoint){controlPoint.addClass("active")}});this.buttons.forEach(function(button){var buttonControl=new buttonControl_1.ButtonControl(button,transformation);group.appendChild(buttonControl)});return group};ControlObject.prototype.getDeepCopyOfPoints=function(){return this.points.cloneDeep().elements};ControlObject.prototype.writeUpdatesToPoints=function(updatedPoints){this.points.iterate(function(element,index){element.copy(updatedPoints[index])})};return ControlObject}(basic_elements_1.Group);exports.ControlObject=ControlObject},{"../basic-elements":80,"./buttonControl":95,"./controlPoint":98}],98:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ControlPoint=void 0;var _2d_pipeline_1=require("@daign/2d-pipeline");var basic_elements_1=require("../basic-elements");var ControlPoint=function(_super){__extends(ControlPoint,_super);function ControlPoint(targetPoint,targetTransformation,application,controlObject,controlIndex,controlShape){var _this=_super.call(this)||this;_this.targetPoint=targetPoint;_this.targetTransformation=targetTransformation;_this.application=application;_this.controlObject=controlObject;_this.controlIndex=controlIndex;_this.offset=new _2d_pipeline_1.MatrixTransform;_this.baseClass="controlPoint";_this.points.initializeElements(1);_this.points.assignName("center",0);_this.center=_this.targetPoint.clone().transform(_this.targetTransformation);_this.transformation.push(_this.offset);if(controlShape){_this.appendChild(controlShape)}else if(controlShape===undefined){var defaultShape=new basic_elements_1.FixedRadiusCircle;defaultShape.radius=15;_this.appendChild(defaultShape)}return _this}Object.defineProperty(ControlPoint.prototype,"center",{get:function(){return this.points.getByName("center")},set:function(position){this.points.getByName("center").copy(position);this.calculateOffset()},enumerable:false,configurable:true});ControlPoint.prototype.calculateOffset=function(){this.offset.matrix.setTranslation(this.center)};ControlPoint.prototype.snap=function(){this.center.snap()};ControlPoint.prototype.drag=function(delta){this.center.drag(delta);var presentationNode=this.controlObject.presentationNodes[0];var calculatedPosition=this.center.clone().transform(presentationNode.projectViewToNode);var updatedPoints=this.controlObject.getDeepCopyOfPoints();updatedPoints[this.controlIndex].copy(calculatedPosition);if(this.controlObject.controlModifier){updatedPoints=this.controlObject.controlModifier.modifyPoints(updatedPoints,this.controlIndex,this.controlObject)}this.controlObject.writeUpdatesToPoints(updatedPoints);this.calculateOffset();this.application.redraw()};return ControlPoint}(basic_elements_1.Group);exports.ControlPoint=ControlPoint},{"../basic-elements":80,"@daign/2d-pipeline":110}],99:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SelectionFrame=void 0;var basic_elements_1=require("../basic-elements");var SelectionFrame=function(){function SelectionFrame(){}SelectionFrame.prototype.redraw=function(activeObject){var transformation=activeObject.presentationNodes[0].projectNodeToView;var box=activeObject.getBox();var start=box.min.clone().transform(transformation);var end=box.max.clone().transform(transformation);var frame=new basic_elements_1.TwoPointRectangle;frame.addClass("selection-frame");frame.start=start;frame.end=end;return frame};return SelectionFrame}();exports.SelectionFrame=SelectionFrame},{"../basic-elements":80}],100:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ControlModifierChain=void 0;var ControlModifierChain=function(){function ControlModifierChain(){this.enabled=true;this.modifiers=[];this.selectorFunction=function(){return true}}ControlModifierChain.prototype.modifyPoints=function(updatedPoints,pointIndex,controlObject){var doExecute=this.selectorFunction(updatedPoints,pointIndex,controlObject);if(!doExecute||!this.enabled){return updatedPoints}var modifiedPoints=updatedPoints;this.modifiers.forEach(function(modifier){modifiedPoints=modifier.modifyPoints(modifiedPoints,pointIndex,controlObject)});return modifiedPoints};ControlModifierChain.prototype.addModifier=function(modifier){this.modifiers.push(modifier)};return ControlModifierChain}();exports.ControlModifierChain=ControlModifierChain},{}],101:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FollowAlongModifier=void 0;var FollowAlongModifier=function(){function FollowAlongModifier(){this.enabled=true}FollowAlongModifier.prototype.modifyPoints=function(updatedPoints,pointIndex,controlObject){if(!this.enabled){return updatedPoints}var pointBefore=controlObject.points.getElement(pointIndex);var pointAfter=updatedPoints[pointIndex];if(pointBefore){var diff_1=pointAfter.clone().sub(pointBefore);var modifiedPoints=updatedPoints.map(function(point,index){if(index>pointIndex){point.add(diff_1)}return point});return modifiedPoints}return updatedPoints};return FollowAlongModifier}();exports.FollowAlongModifier=FollowAlongModifier},{}],102:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.OrthogonalModifier=void 0;var OrthogonalModifier=function(){function OrthogonalModifier(){this.enabled=true}OrthogonalModifier.prototype.modifyPoints=function(updatedPoints,pointIndex,_controlObject){if(!this.enabled){return updatedPoints}if(pointIndex===0){return updatedPoints}var targetPoint=updatedPoints[pointIndex];var previousPoint=updatedPoints[pointIndex-1];var diffHorizontal=Math.abs(targetPoint.x-previousPoint.x);var diffVertical=Math.abs(targetPoint.y-previousPoint.y);if(diffHorizontal>diffVertical){targetPoint.set(targetPoint.x,previousPoint.y)}else{targetPoint.set(previousPoint.x,targetPoint.y)}return updatedPoints};return OrthogonalModifier}();exports.OrthogonalModifier=OrthogonalModifier},{}],103:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RoundFollowingModifier=void 0;var RoundFollowingModifier=function(){function RoundFollowingModifier(precision){this.enabled=true;this.precision=undefined;if(precision){this.precision=precision}}RoundFollowingModifier.prototype.modifyPoints=function(updatedPoints,pointIndex,_controlObject){var _this=this;if(!this.enabled){return updatedPoints}var modifiedPoints=updatedPoints.map(function(point,index){if(index>pointIndex){point.round(_this.precision)}return point});return modifiedPoints};return RoundFollowingModifier}();exports.RoundFollowingModifier=RoundFollowingModifier},{}],104:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RoundingModifier=void 0;var RoundingModifier=function(){function RoundingModifier(precision){this.enabled=true;this.precision=undefined;if(precision){this.precision=precision}}RoundingModifier.prototype.modifyPoints=function(updatedPoints,pointIndex,_controlObject){if(!this.enabled){return updatedPoints}var targetPoint=updatedPoints[pointIndex];targetPoint.round(this.precision);return updatedPoints};return RoundingModifier}();exports.RoundingModifier=RoundingModifier},{}],105:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GraphicStyle=void 0;var GraphicStyle=function(){function GraphicStyle(fill,fillOpacity,fillRule,stroke,strokeWidth,strokeOpacity,strokeLinecap,strokeLinejoin,strokeMiterlimit,strokeDasharray,strokeDashoffset,vectorEffect,display,visibility,opacity,paintOrder,mask,fontFamily,fontSize,fontStyle,fontVariant,fontWeight,fontStretch,letterSpacing,wordSpacing,textDecoration,pointerEvents,cursor){this.fill=null;this.fillOpacity=null;this.fillRule=null;this.stroke=null;this.strokeWidth=null;this.strokeOpacity=null;this.strokeLinecap=null;this.strokeLinejoin=null;this.strokeMiterlimit=null;this.strokeDasharray=null;this.strokeDashoffset=null;this.vectorEffect=null;this.display=null;this.visibility=null;this.opacity=null;this.paintOrder=null;this.mask=null;this.fontFamily=null;this.fontSize=null;this.fontStyle=null;this.fontVariant=null;this.fontWeight=null;this.fontStretch=null;this.letterSpacing=null;this.wordSpacing=null;this.textDecoration=null;this.pointerEvents=null;this.cursor=null;if(fill){this.fill=fill}if(fillOpacity){this.fillOpacity=fillOpacity}if(fillRule){this.fillRule=fillRule}if(stroke){this.stroke=stroke}if(strokeWidth){this.strokeWidth=strokeWidth}if(strokeOpacity){this.strokeOpacity=strokeOpacity}if(strokeLinecap){this.strokeLinecap=strokeLinecap}if(strokeLinejoin){this.strokeLinejoin=strokeLinejoin}if(strokeMiterlimit){this.strokeMiterlimit=strokeMiterlimit}if(strokeDasharray){this.strokeDasharray=strokeDasharray}if(strokeDashoffset){this.strokeDashoffset=strokeDashoffset}if(vectorEffect){this.vectorEffect=vectorEffect}if(display){this.display=display}if(visibility){this.visibility=visibility}if(opacity){this.opacity=opacity}if(paintOrder){this.paintOrder=paintOrder}if(mask){this.mask=mask}if(fontFamily){this.fontFamily=fontFamily}if(fontSize){this.fontSize=fontSize}if(fontStyle){this.fontStyle=fontStyle}if(fontVariant){this.fontVariant=fontVariant}if(fontWeight){this.fontWeight=fontWeight}if(fontStretch){this.fontStretch=fontStretch}if(letterSpacing){this.letterSpacing=letterSpacing}if(wordSpacing){this.wordSpacing=wordSpacing}if(textDecoration){this.textDecoration=textDecoration}if(pointerEvents){this.pointerEvents=pointerEvents}if(cursor){this.cursor=cursor}}Object.defineProperty(GraphicStyle.prototype,"isEmpty",{get:function(){return this.fill===null&&this.fillOpacity===null&&this.fillRule===null&&this.stroke===null&&this.strokeWidth===null&&this.strokeOpacity===null&&this.strokeLinecap===null&&this.strokeLinejoin===null&&this.strokeMiterlimit===null&&this.strokeDasharray===null&&this.strokeDashoffset===null&&this.vectorEffect===null&&this.display===null&&this.visibility===null&&this.opacity===null&&this.paintOrder===null&&this.mask===null&&this.fontFamily===null&&this.fontSize===null&&this.fontStyle===null&&this.fontVariant===null&&this.fontWeight===null&&this.fontStretch===null&&this.letterSpacing===null&&this.wordSpacing===null&&this.textDecoration===null&&this.pointerEvents===null&&this.cursor===null},enumerable:false,configurable:true});GraphicStyle.prototype.parseAttribute=function(name,value){if(name==="fill"){this.fill=value}else if(name==="fill-opacity"){this.fillOpacity=parseFloat(value)}else if(name==="fill-rule"){this.fillRule=value}else if(name==="stroke"){this.stroke=value}else if(name==="stroke-width"){this.strokeWidth=parseFloat(value)}else if(name==="stroke-opacity"){this.strokeOpacity=parseFloat(value)}else if(name==="stroke-linecap"){this.strokeLinecap=value}else if(name==="stroke-linejoin"){this.strokeLinejoin=value}else if(name==="stroke-miterlimit"){this.strokeMiterlimit=parseFloat(value)}else if(name==="stroke-dasharray"){this.strokeDasharray=value}else if(name==="stroke-dashoffset"){this.strokeDashoffset=parseFloat(value)}else if(name==="vector-effect"){this.vectorEffect=value}else if(name==="display"){this.display=value}else if(name==="visibility"){this.visibility=value}else if(name==="opacity"){this.opacity=parseFloat(value)}else if(name==="paint-order"){this.paintOrder=value}else if(name==="mask"){this.mask=value}else if(name==="font-family"){this.fontFamily=value}else if(name==="font-size"){this.fontSize=value}else if(name==="font-style"){this.fontStyle=value}else if(name==="font-variant"){this.fontVariant=value}else if(name==="font-weight"){this.fontWeight=value}else if(name==="font-stretch"){this.fontStretch=value}else if(name==="letter-spacing"){this.letterSpacing=value}else if(name==="word-spacing"){this.wordSpacing=value}else if(name==="text-decoration"){this.textDecoration=value}else if(name==="pointer-events"){this.pointerEvents=value}else if(name==="cursor"){this.cursor=value}};GraphicStyle.prototype.complementWith=function(declaration){if(this.fill===null){this.fill=declaration.fill}if(this.fillOpacity===null){this.fillOpacity=declaration.fillOpacity}if(this.fillRule===null){this.fillRule=declaration.fillRule}if(this.stroke===null){this.stroke=declaration.stroke}if(this.strokeWidth===null){this.strokeWidth=declaration.strokeWidth}if(this.strokeOpacity===null){this.strokeOpacity=declaration.strokeOpacity}if(this.strokeLinecap===null){this.strokeLinecap=declaration.strokeLinecap}if(this.strokeLinejoin===null){this.strokeLinejoin=declaration.strokeLinejoin}if(this.strokeMiterlimit===null){this.strokeMiterlimit=declaration.strokeMiterlimit}if(this.strokeDasharray===null){this.strokeDasharray=declaration.strokeDasharray}if(this.strokeDashoffset===null){this.strokeDashoffset=declaration.strokeDashoffset}if(this.vectorEffect===null){this.vectorEffect=declaration.vectorEffect}if(this.display===null){this.display=declaration.display}if(this.visibility===null){this.visibility=declaration.visibility}if(this.opacity===null){this.opacity=declaration.opacity}if(this.paintOrder===null){this.paintOrder=declaration.paintOrder}if(this.mask===null){this.mask=declaration.mask}if(this.fontFamily===null){this.fontFamily=declaration.fontFamily}if(this.fontSize===null){this.fontSize=declaration.fontSize}if(this.fontStyle===null){this.fontStyle=declaration.fontStyle}if(this.fontVariant===null){this.fontVariant=declaration.fontVariant}if(this.fontWeight===null){this.fontWeight=declaration.fontWeight}if(this.fontStretch===null){this.fontStretch=declaration.fontStretch}if(this.letterSpacing===null){this.letterSpacing=declaration.letterSpacing}if(this.wordSpacing===null){this.wordSpacing=declaration.wordSpacing}if(this.textDecoration===null){this.textDecoration=declaration.textDecoration}if(this.pointerEvents===null){this.pointerEvents=declaration.pointerEvents}if(this.cursor===null){this.cursor=declaration.cursor}};GraphicStyle.prototype.printStyle=function(){var attributes=[];if(this.fill){attributes.push("fill: ".concat(this.fill))}if(this.fillOpacity){attributes.push("fill-opacity: ".concat(this.fillOpacity))}if(this.fillRule){attributes.push("fill-rule: ".concat(this.fillRule))}if(this.stroke){attributes.push("stroke: ".concat(this.stroke))}if(this.strokeWidth){attributes.push("stroke-width: ".concat(this.strokeWidth))}if(this.strokeOpacity){attributes.push("stroke-opacity: ".concat(this.strokeOpacity))}if(this.strokeLinecap){attributes.push("stroke-linecap: ".concat(this.strokeLinecap))}if(this.strokeLinejoin){attributes.push("stroke-linejoin: ".concat(this.strokeLinejoin))}if(this.strokeMiterlimit){attributes.push("stroke-miterlimit: ".concat(this.strokeMiterlimit))}if(this.strokeDasharray){attributes.push("stroke-dasharray: ".concat(this.strokeDasharray))}if(this.strokeDashoffset){attributes.push("stroke-dashoffset: ".concat(this.strokeDashoffset))}if(this.vectorEffect){attributes.push("vector-effect: ".concat(this.vectorEffect))}if(this.display){attributes.push("display: ".concat(this.display))}if(this.visibility){attributes.push("visibility: ".concat(this.visibility))}if(this.opacity){attributes.push("opacity: ".concat(this.opacity))}if(this.paintOrder){attributes.push("paint-order: ".concat(this.paintOrder))}if(this.mask){attributes.push("mask: ".concat(this.mask))}if(this.fontFamily){attributes.push("font-family: ".concat(this.fontFamily))}if(this.fontSize){attributes.push("font-size: ".concat(this.fontSize))}if(this.fontStyle){attributes.push("font-style: ".concat(this.fontStyle))}if(this.fontVariant){attributes.push("font-variant: ".concat(this.fontVariant))}if(this.fontWeight){attributes.push("font-weight: ".concat(this.fontWeight))}if(this.fontStretch){attributes.push("font-stretch: ".concat(this.fontStretch))}if(this.letterSpacing){attributes.push("letter-spacing: ".concat(this.letterSpacing))}if(this.wordSpacing){attributes.push("word-spacing: ".concat(this.wordSpacing))}if(this.textDecoration){attributes.push("text-decoration: ".concat(this.textDecoration))}if(this.pointerEvents){attributes.push("pointer-events: ".concat(this.pointerEvents))}if(this.cursor){attributes.push("cursor: ".concat(this.cursor))}return attributes.join("; ")};return GraphicStyle}();exports.GraphicStyle=GraphicStyle},{}],106:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RoundingModifier=exports.RoundFollowingModifier=exports.OrthogonalModifier=exports.FollowAlongModifier=exports.ControlModifierChain=exports.SelectionFrame=exports.ControlPoint=exports.ControlObject=exports.ButtonObject=exports.ButtonControl=exports.UseElement=exports.TwoPointRectangle=exports.TwoPointPattern=exports.TwoPointImage=exports.TwoPointCircle=exports.Text=exports.SymbolElement=exports.SinglePointElement=exports.ScalableText=exports.QuadraticCurve=exports.Polyline=exports.Polygon=exports.Mask=exports.Line=exports.Group=exports.FixedRadiusCircle=exports.ClipPath=exports.Viewport=exports.UpdateManager=exports.SelectionManager=exports.InteractiveViewport=exports.ControlLayer=exports.ApplicationView=exports.Application=exports.StyledGraphicNode=exports.GraphicStyle=void 0;var graphicStyle_1=require("./graphicStyle");Object.defineProperty(exports,"GraphicStyle",{enumerable:true,get:function(){return graphicStyle_1.GraphicStyle}});var styledGraphicNode_1=require("./styledGraphicNode");Object.defineProperty(exports,"StyledGraphicNode",{enumerable:true,get:function(){return styledGraphicNode_1.StyledGraphicNode}});var application_1=require("./application/application");Object.defineProperty(exports,"Application",{enumerable:true,get:function(){return application_1.Application}});var applicationView_1=require("./application/applicationView");Object.defineProperty(exports,"ApplicationView",{enumerable:true,get:function(){return applicationView_1.ApplicationView}});var controlLayer_1=require("./application/controlLayer");Object.defineProperty(exports,"ControlLayer",{enumerable:true,get:function(){return controlLayer_1.ControlLayer}});var interactiveViewport_1=require("./application/interactiveViewport");Object.defineProperty(exports,"InteractiveViewport",{enumerable:true,get:function(){return interactiveViewport_1.InteractiveViewport}});var selectionManager_1=require("./application/selectionManager");Object.defineProperty(exports,"SelectionManager",{enumerable:true,get:function(){return selectionManager_1.SelectionManager}});var updateManager_1=require("./application/updateManager");Object.defineProperty(exports,"UpdateManager",{enumerable:true,get:function(){return updateManager_1.UpdateManager}});var viewport_1=require("./application/viewport");Object.defineProperty(exports,"Viewport",{enumerable:true,get:function(){return viewport_1.Viewport}});var clipPath_1=require("./basic-elements/clipPath");Object.defineProperty(exports,"ClipPath",{enumerable:true,get:function(){return clipPath_1.ClipPath}});var fixedRadiusCircle_1=require("./basic-elements/fixedRadiusCircle");Object.defineProperty(exports,"FixedRadiusCircle",{enumerable:true,get:function(){return fixedRadiusCircle_1.FixedRadiusCircle}});var group_1=require("./basic-elements/group");Object.defineProperty(exports,"Group",{enumerable:true,get:function(){return group_1.Group}});var line_1=require("./basic-elements/line");Object.defineProperty(exports,"Line",{enumerable:true,get:function(){return line_1.Line}});var mask_1=require("./basic-elements/mask");Object.defineProperty(exports,"Mask",{enumerable:true,get:function(){return mask_1.Mask}});var polygon_1=require("./basic-elements/polygon");Object.defineProperty(exports,"Polygon",{enumerable:true,get:function(){return polygon_1.Polygon}});var polyline_1=require("./basic-elements/polyline");Object.defineProperty(exports,"Polyline",{enumerable:true,get:function(){return polyline_1.Polyline}});var quadraticCurve_1=require("./basic-elements/quadraticCurve");Object.defineProperty(exports,"QuadraticCurve",{enumerable:true,get:function(){return quadraticCurve_1.QuadraticCurve}});var scalableText_1=require("./basic-elements/scalableText");Object.defineProperty(exports,"ScalableText",{enumerable:true,get:function(){return scalableText_1.ScalableText}});var singlePointElement_1=require("./basic-elements/singlePointElement");Object.defineProperty(exports,"SinglePointElement",{enumerable:true,get:function(){return singlePointElement_1.SinglePointElement}});var symbolElement_1=require("./basic-elements/symbolElement");Object.defineProperty(exports,"SymbolElement",{enumerable:true,get:function(){return symbolElement_1.SymbolElement}});var text_1=require("./basic-elements/text");Object.defineProperty(exports,"Text",{enumerable:true,get:function(){return text_1.Text}});var twoPointCircle_1=require("./basic-elements/twoPointCircle");Object.defineProperty(exports,"TwoPointCircle",{enumerable:true,get:function(){return twoPointCircle_1.TwoPointCircle}});var twoPointImage_1=require("./basic-elements/twoPointImage");Object.defineProperty(exports,"TwoPointImage",{enumerable:true,get:function(){return twoPointImage_1.TwoPointImage}});var twoPointPattern_1=require("./basic-elements/twoPointPattern");Object.defineProperty(exports,"TwoPointPattern",{enumerable:true,get:function(){return twoPointPattern_1.TwoPointPattern}});var twoPointRectangle_1=require("./basic-elements/twoPointRectangle");Object.defineProperty(exports,"TwoPointRectangle",{enumerable:true,get:function(){return twoPointRectangle_1.TwoPointRectangle}});var useElement_1=require("./basic-elements/useElement");Object.defineProperty(exports,"UseElement",{enumerable:true,get:function(){return useElement_1.UseElement}});var buttonControl_1=require("./control-elements/buttonControl");Object.defineProperty(exports,"ButtonControl",{enumerable:true,get:function(){return buttonControl_1.ButtonControl}});var buttonObject_1=require("./control-elements/buttonObject");Object.defineProperty(exports,"ButtonObject",{enumerable:true,get:function(){return buttonObject_1.ButtonObject}});var controlObject_1=require("./control-elements/controlObject");Object.defineProperty(exports,"ControlObject",{enumerable:true,get:function(){return controlObject_1.ControlObject}});var controlPoint_1=require("./control-elements/controlPoint");Object.defineProperty(exports,"ControlPoint",{enumerable:true,get:function(){return controlPoint_1.ControlPoint}});var selectionFrame_1=require("./control-elements/selectionFrame");Object.defineProperty(exports,"SelectionFrame",{enumerable:true,get:function(){return selectionFrame_1.SelectionFrame}});var controlModifierChain_1=require("./control-modifiers/controlModifierChain");Object.defineProperty(exports,"ControlModifierChain",{enumerable:true,get:function(){return controlModifierChain_1.ControlModifierChain}});var followAlongModifier_1=require("./control-modifiers/followAlongModifier");Object.defineProperty(exports,"FollowAlongModifier",{enumerable:true,get:function(){return followAlongModifier_1.FollowAlongModifier}});var orthogonalModifier_1=require("./control-modifiers/orthogonalModifier");Object.defineProperty(exports,"OrthogonalModifier",{enumerable:true,get:function(){return orthogonalModifier_1.OrthogonalModifier}});var roundFollowingModifier_1=require("./control-modifiers/roundFollowingModifier");Object.defineProperty(exports,"RoundFollowingModifier",{enumerable:true,get:function(){return roundFollowingModifier_1.RoundFollowingModifier}});var roundingModifier_1=require("./control-modifiers/roundingModifier");Object.defineProperty(exports,"RoundingModifier",{enumerable:true,get:function(){return roundingModifier_1.RoundingModifier}})},{"./application/application":70,"./application/applicationView":71,"./application/controlLayer":72,"./application/interactiveViewport":73,"./application/selectionManager":74,"./application/updateManager":75,"./application/viewport":76,"./basic-elements/clipPath":77,"./basic-elements/fixedRadiusCircle":78,"./basic-elements/group":79,"./basic-elements/line":81,"./basic-elements/mask":82,"./basic-elements/polygon":83,"./basic-elements/polyline":84,"./basic-elements/quadraticCurve":85,"./basic-elements/scalableText":86,"./basic-elements/singlePointElement":87,"./basic-elements/symbolElement":88,"./basic-elements/text":89,"./basic-elements/twoPointCircle":90,"./basic-elements/twoPointImage":91,"./basic-elements/twoPointPattern":92,"./basic-elements/twoPointRectangle":93,"./basic-elements/useElement":94,"./control-elements/buttonControl":95,"./control-elements/buttonObject":96,"./control-elements/controlObject":97,"./control-elements/controlPoint":98,"./control-elements/selectionFrame":99,"./control-modifiers/controlModifierChain":100,"./control-modifiers/followAlongModifier":101,"./control-modifiers/orthogonalModifier":102,"./control-modifiers/roundFollowingModifier":103,"./control-modifiers/roundingModifier":104,"./graphicStyle":105,"./styledGraphicNode":107}],107:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.StyledGraphicNode=void 0;var math_1=require("@daign/math");var _2d_pipeline_1=require("@daign/2d-pipeline");var style_sheets_1=require("@daign/style-sheets");var StyledGraphicNode=function(_super){__extends(StyledGraphicNode,_super);function StyledGraphicNode(){var _this=_super.call(this)||this;_this.points=new math_1.Vector2Array;_this.classNames=new math_1.StringArray;_this.styleSelector=new style_sheets_1.StyleSelector;_this.elementStyle=null;_this.onclick=null;_this.id=null;_this.mask=null;_this.clipPath=null;_this.classNames.subscribeToChanges(function(){_this.buildStyleSelector()});return _this}Object.defineProperty(StyledGraphicNode.prototype,"baseClass",{set:function(baseClass){if(this.classNames.containsName("baseClass")){this.classNames.getByName("baseClass").value=baseClass}else{this.classNames.push(new math_1.StringValue(baseClass),"baseClass")}},enumerable:false,configurable:true});StyledGraphicNode.prototype.getPointsTransformed=function(transformation){return this.points.cloneDeep().transform(transformation).elements};StyledGraphicNode.prototype.getBoxTransformed=function(){return this.getBox().transform(this.transformation.transformMatrix)};StyledGraphicNode.prototype.getBox=function(){return this.points.getBox()};StyledGraphicNode.prototype.addClass=function(className){this.classNames.push(new math_1.StringValue(className))};StyledGraphicNode.prototype.setVariableClass=function(identifier,className){if(identifier==="baseClass"){throw new Error("baseClass is a protected identifier.")}if(this.classNames.containsName(identifier)){this.classNames.getByName(identifier).value=className}else{this.classNames.push(new math_1.StringValue(className),identifier)}};StyledGraphicNode.prototype.buildStyleSelector=function(){var selectorString=this.classNames.elements.map(function(s){return".".concat(s.value)}).join("");this.styleSelector=new style_sheets_1.StyleSelector(selectorString)};return StyledGraphicNode}(_2d_pipeline_1.GraphicNode);exports.StyledGraphicNode=StyledGraphicNode},{"@daign/2d-pipeline":110,"@daign/math":135,"@daign/style-sheets":156}],108:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.GenericNode=void 0;var observable_1=require("@daign/observable");var GenericNode=function(_super){__extends(GenericNode,_super);function GenericNode(){var _this=_super.call(this)||this;_this.parent=null;_this.children=[];_this.mappingName=null;_this.namedMapping={};return _this}GenericNode.prototype.appendChild=function(childNode,name){if(name&&this.namedMapping[name]){throw new Error("Name is not unique.")}if(childNode.parent){childNode.removeFromParent()}this.children.push(childNode);childNode.parent=this;if(name){childNode.mappingName=name;this.namedMapping[name]=childNode}this.propagateNotifyObservers()};GenericNode.prototype.removeChild=function(childNode){var index=this.children.indexOf(childNode);if(index===-1){return}this.children.splice(index,1);childNode.parent=null;if(childNode.mappingName){delete this.namedMapping[childNode.mappingName];childNode.mappingName=null}this.propagateNotifyObservers()};GenericNode.prototype.clearChildren=function(){this.children.forEach(function(child){child.parent=null;child.mappingName=null});this.children=[];this.namedMapping={};this.propagateNotifyObservers()};GenericNode.prototype.removeFromParent=function(){if(this.parent!==null){this.parent.removeChild(this)}};GenericNode.prototype.getChildByName=function(name){if(!this.namedMapping[name]){throw new Error("No child exists for the given name.")}return this.namedMapping[name]};GenericNode.prototype.destroyNode=function(){this.clearChildren();this.removeFromParent();this.clearObservers()};GenericNode.prototype.destroyRecursive=function(){var childReferencesCopy=this.children.slice();this.destroyNode();childReferencesCopy.forEach(function(child){child.destroyRecursive()})};GenericNode.prototype.propagateNotifyObservers=function(){this.notifyObservers();if(this.parent!==null){this.parent.propagateNotifyObservers()}};return GenericNode}(observable_1.Observable);exports.GenericNode=GenericNode},{"@daign/observable":150}],109:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.GraphicNode=void 0;var genericNode_1=require("./genericNode");var transformations_1=require("./transformations");var GraphicNode=function(_super){__extends(GraphicNode,_super);function GraphicNode(){var _this=_super.call(this)||this;_this.transformation=new transformations_1.TransformCollection;_this.presentationNodes=[];return _this}GraphicNode.prototype.registerPresentationNode=function(presentationNode){this.presentationNodes.push(presentationNode)};GraphicNode.prototype.removePresentationNode=function(presentationNode){var i=this.presentationNodes.indexOf(presentationNode);if(i>-1){this.presentationNodes.splice(i,1)}};return GraphicNode}(genericNode_1.GenericNode);exports.GraphicNode=GraphicNode},{"./genericNode":108,"./transformations":112}],110:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TransformCollection=exports.Transform=exports.NativeTranslateTransform=exports.NativeScaleTransform=exports.NativeRotateTransform=exports.MatrixTransform=exports.View=exports.PresentationNode=exports.GraphicNode=exports.GenericNode=void 0;var genericNode_1=require("./genericNode");Object.defineProperty(exports,"GenericNode",{enumerable:true,get:function(){return genericNode_1.GenericNode}});var graphicNode_1=require("./graphicNode");Object.defineProperty(exports,"GraphicNode",{enumerable:true,get:function(){return graphicNode_1.GraphicNode}});var presentationNode_1=require("./presentationNode");Object.defineProperty(exports,"PresentationNode",{enumerable:true,get:function(){return presentationNode_1.PresentationNode}});var view_1=require("./view");Object.defineProperty(exports,"View",{enumerable:true,get:function(){return view_1.View}});var matrixTransform_1=require("./transformations/matrixTransform");Object.defineProperty(exports,"MatrixTransform",{enumerable:true,get:function(){return matrixTransform_1.MatrixTransform}});var nativeRotateTransform_1=require("./transformations/nativeRotateTransform");Object.defineProperty(exports,"NativeRotateTransform",{enumerable:true,get:function(){return nativeRotateTransform_1.NativeRotateTransform}});var nativeScaleTransform_1=require("./transformations/nativeScaleTransform");Object.defineProperty(exports,"NativeScaleTransform",{enumerable:true,get:function(){return nativeScaleTransform_1.NativeScaleTransform}});var nativeTranslateTransform_1=require("./transformations/nativeTranslateTransform");Object.defineProperty(exports,"NativeTranslateTransform",{enumerable:true,get:function(){return nativeTranslateTransform_1.NativeTranslateTransform}});var transform_1=require("./transformations/transform");Object.defineProperty(exports,"Transform",{enumerable:true,get:function(){return transform_1.Transform}});var transformCollection_1=require("./transformations/transformCollection");Object.defineProperty(exports,"TransformCollection",{enumerable:true,get:function(){return transformCollection_1.TransformCollection}})},{"./genericNode":108,"./graphicNode":109,"./presentationNode":111,"./transformations/matrixTransform":113,"./transformations/nativeRotateTransform":114,"./transformations/nativeScaleTransform":115,"./transformations/nativeTranslateTransform":116,"./transformations/transform":117,"./transformations/transformCollection":118,"./view":119}],111:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.PresentationNode=void 0;var math_1=require("@daign/math");var genericNode_1=require("./genericNode");var PresentationNode=function(_super){__extends(PresentationNode,_super);function PresentationNode(view,sourceNode){var _this=_super.call(this)||this;_this.view=view;_this.sourceNode=sourceNode;_this.projectViewToNode=(new math_1.Matrix3).setIdentity();_this.projectNodeToView=(new math_1.Matrix3).setIdentity();_this.projectNodeToViewNonNative=(new math_1.Matrix3).setIdentity();_this.sourceNode.registerPresentationNode(_this);var callback=function(){_this.updateProjectionMatrices()};_this.removeSourceNodeSubscription=_this.sourceNode.transformation.subscribeToChanges(callback);return _this}PresentationNode.prototype.updateProjectionMatrices=function(){if(this.parent!==null){this.projectNodeToView.copy(this.sourceNode.transformation.transformMatrix);this.projectNodeToView.transform(this.parent.projectNodeToView);this.projectNodeToViewNonNative.copy(this.sourceNode.transformation.transformMatrixNonNative);this.projectNodeToViewNonNative.transform(this.parent.projectNodeToViewNonNative)}else{this.projectNodeToView.copy(this.sourceNode.transformation.transformMatrix);this.projectNodeToViewNonNative.copy(this.sourceNode.transformation.transformMatrixNonNative)}this.projectViewToNode.setToInverse(this.projectNodeToView);this.children.forEach(function(child){child.updateProjectionMatrices()})};PresentationNode.prototype.destroyNode=function(){_super.prototype.destroyNode.call(this);this.removeSourceNodeSubscription();this.sourceNode.removePresentationNode(this)};return PresentationNode}(genericNode_1.GenericNode);exports.PresentationNode=PresentationNode},{"./genericNode":108,"@daign/math":135}],112:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TransformCollection=exports.Transform=exports.NativeTranslateTransform=exports.NativeScaleTransform=exports.NativeRotateTransform=exports.MatrixTransform=void 0;var matrixTransform_1=require("./matrixTransform");Object.defineProperty(exports,"MatrixTransform",{enumerable:true,get:function(){return matrixTransform_1.MatrixTransform}});var nativeRotateTransform_1=require("./nativeRotateTransform");Object.defineProperty(exports,"NativeRotateTransform",{enumerable:true,get:function(){return nativeRotateTransform_1.NativeRotateTransform}});var nativeScaleTransform_1=require("./nativeScaleTransform");Object.defineProperty(exports,"NativeScaleTransform",{enumerable:true,get:function(){return nativeScaleTransform_1.NativeScaleTransform}});var nativeTranslateTransform_1=require("./nativeTranslateTransform");Object.defineProperty(exports,"NativeTranslateTransform",{enumerable:true,get:function(){return nativeTranslateTransform_1.NativeTranslateTransform}});var transform_1=require("./transform");Object.defineProperty(exports,"Transform",{enumerable:true,get:function(){return transform_1.Transform}});var transformCollection_1=require("./transformCollection");Object.defineProperty(exports,"TransformCollection",{enumerable:true,get:function(){return transformCollection_1.TransformCollection}})},{"./matrixTransform":113,"./nativeRotateTransform":114,"./nativeScaleTransform":115,"./nativeTranslateTransform":116,"./transform":117,"./transformCollection":118}],113:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.MatrixTransform=void 0;var math_1=require("@daign/math");var transform_1=require("./transform");var MatrixTransform=function(_super){__extends(MatrixTransform,_super);function MatrixTransform(){var _this=_super.call(this)||this;_this._matrix=(new math_1.Matrix3).setIdentity();var callback=function(){_this.notifyObservers()};_this._matrix.subscribeToChanges(callback);return _this}Object.defineProperty(MatrixTransform.prototype,"matrix",{get:function(){return this._matrix},enumerable:false,configurable:true});Object.defineProperty(MatrixTransform.prototype,"matrixNonNative",{get:function(){return this._matrix},enumerable:false,configurable:true});Object.defineProperty(MatrixTransform.prototype,"nativeSvgTransform",{get:function(){return null},enumerable:false,configurable:true});return MatrixTransform}(transform_1.Transform);exports.MatrixTransform=MatrixTransform},{"./transform":117,"@daign/math":135}],114:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.NativeRotateTransform=void 0;var math_1=require("@daign/math");var transform_1=require("./transform");var NativeRotateTransform=function(_super){__extends(NativeRotateTransform,_super);function NativeRotateTransform(){var _this=_super.call(this)||this;_this._angle=new math_1.Angle;_this._center=new math_1.Vector2;var callback=function(){_this.notifyObservers()};_this._angle.subscribeToChanges(callback);_this._center.subscribeToChanges(callback);return _this}Object.defineProperty(NativeRotateTransform.prototype,"angle",{get:function(){return this._angle},enumerable:false,configurable:true});Object.defineProperty(NativeRotateTransform.prototype,"center",{get:function(){return this._center},enumerable:false,configurable:true});Object.defineProperty(NativeRotateTransform.prototype,"matrix",{get:function(){var matrix=(new math_1.Matrix3).setRotation(this._angle,this._center);return matrix},enumerable:false,configurable:true});Object.defineProperty(NativeRotateTransform.prototype,"matrixNonNative",{get:function(){var matrix=(new math_1.Matrix3).setIdentity();return matrix},enumerable:false,configurable:true});Object.defineProperty(NativeRotateTransform.prototype,"nativeSvgTransform",{get:function(){var command=null;var normalizedDegrees=this._angle.clone().normalize().degrees;if(normalizedDegrees!==0){if(this._center.length()!==0){command="rotate(".concat(this._angle.degrees,", ").concat(this._center.x,", ").concat(this._center.y,")")}else{command="rotate(".concat(this._angle.degrees,")")}}return command},enumerable:false,configurable:true});return NativeRotateTransform}(transform_1.Transform);exports.NativeRotateTransform=NativeRotateTransform},{"./transform":117,"@daign/math":135}],115:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.NativeScaleTransform=void 0;var math_1=require("@daign/math");var transform_1=require("./transform");var NativeScaleTransform=function(_super){__extends(NativeScaleTransform,_super);function NativeScaleTransform(){var _this=_super.call(this)||this;_this._scaling=new math_1.Vector2;var callback=function(){_this.notifyObservers()};_this._scaling.subscribeToChanges(callback);return _this}Object.defineProperty(NativeScaleTransform.prototype,"scaling",{get:function(){return this._scaling},enumerable:false,configurable:true});Object.defineProperty(NativeScaleTransform.prototype,"matrix",{get:function(){var matrix=(new math_1.Matrix3).setScaling(this._scaling);return matrix},enumerable:false,configurable:true});Object.defineProperty(NativeScaleTransform.prototype,"matrixNonNative",{get:function(){var matrix=(new math_1.Matrix3).setIdentity();return matrix},enumerable:false,configurable:true});Object.defineProperty(NativeScaleTransform.prototype,"nativeSvgTransform",{get:function(){var command=null;if(this._scaling.x!==1||this._scaling.y!==1){command="scale(".concat(this._scaling.x,", ").concat(this._scaling.y,")")}return command},enumerable:false,configurable:true});return NativeScaleTransform}(transform_1.Transform);exports.NativeScaleTransform=NativeScaleTransform},{"./transform":117,"@daign/math":135}],116:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.NativeTranslateTransform=void 0;var math_1=require("@daign/math");var transform_1=require("./transform");var NativeTranslateTransform=function(_super){__extends(NativeTranslateTransform,_super);function NativeTranslateTransform(){var _this=_super.call(this)||this;_this._translation=new math_1.Vector2;var callback=function(){_this.notifyObservers()};_this._translation.subscribeToChanges(callback);return _this}Object.defineProperty(NativeTranslateTransform.prototype,"translation",{get:function(){return this._translation},enumerable:false,configurable:true});Object.defineProperty(NativeTranslateTransform.prototype,"matrix",{get:function(){var matrix=(new math_1.Matrix3).setTranslation(this._translation);return matrix},enumerable:false,configurable:true});Object.defineProperty(NativeTranslateTransform.prototype,"matrixNonNative",{get:function(){var matrix=(new math_1.Matrix3).setIdentity();return matrix},enumerable:false,configurable:true});Object.defineProperty(NativeTranslateTransform.prototype,"nativeSvgTransform",{get:function(){var command=null;if(this._translation.length()!==0){command="translate(".concat(this._translation.x,", ").concat(this._translation.y,")")}return command},enumerable:false,configurable:true});return NativeTranslateTransform}(transform_1.Transform);exports.NativeTranslateTransform=NativeTranslateTransform},{"./transform":117,"@daign/math":135}],117:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Transform=void 0;var observable_1=require("@daign/observable");var Transform=function(_super){__extends(Transform,_super);function Transform(){return _super!==null&&_super.apply(this,arguments)||this}return Transform}(observable_1.Observable);exports.Transform=Transform},{"@daign/observable":150}],118:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.TransformCollection=void 0;var math_1=require("@daign/math");var TransformCollection=function(_super){__extends(TransformCollection,_super);function TransformCollection(){var _this=_super.call(this)||this;_this.transformMatrix=(new math_1.Matrix3).setIdentity();_this.inverseTransformMatrix=(new math_1.Matrix3).setIdentity();_this.transformMatrixNonNative=(new math_1.Matrix3).setIdentity();_this.nativeSvgTransform=null;_this.subscribeToChanges(function(){_this.combineTransformations()});return _this}TransformCollection.prototype.combineTransformations=function(){var _this=this;this.transformMatrix.setIdentity();this.transformMatrixNonNative.setIdentity();this.nativeSvgTransform=null;var nativeTransformsArray=[];this.iterate(function(item){_this.transformMatrix.multiply(item.matrix);_this.transformMatrixNonNative.multiply(item.matrixNonNative);if(item.nativeSvgTransform){nativeTransformsArray.push(item.nativeSvgTransform)}});if(nativeTransformsArray.length>0){this.nativeSvgTransform=nativeTransformsArray.join(", ")}try{this.inverseTransformMatrix.setToInverse(this.transformMatrix)}catch(e){}};return TransformCollection}(math_1.GenericArray);exports.TransformCollection=TransformCollection},{"@daign/math":135}],119:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.View=void 0;var graphicNode_1=require("./graphicNode");var presentationNode_1=require("./presentationNode");var View=function(_super){__extends(View,_super);function View(){var _this=_super.call(this)||this;_this.anchorNode=null;_this.anchorNodeSubscriptionRemover=null;_this.viewPresentationNode=null;return _this}View.prototype.mountNode=function(anchorNode){var _this=this;if(this.anchorNodeSubscriptionRemover!==null){this.anchorNodeSubscriptionRemover()}this.anchorNode=anchorNode;var callback=function(){_this.replicateDocumentTree()};this.anchorNodeSubscriptionRemover=this.anchorNode.subscribeToChanges(callback);this.replicateDocumentTree()};View.prototype.replicateDocumentTree=function(){this.destroyDocumentTree();if(this.anchorNode!==null){this.viewPresentationNode=new presentationNode_1.PresentationNode(this,this);this.replicateRecursive(this.viewPresentationNode,this.anchorNode);this.viewPresentationNode.updateProjectionMatrices()}};View.prototype.replicateRecursive=function(parent,sourceNode){var _this=this;var presentationNode=new presentationNode_1.PresentationNode(this,sourceNode);parent.appendChild(presentationNode);sourceNode.children.forEach(function(sourceChild){_this.replicateRecursive(presentationNode,sourceChild)})};View.prototype.destroyDocumentTree=function(){if(this.viewPresentationNode!==null){this.viewPresentationNode.destroyRecursive();this.viewPresentationNode=null}};return View}(graphicNode_1.GraphicNode);exports.View=View},{"./graphicNode":109,"./presentationNode":111}],120:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DomPool=void 0;var DomPool=exports.DomPool=function(){function DomPool(){}DomPool.get=function(nodeName,namespace){var key=namespace?"".concat(namespace,"/").concat(nodeName):"".concat(DomPool.xhtmlNamespace,"/").concat(nodeName);if(this.pool[key]!==undefined&&this.pool[key].length>0){return this.pool[key].pop()}if(namespace){return document.createElementNS(namespace,nodeName)}return document.createElement(nodeName)};DomPool.getFresh=function(nodeName,namespace){if(namespace){return document.createElementNS(namespace,nodeName)}return document.createElement(nodeName)};DomPool.getSvg=function(nodeName){return DomPool.get(nodeName,DomPool.svgNamespace)};DomPool.getFreshSvg=function(nodeName){return DomPool.getFresh(nodeName,DomPool.svgNamespace)};DomPool.giveBack=function(node){var nodeName=node.nodeName;var namespace=node.namespaceURI;var key="".concat(namespace,"/").concat(nodeName);if(this.pool[key]===undefined){this.pool[key]=[]}this.pool[key].push(node)};DomPool.svgNamespace="http://www.w3.org/2000/svg";DomPool.xhtmlNamespace="http://www.w3.org/1999/xhtml";DomPool.pool={};return DomPool}()},{}],121:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WrappedNode=exports.WrappedDomPool=exports.DomPool=void 0;var domPool_1=require("./domPool");Object.defineProperty(exports,"DomPool",{enumerable:true,get:function(){return domPool_1.DomPool}});var wrappedDomPool_1=require("./wrappedDomPool");Object.defineProperty(exports,"WrappedDomPool",{enumerable:true,get:function(){return wrappedDomPool_1.WrappedDomPool}});var wrappedNode_1=require("./wrappedNode");Object.defineProperty(exports,"WrappedNode",{enumerable:true,get:function(){return wrappedNode_1.WrappedNode}})},{"./domPool":120,"./wrappedDomPool":122,"./wrappedNode":123}],122:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WrappedDomPool=void 0;var wrappedNode_1=require("./wrappedNode");var WrappedDomPool=exports.WrappedDomPool=function(){function WrappedDomPool(){}WrappedDomPool.get=function(nodeName,namespace){var key=namespace?"".concat(namespace,"/").concat(nodeName):"".concat(WrappedDomPool.xhtmlNamespace,"/").concat(nodeName);if(this.pool[key]!==undefined){var node=this.pool[key].pop();if(node!==undefined){return node}}if(namespace){return new wrappedNode_1.WrappedNode(nodeName,namespace)}return new wrappedNode_1.WrappedNode(nodeName)};WrappedDomPool.getFresh=function(nodeName,namespace){if(namespace){return new wrappedNode_1.WrappedNode(nodeName,namespace)}return new wrappedNode_1.WrappedNode(nodeName)};WrappedDomPool.getSvg=function(nodeName){return WrappedDomPool.get(nodeName,WrappedDomPool.svgNamespace)};WrappedDomPool.getFreshSvg=function(nodeName){return WrappedDomPool.getFresh(nodeName,WrappedDomPool.svgNamespace)};WrappedDomPool.giveBack=function(node){var nodeName=node.nodeName;var namespace=node.namespace;var key="".concat(namespace,"/").concat(nodeName);if(this.pool[key]===undefined){this.pool[key]=[]}node.reset();this.pool[key].push(node)};WrappedDomPool.clear=function(){for(var _i=0,_a=Object.keys(this.pool);_i<_a.length;_i++){var key=_a[_i];this.pool[key].forEach(function(node){node.destroy()});delete this.pool[key]}};WrappedDomPool.countNodes=function(){var count=0;for(var _i=0,_a=Object.keys(this.pool);_i<_a.length;_i++){var key=_a[_i];count+=this.pool[key].length}return count};WrappedDomPool.countTypes=function(){return Object.keys(this.pool).length};WrappedDomPool.svgNamespace="http://www.w3.org/2000/svg";WrappedDomPool.xhtmlNamespace="http://www.w3.org/1999/xhtml";WrappedDomPool.xlinkNamespace="http://www.w3.org/1999/xlink";WrappedDomPool.pool={};return WrappedDomPool}()},{"./wrappedNode":123}],123:[function(require,module,exports){"use strict";var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:true});exports.WrappedNode=void 0;var xhtmlNamespace="http://www.w3.org/1999/xhtml";var WrappedNode=function(){function WrappedNode(nodeName,namespace){this._children=[];this.usedAttributes=new Set;this.removeEventListenerCallbacks=[];this._nodeName=nodeName;this._namespace=namespace?namespace:xhtmlNamespace;if(namespace){this._domNode=document.createElementNS(namespace,nodeName)}else{this._domNode=document.createElement(nodeName)}}Object.defineProperty(WrappedNode.prototype,"domNode",{get:function(){return this._domNode},enumerable:false,configurable:true});Object.defineProperty(WrappedNode.prototype,"children",{get:function(){return __spreadArray([],this._children,true)},enumerable:false,configurable:true});Object.defineProperty(WrappedNode.prototype,"nodeName",{get:function(){return this._nodeName},enumerable:false,configurable:true});Object.defineProperty(WrappedNode.prototype,"namespace",{get:function(){return this._namespace},enumerable:false,configurable:true});Object.defineProperty(WrappedNode.prototype,"style",{get:function(){this.usedAttributes.add("style");return this._domNode.style},enumerable:false,configurable:true});Object.defineProperty(WrappedNode.prototype,"textContent",{set:function(value){this._domNode.textContent=value},enumerable:false,configurable:true});Object.defineProperty(WrappedNode.prototype,"isPristine",{get:function(){return this.removeEventListenerCallbacks.length===0&&this.usedAttributes.size===0},enumerable:false,configurable:true});WrappedNode.prototype.appendChild=function(childNode){this._children.push(childNode);this._domNode.appendChild(childNode.domNode)};WrappedNode.prototype.clearChildren=function(){this._children=[];while(this._domNode.firstChild){this._domNode.removeChild(this._domNode.firstChild)}};WrappedNode.prototype.setAttribute=function(attributeName,value){this._domNode.setAttribute(attributeName,value);this.usedAttributes.add(attributeName)};WrappedNode.prototype.setAttributeNS=function(namespace,attributeName,value){this._domNode.setAttributeNS(namespace,attributeName,value);this.usedAttributes.add(attributeName)};WrappedNode.prototype.removeAttribute=function(attributeName){this._domNode.removeAttribute(attributeName)};WrappedNode.prototype.addEventListener=function(eventType,listener,useCapture){var _this=this;this._domNode.addEventListener(eventType,listener,useCapture);var removeCallback=function(){_this._domNode.removeEventListener(eventType,listener,useCapture)};this.removeEventListenerCallbacks.push(removeCallback);return removeCallback};WrappedNode.prototype.reset=function(){var _this=this;this.clearChildren();this.textContent="";this.usedAttributes.forEach(function(attributeName){_this.removeAttribute(attributeName)});this.usedAttributes.clear();this.removeEventListenerCallbacks.forEach(function(callback){callback()});this.removeEventListenerCallbacks=[]};WrappedNode.prototype.destroy=function(){this.reset();this._domNode=null};return WrappedNode}();exports.WrappedNode=WrappedNode},{}],124:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ClickHandle=void 0;var math_1=require("@daign/math");var absoluteExtractFromEvent=function(event){return(new math_1.Vector2).setFromEvent(event)};var ClickHandle=function(){function ClickHandle(){var _this=this;this.extractFromEvent=absoluteExtractFromEvent;this.enabled=true;this.clicked=function(){};this.beginClick=function(event){if(!_this.enabled){return}event.preventDefault();event.stopPropagation();_this._position=undefined;try{var position=_this.extractFromEvent(event);_this._position=position}catch(_a){}_this.clicked(event)}}Object.defineProperty(ClickHandle.prototype,"position",{get:function(){return this._position},enumerable:false,configurable:true});ClickHandle.prototype.destroy=function(){if(this.node){this.node.removeEventListener("click",this.beginClick,false);this.node=null}};ClickHandle.prototype.setStartNode=function(startNode){this.destroy();this.node=startNode;this.node.addEventListener("click",this.beginClick,false)};return ClickHandle}();exports.ClickHandle=ClickHandle},{"@daign/math":135}],125:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Handle=void 0;var math_1=require("@daign/math");var schedule_1=require("@daign/schedule");var isPassiveSupported_1=require("./isPassiveSupported");var absoluteExtractFromEvent=function(event){return(new math_1.Vector2).setFromEvent(event)};var Handle=function(){function Handle(){var _this=this;this.minimumDragDistance=5;this.extractFromEvent=absoluteExtractFromEvent;this.throttleInterval=40;this.enabled=true;this.beginning=function(){return false};this.continuing=function(){};this.ending=function(){};this.clicked=function(){};this.cleanup=function(){};this.beginDrag=function(startEvent){if(!_this.enabled){return}startEvent.preventDefault();startEvent.stopPropagation();var dragged=false;_this._start=undefined;_this._absoluteStart=undefined;_this._temp=undefined;_this._delta=undefined;try{var startPosition=_this.extractFromEvent(startEvent);var absoluteStartPosition=absoluteExtractFromEvent(startEvent);_this._start=startPosition;_this._absoluteStart=absoluteStartPosition}catch(_a){return}if(_this.beginning(startEvent)){var cancelSelect_1=function(selectEvent){selectEvent.preventDefault();selectEvent.stopPropagation()};var continueDrag=function(moveEvent){moveEvent.preventDefault();moveEvent.stopPropagation();if(_this._start===undefined||_this._absoluteStart===undefined){return}try{var absoluteTemp=absoluteExtractFromEvent(moveEvent);_this._delta=absoluteTemp.clone().sub(_this._absoluteStart);_this._temp=_this._start.clone().add(_this._delta)}catch(_a){return}if(!dragged){if(_this._delta.length()>=_this.minimumDragDistance){dragged=true}else{return}}_this.continuing(moveEvent)};var throttledContinue_1=schedule_1.Schedule.deferringThrottle(continueDrag,_this.throttleInterval,_this);var endDrag_1=function(endEvent){endEvent.preventDefault();endEvent.stopPropagation();if(_this._start!==undefined&&_this._absoluteStart!==undefined){try{var absoluteTemp=absoluteExtractFromEvent(endEvent);_this._delta=absoluteTemp.clone().sub(_this._absoluteStart);_this._temp=_this._start.clone().add(_this._delta)}catch(_a){}if(dragged){_this.ending(endEvent)}else{_this.clicked(endEvent)}}document.removeEventListener("mousemove",throttledContinue_1,false);document.removeEventListener("touchmove",throttledContinue_1,false);document.removeEventListener("selectstart",cancelSelect_1,false);document.removeEventListener("mouseup",endDrag_1,false);document.removeEventListener("touchend",endDrag_1,false);document.removeEventListener("touchcancel",endDrag_1,false);document.removeEventListener("touchleave",endDrag_1,false);_this.cleanup()};document.addEventListener("mousemove",throttledContinue_1,_this.addEventListenerOptions);document.addEventListener("touchmove",throttledContinue_1,_this.addEventListenerOptions);document.addEventListener("selectstart",cancelSelect_1,_this.addEventListenerOptions);document.addEventListener("mouseup",endDrag_1,_this.addEventListenerOptions);document.addEventListener("touchend",endDrag_1,_this.addEventListenerOptions);document.addEventListener("touchcancel",endDrag_1,_this.addEventListenerOptions);document.addEventListener("touchleave",endDrag_1,_this.addEventListenerOptions)}};var passiveSupported=(0,isPassiveSupported_1.isPassiveSupported)();if(passiveSupported){var options={passive:false};this.addEventListenerOptions=options}else{this.addEventListenerOptions=false}}Object.defineProperty(Handle.prototype,"start",{get:function(){return this._start},enumerable:false,configurable:true});Object.defineProperty(Handle.prototype,"temp",{get:function(){return this._temp},enumerable:false,configurable:true});Object.defineProperty(Handle.prototype,"delta",{get:function(){return this._delta},enumerable:false,configurable:true});Handle.prototype.setStartNode=function(startNode){this.destroy();this.node=startNode;this.node.addEventListener("mousedown",this.beginDrag,this.addEventListenerOptions);this.node.addEventListener("touchstart",this.beginDrag,this.addEventListenerOptions)};Handle.prototype.destroy=function(){if(this.node){this.node.removeEventListener("mousedown",this.beginDrag,false);this.node.removeEventListener("touchstart",this.beginDrag,false);this.node=null}};return Handle}();exports.Handle=Handle},{"./isPassiveSupported":127,"@daign/math":135,"@daign/schedule":154}],126:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ScrollHandle=exports.MultiTouchScrollHandle=exports.MultiTouchHandle=exports.isPassiveSupported=exports.Handle=exports.ClickHandle=void 0;var clickHandle_1=require("./clickHandle");Object.defineProperty(exports,"ClickHandle",{enumerable:true,get:function(){return clickHandle_1.ClickHandle}});var handle_1=require("./handle");Object.defineProperty(exports,"Handle",{enumerable:true,get:function(){return handle_1.Handle}});var isPassiveSupported_1=require("./isPassiveSupported");Object.defineProperty(exports,"isPassiveSupported",{enumerable:true,get:function(){return isPassiveSupported_1.isPassiveSupported}});var multiTouchHandle_1=require("./multiTouchHandle");Object.defineProperty(exports,"MultiTouchHandle",{enumerable:true,get:function(){return multiTouchHandle_1.MultiTouchHandle}});var multiTouchScrollHandle_1=require("./multiTouchScrollHandle");Object.defineProperty(exports,"MultiTouchScrollHandle",{enumerable:true,get:function(){return multiTouchScrollHandle_1.MultiTouchScrollHandle}});var scrollHandle_1=require("./scrollHandle");Object.defineProperty(exports,"ScrollHandle",{enumerable:true,get:function(){return scrollHandle_1.ScrollHandle}})},{"./clickHandle":124,"./handle":125,"./isPassiveSupported":127,"./multiTouchHandle":128,"./multiTouchScrollHandle":129,"./scrollHandle":130}],127:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isPassiveSupported=void 0;var isPassiveSupported=function(){var supported=false;try{var options={get passive(){supported=true;return false}};var callback=function(){};window.addEventListener("click",callback,options);window.removeEventListener("click",callback,false)}catch(_a){supported=false}return supported};exports.isPassiveSupported=isPassiveSupported},{}],128:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MultiTouchHandle=void 0;var math_1=require("@daign/math");var schedule_1=require("@daign/schedule");var isPassiveSupported_1=require("./isPassiveSupported");var absoluteExtractFromEvent=function(event){return(new math_1.Vector2).setFromEvent(event)};var absoluteExtractFromTouchEvent=function(event,touchIndex){return(new math_1.Vector2).setFromTouchEvent(event,touchIndex)};var MultiTouchHandle=function(){function MultiTouchHandle(){var _this=this;this.minimumDragDistance=5;this.extractFromEvent=absoluteExtractFromEvent;this.extractFromTouchEvent=absoluteExtractFromTouchEvent;this.throttleInterval=40;this._startPositions=[];this._absoluteStartPositions=[];this._tempPositions=[];this._deltaVectors=[];this.enabled=true;this.beginning=function(){return false};this.continuing=function(){};this.ending=function(){};this.clicked=function(){};this.cleanup=function(){};this.beginDrag=function(startEvent){if(!_this.enabled){return}startEvent.preventDefault();startEvent.stopPropagation();var dragged=false;_this._startPositions=[];_this._absoluteStartPositions=[];_this._tempPositions=[];_this._deltaVectors=[];if(startEvent&&startEvent.touches&&startEvent.touches.length>0){var touchPoints=startEvent.touches.length;try{for(var i=0;i<touchPoints;i+=1){var position=_this.extractFromTouchEvent(startEvent,i);_this._startPositions.push(position);var absolutePosition=absoluteExtractFromTouchEvent(startEvent,i);_this._absoluteStartPositions.push(absolutePosition);_this._deltaVectors.push(new math_1.Vector2);_this._tempPositions.push(position.clone())}}catch(_a){return}}else{try{var position=_this.extractFromEvent(startEvent);_this._startPositions.push(position);var absolutePosition=absoluteExtractFromEvent(startEvent);_this._absoluteStartPositions.push(absolutePosition);_this._deltaVectors.push(new math_1.Vector2);_this._tempPositions.push(position.clone())}catch(_b){return}}if(_this.beginning(startEvent)){var cancelSelect_1=function(selectEvent){selectEvent.preventDefault();selectEvent.stopPropagation()};var continueDrag=function(moveEvent){moveEvent.preventDefault();moveEvent.stopPropagation();try{_this.updatePositions(moveEvent)}catch(_a){return}if(!dragged){if(_this._deltaVectors.some(function(delta){return delta.length()>=_this.minimumDragDistance})){dragged=true}else{return}}_this.continuing(moveEvent)};var throttledContinue_1=schedule_1.Schedule.deferringThrottle(continueDrag,_this.throttleInterval,_this);var endDrag_1=function(endEvent){endEvent.preventDefault();endEvent.stopPropagation();try{_this.updatePositions(endEvent)}catch(_a){}if(dragged){_this.ending(endEvent)}else{_this.clicked(endEvent)}document.removeEventListener("mousemove",throttledContinue_1,false);document.removeEventListener("touchmove",throttledContinue_1,false);document.removeEventListener("selectstart",cancelSelect_1,false);document.removeEventListener("mouseup",endDrag_1,false);document.removeEventListener("touchend",endDrag_1,false);document.removeEventListener("touchcancel",endDrag_1,false);document.removeEventListener("touchleave",endDrag_1,false);_this.cleanup()};document.addEventListener("mousemove",throttledContinue_1,_this.addEventListenerOptions);document.addEventListener("touchmove",throttledContinue_1,_this.addEventListenerOptions);document.addEventListener("selectstart",cancelSelect_1,_this.addEventListenerOptions);document.addEventListener("mouseup",endDrag_1,_this.addEventListenerOptions);document.addEventListener("touchend",endDrag_1,_this.addEventListenerOptions);document.addEventListener("touchcancel",endDrag_1,_this.addEventListenerOptions);document.addEventListener("touchleave",endDrag_1,_this.addEventListenerOptions)}};var passiveSupported=(0,isPassiveSupported_1.isPassiveSupported)();if(passiveSupported){var options={passive:false};this.addEventListenerOptions=options}else{this.addEventListenerOptions=false}}MultiTouchHandle.prototype.getStartPosition=function(index){return this._startPositions[index]};MultiTouchHandle.prototype.getTempPosition=function(index){return this._tempPositions[index]};MultiTouchHandle.prototype.getDelta=function(index){return this._deltaVectors[index]};MultiTouchHandle.prototype.destroy=function(){if(this.node){this.node.removeEventListener("mousedown",this.beginDrag,false);this.node.removeEventListener("touchstart",this.beginDrag,false);this.node=null}};MultiTouchHandle.prototype.setStartNode=function(startNode){this.destroy();this.node=startNode;this.node.addEventListener("mousedown",this.beginDrag,this.addEventListenerOptions);this.node.addEventListener("touchstart",this.beginDrag,this.addEventListenerOptions)};MultiTouchHandle.prototype.updatePositions=function(event){if(this._startPositions.length===0||this._absoluteStartPositions.length===0||this._tempPositions.length===0||this._deltaVectors.length===0){throw new Error("Missing start positions to calculate drag.")}if(event&&event.touches&&event.touches.length>0){var touchPoints=event.touches.length;for(var i=0;i<touchPoints;i+=1){var absoluteTemp=absoluteExtractFromTouchEvent(event,i);if(i<this._startPositions.length){this._deltaVectors[i].copy(absoluteTemp).sub(this._absoluteStartPositions[i]);this._tempPositions[i].copy(this._startPositions[i]).add(this._deltaVectors[i])}}}else{var absoluteTemp=absoluteExtractFromEvent(event);this._deltaVectors[0].copy(absoluteTemp).sub(this._absoluteStartPositions[0]);this._tempPositions[0].copy(this._startPositions[0]).add(this._deltaVectors[0])}};return MultiTouchHandle}();exports.MultiTouchHandle=MultiTouchHandle},{"./isPassiveSupported":127,"@daign/math":135,"@daign/schedule":154}],129:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.MultiTouchScrollHandle=void 0;var math_1=require("@daign/math");var multiTouchHandle_1=require("./multiTouchHandle");var MultiTouchScrollHandle=function(_super){__extends(MultiTouchScrollHandle,_super);function MultiTouchScrollHandle(){var _this=_super.call(this)||this;_this._scroll=new math_1.Vector2;_this._scrollMode=0;_this._scrollPosition=new math_1.Vector2;_this.scrolling=function(){};_this.beginScroll=function(scrollEvent){if(!_this.enabled){return true}scrollEvent.preventDefault();scrollEvent.stopPropagation();try{_this._scroll.setFromScrollEvent(scrollEvent);_this._scrollMode=scrollEvent.deltaMode;_this._scrollPosition.copy(_this.extractFromEvent(scrollEvent));_this.scrolling()}catch(_a){}return false};return _this}Object.defineProperty(MultiTouchScrollHandle.prototype,"scroll",{get:function(){return this._scroll},enumerable:false,configurable:true});Object.defineProperty(MultiTouchScrollHandle.prototype,"scrollMode",{get:function(){return this._scrollMode},enumerable:false,configurable:true});Object.defineProperty(MultiTouchScrollHandle.prototype,"scrollPosition",{get:function(){return this._scrollPosition},enumerable:false,configurable:true});MultiTouchScrollHandle.prototype.destroy=function(){if(this.node){this.node.removeEventListener("wheel",this.beginScroll,false)}_super.prototype.destroy.call(this)};MultiTouchScrollHandle.prototype.setStartNode=function(startNode){_super.prototype.setStartNode.call(this,startNode);this.node.addEventListener("wheel",this.beginScroll,this.addEventListenerOptions)};return MultiTouchScrollHandle}(multiTouchHandle_1.MultiTouchHandle);exports.MultiTouchScrollHandle=MultiTouchScrollHandle},{"./multiTouchHandle":128,"@daign/math":135}],130:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ScrollHandle=void 0;var math_1=require("@daign/math");var handle_1=require("./handle");var ScrollHandle=function(_super){__extends(ScrollHandle,_super);function ScrollHandle(){var _this=_super.call(this)||this;_this._scroll=new math_1.Vector2;_this._scrollMode=0;_this._scrollPosition=new math_1.Vector2;_this.scrolling=function(){};_this.beginScroll=function(scrollEvent){if(!_this.enabled){return true}scrollEvent.preventDefault();scrollEvent.stopPropagation();try{_this._scroll.setFromScrollEvent(scrollEvent);_this._scrollMode=scrollEvent.deltaMode;_this._scrollPosition.copy(_this.extractFromEvent(scrollEvent));_this.scrolling()}catch(_a){}return false};return _this}Object.defineProperty(ScrollHandle.prototype,"scroll",{get:function(){return this._scroll},enumerable:false,configurable:true});Object.defineProperty(ScrollHandle.prototype,"scrollMode",{get:function(){return this._scrollMode},enumerable:false,configurable:true});Object.defineProperty(ScrollHandle.prototype,"scrollPosition",{get:function(){return this._scrollPosition},enumerable:false,configurable:true});ScrollHandle.prototype.destroy=function(){if(this.node){this.node.removeEventListener("wheel",this.beginScroll,false)}_super.prototype.destroy.call(this)};ScrollHandle.prototype.setStartNode=function(startNode){_super.prototype.setStartNode.call(this,startNode);this.node.addEventListener("wheel",this.beginScroll,this.addEventListenerOptions)};return ScrollHandle}(handle_1.Handle);exports.ScrollHandle=ScrollHandle},{"./handle":125,"@daign/math":135}],131:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Angle=void 0;var vector1_1=require("./vector1");var Angle=function(_super){__extends(Angle,_super);function Angle(radians){return _super.call(this,radians)||this}Object.defineProperty(Angle.prototype,"radians",{get:function(){return this.x},set:function(value){this.x=value},enumerable:false,configurable:true});Object.defineProperty(Angle.prototype,"degrees",{get:function(){return this.radians*180/Math.PI},set:function(value){this.radians=value*Math.PI/180},enumerable:false,configurable:true});Angle.prototype.getThis=function(){return this};Angle.prototype.setRadians=function(value){this.radians=value;return this};Angle.prototype.setDegrees=function(value){this.degrees=value;return this};Angle.prototype.clone=function(){return new Angle(this.radians)};Angle.prototype.reduce=function(){this.radians=this.radians%(2*Math.PI);return this};Angle.prototype.normalize=function(){var value=this.radians%(2*Math.PI);value=(2*Math.PI+value)%(2*Math.PI);this.radians=value;return this};Angle.prototype.normalizeMinimumAbsolute=function(){var value=this.radians%(2*Math.PI);value=(2*Math.PI+value)%(2*Math.PI);if(value>Math.PI){value-=2*Math.PI}this.radians=value;return this};Angle.prototype.roundDegrees=function(precision){if(precision){var factor=Math.pow(10,precision);this.degrees=Math.round((this.degrees+Number.EPSILON)*factor)/factor}else{this.degrees=Math.round(this.degrees)}return this};return Angle}(vector1_1.Vector1);exports.Angle=Angle},{"./vector1":145}],132:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Box2=void 0;var observable_1=require("@daign/observable");var vector2_1=require("./vector2");var Box2=function(_super){__extends(Box2,_super);function Box2(min,max){var _this=_super.call(this)||this;_this._min=min||new vector2_1.Vector2(+Infinity,+Infinity);_this._max=max||new vector2_1.Vector2(-Infinity,-Infinity);var callback=function(){_this.notifyObservers()};_this.min.subscribeToChanges(callback);_this.max.subscribeToChanges(callback);return _this}Object.defineProperty(Box2.prototype,"min",{get:function(){return this._min},enumerable:false,configurable:true});Object.defineProperty(Box2.prototype,"max",{get:function(){return this._max},enumerable:false,configurable:true});Object.defineProperty(Box2.prototype,"isEmpty",{get:function(){return this.max.x<this.min.x||this.max.y<this.min.y},enumerable:false,configurable:true});Object.defineProperty(Box2.prototype,"isArea",{get:function(){return this.max.x>this.min.x&&this.max.y>this.min.y},enumerable:false,configurable:true});Object.defineProperty(Box2.prototype,"size",{get:function(){if(this.isEmpty){return new vector2_1.Vector2(0,0)}return this.max.clone().sub(this.min)},enumerable:false,configurable:true});Object.defineProperty(Box2.prototype,"center",{get:function(){if(this.isEmpty){return new vector2_1.Vector2(0,0)}return this.min.clone().add(this.size.multiplyScalar(.5))},enumerable:false,configurable:true});Box2.prototype.copy=function(b){this.min.copy(b.min);this.max.copy(b.max);return this};Box2.prototype.clone=function(){return new Box2(this.min.clone(),this.max.clone())};Box2.prototype.equals=function(b){return this.min.equals(b.min)&&this.max.equals(b.max)};Box2.prototype.makeEmpty=function(){this.min.set(+Infinity,+Infinity);this.max.set(-Infinity,-Infinity);return this};Box2.prototype.makeUnlimited=function(){this.min.set(-Infinity,-Infinity);this.max.set(+Infinity,+Infinity);return this};Box2.prototype.expandByScalar=function(s){var offset=new vector2_1.Vector2(s,s);var minimumOffset=this.size.multiplyScalar(-.5);offset.max(minimumOffset);this.min.sub(offset);this.max.add(offset);return this};Box2.prototype.scale=function(s){var difference=this.size.multiplyScalar((Math.abs(s)-1)/2);this.min.sub(difference);this.max.add(difference);return this};Box2.prototype.expandByPoint=function(p){this.min.min(p);this.max.max(p);return this};Box2.prototype.expandByBox=function(b){this.min.min(b.min);this.max.max(b.max);return this};Box2.prototype.transform=function(m){if(this.isEmpty){return this}var corner1=this.min.clone().transform(m);var corner2=this.max.clone().transform(m);var corner3=new vector2_1.Vector2(this.min.x,this.max.y).transform(m);var corner4=new vector2_1.Vector2(this.max.x,this.min.y).transform(m);this.makeEmpty();this.expandByPoint(corner1);this.expandByPoint(corner2);this.expandByPoint(corner3);this.expandByPoint(corner4);return this};Box2.prototype.containsPoint=function(p){return!(p.x<this.min.x||p.x>this.max.x||p.y<this.min.y||p.y>this.max.y)};Box2.prototype.containsBox=function(b){return this.min.x<=b.min.x&&b.max.x<=this.max.x&&this.min.y<=b.min.y&&b.max.y<=this.max.y};return Box2}(observable_1.Observable);exports.Box2=Box2},{"./vector2":146,"@daign/observable":150}],133:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ComplexNumber=void 0;var observable_1=require("@daign/observable");var mathHelper_1=require("./mathHelper");var ComplexNumber=function(_super){__extends(ComplexNumber,_super);function ComplexNumber(real,imaginary){var _this=_super.call(this)||this;_this._real=real||0;_this._imaginary=imaginary||0;return _this}Object.defineProperty(ComplexNumber.prototype,"real",{get:function(){return this._real},set:function(value){if(this._real!==value){this._real=value;this.notifyObservers()}},enumerable:false,configurable:true});Object.defineProperty(ComplexNumber.prototype,"imaginary",{get:function(){return this._imaginary},set:function(value){if(this._imaginary!==value){this._imaginary=value;this.notifyObservers()}},enumerable:false,configurable:true});Object.defineProperty(ComplexNumber.prototype,"absolute",{get:function(){var a=this.real;var b=this.imaginary;return Math.sqrt(a*a+b*b)},enumerable:false,configurable:true});Object.defineProperty(ComplexNumber.prototype,"argument",{get:function(){return Math.atan2(this.imaginary,this.real)},enumerable:false,configurable:true});ComplexNumber.prototype.set=function(real,imaginary){if(this._real!==real||this._imaginary!==imaginary){this._real=real;this._imaginary=imaginary;this.notifyObservers()}return this};ComplexNumber.prototype.setSilent=function(real,imaginary){this._real=real;this._imaginary=imaginary;return this};ComplexNumber.prototype.copy=function(c){this.set(c.real,c.imaginary);return this};ComplexNumber.prototype.clone=function(){return new ComplexNumber(this.real,this.imaginary)};ComplexNumber.prototype.equals=function(c){return this.real===c.real&&this.imaginary===c.imaginary};ComplexNumber.prototype.closeTo=function(c,delta){return mathHelper_1.MathHelper.closeTo(this.real,c.real,delta)&&mathHelper_1.MathHelper.closeTo(this.imaginary,c.imaginary,delta)};ComplexNumber.prototype.add=function(c){this.set(this.real+c.real,this.imaginary+c.imaginary);return this};ComplexNumber.prototype.sub=function(c){this.set(this.real-c.real,this.imaginary-c.imaginary);return this};ComplexNumber.prototype.multiply=function(cn){var a=this.real;var b=this.imaginary;var c=cn.real;var d=cn.imaginary;var real=a*c-b*d;var imaginary=b*c+a*d;this.set(real,imaginary);return this};ComplexNumber.prototype.divide=function(cn){var a=this.real;var b=this.imaginary;var c=cn.real;var d=cn.imaginary;var real=(a*c+b*d)/(c*c+d*d);var imaginary=(b*c-a*d)/(c*c+d*d);this.set(real,imaginary);return this};ComplexNumber.prototype.log=function(){var real=Math.log(this.absolute);var imaginary=this.argument;this.set(real,imaginary);return this};ComplexNumber.prototype.atan=function(){var a=this.real;var b=this.imaginary;var x=1+2*b+b*b+a*a;var result=new ComplexNumber((1-b*b-a*a)/x,2*a/x);result.log();result.multiply(new ComplexNumber(0,-.5));this.copy(result);return this};ComplexNumber.fromSqrt=function(value){var a=Math.sqrt(Math.abs(value));if(value<0){return new ComplexNumber(0,a)}return new ComplexNumber(a,0)};ComplexNumber.fromAsin=function(value){var result=ComplexNumber.fromSqrt(1-value*value);result.add(new ComplexNumber(0,value));result.log();result.multiply(new ComplexNumber(0,-1));return result};ComplexNumber.fromAcos=function(value){var result=new ComplexNumber(Math.PI/2,0);result.sub(ComplexNumber.fromAsin(value));return result};return ComplexNumber}(observable_1.Observable);exports.ComplexNumber=ComplexNumber},{"./mathHelper":137,"@daign/observable":150}],134:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:true});exports.GenericArray=void 0;var observable_1=require("@daign/observable");var GenericArray=function(_super){__extends(GenericArray,_super);function GenericArray(){var _this=_super.call(this)||this;_this._elements=[];_this.subscriptionRemovers=[];_this.namedMapping={};return _this}Object.defineProperty(GenericArray.prototype,"elements",{get:function(){return __spreadArray([],this._elements,true)},set:function(elements){var _this=this;this.subscriptionRemovers.forEach(function(remover){remover()});this.namedMapping={};this._elements=__spreadArray([],elements,true);this.subscriptionRemovers=this._elements.map(function(element){var subscriptionRemover=element.subscribeToChanges(function(){_this.notifyObservers()});return subscriptionRemover});this.notifyObservers()},enumerable:false,configurable:true});Object.defineProperty(GenericArray.prototype,"length",{get:function(){return this._elements.length},enumerable:false,configurable:true});Object.defineProperty(GenericArray.prototype,"names",{get:function(){return Object.keys(this.namedMapping)},enumerable:false,configurable:true});GenericArray.prototype.containsName=function(name){return name in this.namedMapping};GenericArray.prototype.copyElements=function(arr){this.elements=arr.elements;return this};GenericArray.prototype.getElement=function(index){return this._elements[index]};GenericArray.prototype.getByName=function(name){if(!this.containsName(name)){throw new Error("No element exists for the given name.")}return this.namedMapping[name]};GenericArray.prototype.assignName=function(name,index){if(this.containsName(name)){throw new Error("Name is not unique.")}if(index>=this.length){throw new Error("The index of the element to be named is out of bounds.")}this.namedMapping[name]=this._elements[index];return this};GenericArray.prototype.removeName=function(name){if(!this.containsName(name)){throw new Error("Name does not exist in mapping.")}delete this.namedMapping[name];return this};GenericArray.prototype.push=function(element,name){var _this=this;if(name&&this.containsName(name)){throw new Error("Name is not unique.")}this._elements.push(element);if(name){this.namedMapping[name]=element}var subscriptionRemover=element.subscribeToChanges(function(){_this.notifyObservers()});this.subscriptionRemovers.push(subscriptionRemover);this.notifyObservers();return this};GenericArray.prototype.insert=function(element,index,name){var _this=this;if(name&&this.containsName(name)){throw new Error("Name is not unique.")}if(index<0||index>this._elements.length){throw new Error("The index is out of bounds for array insertion.")}this._elements.splice(index,0,element);if(name){this.namedMapping[name]=element}var subscriptionRemover=element.subscribeToChanges(function(){_this.notifyObservers()});this.subscriptionRemovers.push(subscriptionRemover);this.notifyObservers();return this};GenericArray.prototype.pop=function(){var result=this._elements.pop();var subscriptionRemover=this.subscriptionRemovers.pop();if(subscriptionRemover!==undefined){subscriptionRemover()}if(result!==undefined){this.notifyObservers()}return result};GenericArray.prototype.remove=function(index){if(index<0||index>=this._elements.length){throw new Error("The index is out of bounds for removal from array.")}var result=this._elements.splice(index,1)[0];var subscriptionRemover=this.subscriptionRemovers.splice(index,1)[0];subscriptionRemover();this.notifyObservers();return result};GenericArray.prototype.iterate=function(callback){this._elements.forEach(function(element,index){callback(element,index)});return this};GenericArray.prototype.iteratePairwise=function(callback){for(var i=0;i<this._elements.length-1;i+=1){callback(this._elements[i],this._elements[i+1],i)}return this};return GenericArray}(observable_1.Observable);exports.GenericArray=GenericArray},{"@daign/observable":150}],135:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Vector3=exports.Vector2Array=exports.Vector2=exports.Vector1=exports.Value=exports.Triangle2=exports.StringValue=exports.StringArray=exports.Ray2=exports.Polygon2=exports.Matrix3=exports.MathHelper=exports.Line2=exports.GenericArray=exports.ComplexNumber=exports.Box2=exports.Angle=void 0;var angle_1=require("./angle");Object.defineProperty(exports,"Angle",{enumerable:true,get:function(){return angle_1.Angle}});var box2_1=require("./box2");Object.defineProperty(exports,"Box2",{enumerable:true,get:function(){return box2_1.Box2}});var complexNumber_1=require("./complexNumber");Object.defineProperty(exports,"ComplexNumber",{enumerable:true,get:function(){return complexNumber_1.ComplexNumber}});var genericArray_1=require("./genericArray");Object.defineProperty(exports,"GenericArray",{enumerable:true,get:function(){return genericArray_1.GenericArray}});var line2_1=require("./line2");Object.defineProperty(exports,"Line2",{enumerable:true,get:function(){return line2_1.Line2}});var mathHelper_1=require("./mathHelper");Object.defineProperty(exports,"MathHelper",{enumerable:true,get:function(){return mathHelper_1.MathHelper}});var matrix3_1=require("./matrix3");Object.defineProperty(exports,"Matrix3",{enumerable:true,get:function(){return matrix3_1.Matrix3}});var polygon2_1=require("./polygon2");Object.defineProperty(exports,"Polygon2",{enumerable:true,get:function(){return polygon2_1.Polygon2}});var ray2_1=require("./ray2");Object.defineProperty(exports,"Ray2",{enumerable:true,get:function(){return ray2_1.Ray2}});var stringArray_1=require("./stringArray");Object.defineProperty(exports,"StringArray",{enumerable:true,get:function(){return stringArray_1.StringArray}});var stringValue_1=require("./stringValue");Object.defineProperty(exports,"StringValue",{enumerable:true,get:function(){return stringValue_1.StringValue}});var triangle2_1=require("./triangle2");Object.defineProperty(exports,"Triangle2",{enumerable:true,get:function(){return triangle2_1.Triangle2}});var value_1=require("./value");Object.defineProperty(exports,"Value",{enumerable:true,get:function(){return value_1.Value}});var vector1_1=require("./vector1");Object.defineProperty(exports,"Vector1",{enumerable:true,get:function(){return vector1_1.Vector1}});var vector2_1=require("./vector2");Object.defineProperty(exports,"Vector2",{enumerable:true,get:function(){return vector2_1.Vector2}});var vector2Array_1=require("./vector2Array");Object.defineProperty(exports,"Vector2Array",{enumerable:true,get:function(){return vector2Array_1.Vector2Array}});var vector3_1=require("./vector3");Object.defineProperty(exports,"Vector3",{enumerable:true,get:function(){return vector3_1.Vector3}})},{"./angle":131,"./box2":132,"./complexNumber":133,"./genericArray":134,"./line2":136,"./mathHelper":137,"./matrix3":138,"./polygon2":139,"./ray2":140,"./stringArray":141,"./stringValue":142,"./triangle2":143,"./value":144,"./vector1":145,"./vector2":146,"./vector2Array":147,"./vector3":148}],136:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Line2=void 0;var observable_1=require("@daign/observable");var vector2_1=require("./vector2");var mathHelper_1=require("./mathHelper");var precision=1e-14;var Line2=function(_super){__extends(Line2,_super);function Line2(start,end){var _this=_super.call(this)||this;_this._start=start||new vector2_1.Vector2;_this._end=end||new vector2_1.Vector2;var callback=function(){_this.notifyObservers()};_this._start.subscribeToChanges(callback);_this._end.subscribeToChanges(callback);return _this}Object.defineProperty(Line2.prototype,"start",{get:function(){return this._start},enumerable:false,configurable:true});Object.defineProperty(Line2.prototype,"end",{get:function(){return this._end},enumerable:false,configurable:true});Object.defineProperty(Line2.prototype,"direction",{get:function(){return this.end.clone().sub(this.start)},enumerable:false,configurable:true});Object.defineProperty(Line2.prototype,"length",{get:function(){return this.direction.length()},enumerable:false,configurable:true});Object.defineProperty(Line2.prototype,"slope",{get:function(){var d=this.direction;if(d.x===0){return Infinity}return d.y/d.x},enumerable:false,configurable:true});Object.defineProperty(Line2.prototype,"yIntercept",{get:function(){var slope=this.slope;if(!isFinite(slope)){return null}return this.start.y-slope*this.start.x},enumerable:false,configurable:true});Line2.prototype.copy=function(l){this.start.copy(l.start);this.end.copy(l.end);return this};Line2.prototype.clone=function(){return new Line2(this.start.clone(),this.end.clone())};Line2.prototype.equals=function(l){return this.start.equals(l.start)&&this.end.equals(l.end)};Line2.prototype.getCenter=function(){return this.start.clone().add(this.end).multiplyScalar(.5)};Line2.prototype.interpolate=function(t){return this.direction.multiplyScalar(t).add(this.start)};Line2.prototype.isParallel=function(l){var direction1=this.direction;var direction2=l.direction;return direction1.x*direction2.y===direction2.x*direction1.y};Line2.prototype.isPerpendicular=function(l){var direction1=this.direction;var direction2=l.direction;return direction1.dot(direction2)===0};Line2.prototype.getIntersection=function(l){var ax=this.start.x;var ay=this.start.y;var bx=this.end.x;var by=this.end.y;var cx=l.start.x;var cy=l.start.y;var dx=l.end.x;var dy=l.end.y;var n=(bx-ax)*(dy-cy)-(by-ay)*(dx-cx);if(n!==0){var s=((ax-cx)*(dy-cy)-(ay-cy)*(dx-cx))/-n;var x=ax+s*(bx-ax);var y=ay+s*(by-ay);return new vector2_1.Vector2(x,y)}return null};Line2.prototype.getSegmentIntersection=function(l){var ax=this.start.x;var ay=this.start.y;var bx=this.end.x;var by=this.end.y;var cx=l.start.x;var cy=l.start.y;var dx=l.end.x;var dy=l.end.y;var n=(bx-ax)*(dy-cy)-(by-ay)*(dx-cx);if(n!==0){var s=((ax-cx)*(dy-cy)-(ay-cy)*(dx-cx))/-n;var t=((cx-ax)*(by-ay)-(cy-ay)*(bx-ax))/n;if(mathHelper_1.MathHelper.withinOrCloseToLimits(s,0,1,precision)&&mathHelper_1.MathHelper.withinOrCloseToLimits(t,0,1,precision)){var x=ax+s*(bx-ax);var y=ay+s*(by-ay);return new vector2_1.Vector2(x,y)}}return null};Line2.prototype.getSegmentAndLineIntersection=function(l){var ax=this.start.x;var ay=this.start.y;var bx=this.end.x;var by=this.end.y;var cx=l.start.x;var cy=l.start.y;var dx=l.end.x;var dy=l.end.y;var n=(bx-ax)*(dy-cy)-(by-ay)*(dx-cx);if(n!==0){var s=((ax-cx)*(dy-cy)-(ay-cy)*(dx-cx))/-n;if(mathHelper_1.MathHelper.withinOrCloseToLimits(s,0,1,precision)){var x=ax+s*(bx-ax);var y=ay+s*(by-ay);return new vector2_1.Vector2(x,y)}}return null};Line2.prototype.getNearestPointOnLineSegment=function(point){var support=point.clone().sub(this.start);var directionN=this.direction.normalize();var d=support.dot(directionN);var clamped=mathHelper_1.MathHelper.clamp(d,0,this.length);return directionN.clone().multiplyScalar(clamped).add(this.start)};Line2.prototype.getSideOfPoint=function(point){var d=this.direction.cross(point.clone().sub(this.start));if(mathHelper_1.MathHelper.closeTo(d,0,precision)){return 0}return Math.sign(d)};Line2.prototype.containsPoint=function(point){var side=this.getSideOfPoint(point);return side===0};Line2.prototype.containsPointInSegment=function(point){var onLine=this.containsPoint(point);if(onLine){var support=point.clone().sub(this.start);var d=support.dot(this.direction.normalize());var length_1=this.length;if(mathHelper_1.MathHelper.withinOrCloseToLimits(d,0,length_1,precision)){return true}}return false};return Line2}(observable_1.Observable);exports.Line2=Line2},{"./mathHelper":137,"./vector2":146,"@daign/observable":150}],137:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MathHelper=void 0;var MathHelper=function(){function MathHelper(){}MathHelper.clamp=function(value,min,max){return Math.max(min,Math.min(max,value))};MathHelper.lerp=function(x,y,t){return(1-t)*x+t*y};MathHelper.closeTo=function(x,y,delta){var epsilon=2220446049250313e-31;var d=delta!==undefined?delta:epsilon;return Math.abs(x-y)<d};MathHelper.withinOrCloseToLimits=function(value,min,max,delta){if(value>=min&&value<=max){return true}else if(this.closeTo(value,min,delta)){return true}else if(MathHelper.closeTo(value,max,delta)){return true}return false};MathHelper.greaterOrCloseTo=function(value,min,delta){if(value>=min){return true}else if(this.closeTo(value,min,delta)){return true}return false};MathHelper.precisionRound=function(value,precision){var factor=Math.pow(10,precision);var roundedValue=Math.round((value+Number.EPSILON)*factor)/factor;return roundedValue};return MathHelper}();exports.MathHelper=MathHelper},{}],138:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:true});exports.Matrix3=void 0;var observable_1=require("@daign/observable");var Matrix3=function(_super){__extends(Matrix3,_super);function Matrix3(a11,a12,a13,a21,a22,a23,a31,a32,a33){var _this=_super.call(this)||this;_this._elements=[];var e=_this._elements;e[0]=a11||0;e[1]=a12||0;e[2]=a13||0;e[3]=a21||0;e[4]=a22||0;e[5]=a23||0;e[6]=a31||0;e[7]=a32||0;e[8]=a33||0;return _this}Object.defineProperty(Matrix3.prototype,"elements",{get:function(){return __spreadArray([],this._elements,true)},enumerable:false,configurable:true});Matrix3.prototype.set=function(a11,a12,a13,a21,a22,a23,a31,a32,a33){var e=this._elements;if(e[0]!==a11||e[1]!==a12||e[2]!==a13||e[3]!==a21||e[4]!==a22||e[5]!==a23||e[6]!==a31||e[7]!==a32||e[8]!==a33){e[0]=a11;e[1]=a12;e[2]=a13;e[3]=a21;e[4]=a22;e[5]=a23;e[6]=a31;e[7]=a32;e[8]=a33;this.notifyObservers()}return this};Matrix3.prototype.copy=function(m){var e=m.elements;this.set(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]);return this};Matrix3.prototype.clone=function(){var e=this.elements;return new Matrix3(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])};Matrix3.prototype.equals=function(m){var e1=this.elements;var e2=m.elements;return e1[0]===e2[0]&&e1[1]===e2[1]&&e1[2]===e2[2]&&e1[3]===e2[3]&&e1[4]===e2[4]&&e1[5]===e2[5]&&e1[6]===e2[6]&&e1[7]===e2[7]&&e1[8]===e2[8]};Matrix3.prototype.matrixMultiplication=function(m1,m2){var a=m1.elements;var b=m2.elements;this.set(a[0]*b[0]+a[1]*b[3]+a[2]*b[6],a[0]*b[1]+a[1]*b[4]+a[2]*b[7],a[0]*b[2]+a[1]*b[5]+a[2]*b[8],a[3]*b[0]+a[4]*b[3]+a[5]*b[6],a[3]*b[1]+a[4]*b[4]+a[5]*b[7],a[3]*b[2]+a[4]*b[5]+a[5]*b[8],a[6]*b[0]+a[7]*b[3]+a[8]*b[6],a[6]*b[1]+a[7]*b[4]+a[8]*b[7],a[6]*b[2]+a[7]*b[5]+a[8]*b[8]);return this};Matrix3.prototype.multiply=function(m){this.matrixMultiplication(this,m);return this};Matrix3.prototype.transform=function(m){this.matrixMultiplication(m,this);return this};Matrix3.prototype.setIdentity=function(){this.set(1,0,0,0,1,0,0,0,1);return this};Matrix3.prototype.setTranslation=function(t){this.set(1,0,t.x,0,1,t.y,0,0,1);return this};Matrix3.prototype.setScaling=function(s){this.set(s.x,0,0,0,s.y,0,0,0,1);return this};Matrix3.prototype.setRotation=function(a,p){if(p===undefined){var sin=Math.sin(a.radians);var cos=Math.cos(a.radians);this.set(cos,-sin,0,sin,cos,0,0,0,1)}else{this.setTranslation(p.clone().multiplyScalar(-1));this.applyRotation(a);this.applyTranslation(p)}return this};Matrix3.prototype.setSkewX=function(a){var tan=Math.tan(a.radians);this.set(1,tan,0,0,1,0,0,0,1);return this};Matrix3.prototype.setSkewY=function(a){var tan=Math.tan(a.radians);this.set(1,0,0,tan,1,0,0,0,1);return this};Matrix3.prototype.applyTranslation=function(t){this.transform((new Matrix3).setTranslation(t));return this};Matrix3.prototype.applyScaling=function(s){this.transform((new Matrix3).setScaling(s));return this};Matrix3.prototype.applyRotation=function(a,p){this.transform((new Matrix3).setRotation(a,p));return this};Matrix3.prototype.applySkewX=function(a){this.transform((new Matrix3).setSkewX(a));return this};Matrix3.prototype.applySkewY=function(a){this.transform((new Matrix3).setSkewY(a));return this};Matrix3.prototype.determinant=function(){var el=this.elements;var a=el[0];var b=el[1];var c=el[2];var d=el[3];var e=el[4];var f=el[5];var g=el[6];var h=el[7];var i=el[8];return a*e*i-a*f*h-b*d*i+b*f*g+c*d*h-c*e*g};Matrix3.prototype.setToInverse=function(m){var det=m.determinant();if(det===0){throw new Error("Can not invert matrix because determinant is 0.")}var detInv=1/det;var me=m.elements;var a=me[0];var b=me[1];var c=me[2];var d=me[3];var e=me[4];var f=me[5];var g=me[6];var h=me[7];var i=me[8];this.set((i*e-f*h)*detInv,(c*h-i*b)*detInv,(f*b-c*e)*detInv,(f*g-i*d)*detInv,(i*a-c*g)*detInv,(c*d-f*a)*detInv,(h*d-e*g)*detInv,(b*g-h*a)*detInv,(e*a-b*d)*detInv);return this};return Matrix3}(observable_1.Observable);exports.Matrix3=Matrix3},{"@daign/observable":150}],139:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Polygon2=void 0;var line2_1=require("./line2");var ray2_1=require("./ray2");var vector2_1=require("./vector2");var vector2Array_1=require("./vector2Array");var Polygon2=function(_super){__extends(Polygon2,_super);function Polygon2(points){var _this=_super.call(this)||this;if(points){_this.elements=points}return _this}Object.defineProperty(Polygon2.prototype,"lengthOfOutline",{get:function(){var length=0;this.iterateLineSegments(function(line){length+=line.length});return length},enumerable:false,configurable:true});Polygon2.prototype.getBoxCenter=function(){return this.getBox().center};Polygon2.prototype.iterateLineSegments=function(callback){for(var i=0;i<this.length-1;i+=1){callback(new line2_1.Line2(this.getElement(i),this.getElement(i+1)),i)}if(this.length>1){callback(new line2_1.Line2(this.getElement(this.length-1),this.getElement(0)),this.length-1)}return this};Polygon2.prototype.isPointOnEdge=function(point){var pointIsOnEdge=false;this.iterateLineSegments(function(line){if(line.containsPointInSegment(point)){pointIsOnEdge=true}});return pointIsOnEdge};Polygon2.prototype.isPointInside=function(point){if(this.isPointOnEdge(point)){return true}var ray=new ray2_1.Ray2(point,new vector2_1.Vector2(1,0));var numberOfIntersections=0;this.iterateLineSegments(function(line){var intersectionPoint=ray.getLineSegmentIntersection(line);if(intersectionPoint!==null){if(intersectionPoint.closeTo(line.start)){if(ray.getSideOfPoint(line.end)===-1){numberOfIntersections+=1}}else if(intersectionPoint.closeTo(line.end)){if(ray.getSideOfPoint(line.start)===-1){numberOfIntersections+=1}}else{numberOfIntersections+=1}}});if(numberOfIntersections%2===1){return true}return false};Polygon2.prototype.isConvex=function(){var _this=this;var isConvex=true;var orientation=0;this.iterateLineSegments(function(line,index){var nextPoint=_this.getElement((index+2)%_this.length);var sideOfPoint=line.getSideOfPoint(nextPoint);if(orientation===0){orientation=sideOfPoint}else if(sideOfPoint!==0&&orientation!==sideOfPoint){isConvex=false}});return isConvex};Polygon2.prototype.isSelfIntersecting=function(){var _this=this;var isSelfIntersecting=false;this.iterateLineSegments(function(line1,index1){_this.iterateLineSegments(function(line2,index2){if(index1!==index2&&(index1-index2+_this.length)%_this.length>1&&(index2-index1+_this.length)%_this.length>1){var intersection=line1.getSegmentIntersection(line2);if(intersection!==null){isSelfIntersecting=true}}})});return isSelfIntersecting};return Polygon2}(vector2Array_1.Vector2Array);exports.Polygon2=Polygon2},{"./line2":136,"./ray2":140,"./vector2":146,"./vector2Array":147}],140:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Ray2=void 0;var observable_1=require("@daign/observable");var vector2_1=require("./vector2");var mathHelper_1=require("./mathHelper");var precision=1e-14;var Ray2=function(_super){__extends(Ray2,_super);function Ray2(origin,direction){var _this=_super.call(this)||this;_this._origin=origin||new vector2_1.Vector2;_this._direction=direction||new vector2_1.Vector2;var callback=function(){_this.notifyObservers()};_this._origin.subscribeToChanges(callback);_this._direction.subscribeToChanges(callback);return _this}Object.defineProperty(Ray2.prototype,"origin",{get:function(){return this._origin},enumerable:false,configurable:true});Object.defineProperty(Ray2.prototype,"direction",{get:function(){return this._direction},enumerable:false,configurable:true});Ray2.prototype.copy=function(r){this.origin.copy(r.origin);this.direction.copy(r.direction);return this};Ray2.prototype.clone=function(){return new Ray2(this.origin.clone(),this.direction.clone())};Ray2.prototype.isParallelToLine=function(l){var directionRay=this.direction;var directionLine=l.direction;return directionRay.x*directionLine.y===directionLine.x*directionRay.y};Ray2.prototype.isPerpendicularToLine=function(l){var directionRay=this.direction;var directionLine=l.direction;return directionRay.dot(directionLine)===0};Ray2.prototype.getLineSegmentIntersection=function(line){var pointOnRay=this.origin.clone().add(this.direction);var ax=this.origin.x;var ay=this.origin.y;var bx=pointOnRay.x;var by=pointOnRay.y;var cx=line.start.x;var cy=line.start.y;var dx=line.end.x;var dy=line.end.y;var n=(bx-ax)*(dy-cy)-(by-ay)*(dx-cx);if(n!==0){var s=((ax-cx)*(dy-cy)-(ay-cy)*(dx-cx))/-n;var t=((cx-ax)*(by-ay)-(cy-ay)*(bx-ax))/n;if(mathHelper_1.MathHelper.greaterOrCloseTo(s,0,precision)&&mathHelper_1.MathHelper.withinOrCloseToLimits(t,0,1,precision)){var x=ax+s*(bx-ax);var y=ay+s*(by-ay);return new vector2_1.Vector2(x,y)}}return null};Ray2.prototype.getSideOfPoint=function(point){var d=this.direction.cross(point.clone().sub(this.origin));if(mathHelper_1.MathHelper.closeTo(d,0,precision)){return 0}return Math.sign(d)};return Ray2}(observable_1.Observable);exports.Ray2=Ray2},{"./mathHelper":137,"./vector2":146,"@daign/observable":150}],141:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.StringArray=void 0;var genericArray_1=require("./genericArray");var StringArray=function(_super){__extends(StringArray,_super);function StringArray(){return _super.call(this)||this}StringArray.prototype.clone=function(){var arr=new StringArray;arr.elements=this.elements;return arr};StringArray.prototype.cloneDeep=function(){var arr=new StringArray;arr.elements=this.elements.map(function(element){return element.clone()});return arr};return StringArray}(genericArray_1.GenericArray);exports.StringArray=StringArray},{"./genericArray":134}],142:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.StringValue=void 0;var observable_1=require("@daign/observable");var StringValue=function(_super){__extends(StringValue,_super);function StringValue(value){var _this=_super.call(this)||this;_this._value=value||"";return _this}Object.defineProperty(StringValue.prototype,"value",{get:function(){return this._value},set:function(value){if(this._value!==value){this._value=value;this.notifyObservers()}},enumerable:false,configurable:true});StringValue.prototype.setSilent=function(value){this._value=value;return this};StringValue.prototype.clone=function(){return new StringValue(this.value)};StringValue.prototype.equals=function(s){return this.value===s.value};return StringValue}(observable_1.Observable);exports.StringValue=StringValue},{"@daign/observable":150}],143:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Triangle2=void 0;var observable_1=require("@daign/observable");var line2_1=require("./line2");var vector2_1=require("./vector2");var vector3_1=require("./vector3");var Triangle2=function(_super){__extends(Triangle2,_super);function Triangle2(a,b,c){var _this=_super.call(this)||this;_this._a=a||new vector2_1.Vector2;_this._b=b||new vector2_1.Vector2;_this._c=c||new vector2_1.Vector2;var callback=function(){_this.notifyObservers()};_this._a.subscribeToChanges(callback);_this._b.subscribeToChanges(callback);_this._c.subscribeToChanges(callback);return _this}Object.defineProperty(Triangle2.prototype,"a",{get:function(){return this._a},enumerable:false,configurable:true});Object.defineProperty(Triangle2.prototype,"b",{get:function(){return this._b},enumerable:false,configurable:true});Object.defineProperty(Triangle2.prototype,"c",{get:function(){return this._c},enumerable:false,configurable:true});Triangle2.prototype.copy=function(t){this.a.copy(t.a);this.b.copy(t.b);this.c.copy(t.c);return this};Triangle2.prototype.clone=function(){return new Triangle2(this.a.clone(),this.b.clone(),this.c.clone())};Triangle2.prototype.equals=function(t){return this.a.equals(t.a)&&this.b.equals(t.b)&&this.c.equals(t.c)};Triangle2.prototype.getBarycoord=function(p){var v0=this.b.clone().sub(this.a);var v1=this.c.clone().sub(this.a);var v2=p.clone().sub(this.a);var dot00=v0.dot(v0);var dot01=v0.dot(v1);var dot02=v0.dot(v2);var dot11=v1.dot(v1);var dot12=v1.dot(v2);var denom=dot00*dot11-dot01*dot01;if(denom===0){return null}var invDenom=1/denom;var u=(dot11*dot02-dot01*dot12)*invDenom;var v=(dot00*dot12-dot01*dot02)*invDenom;return new vector3_1.Vector3(1-u-v,v,u)};Triangle2.prototype.containsPoint=function(p){var barycoord=this.getBarycoord(p);if(barycoord!==null){return barycoord.x>=0&&barycoord.y>=0&&barycoord.x+barycoord.y<=1}return null};Triangle2.prototype.getCircumcenter=function(){var side1=this.b.clone().sub(this.a);var side2=this.c.clone().sub(this.a);var midpoint1=side1.clone().multiplyScalar(.5).add(this.a);var midpoint2=side2.clone().multiplyScalar(.5).add(this.a);var line1=new line2_1.Line2(midpoint1,side1.perpendicular().add(midpoint1));var line2=new line2_1.Line2(midpoint2,side2.perpendicular().add(midpoint2));return line1.getIntersection(line2)};return Triangle2}(observable_1.Observable);exports.Triangle2=Triangle2},{"./line2":136,"./vector2":146,"./vector3":148,"@daign/observable":150}],144:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Value=void 0;var vector1_1=require("./vector1");var Value=function(_super){__extends(Value,_super);function Value(x){return _super.call(this,x)||this}Value.prototype.getThis=function(){return this};Value.prototype.clone=function(){return new Value(this.x)};return Value}(vector1_1.Vector1);exports.Value=Value},{"./vector1":145}],145:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Vector1=void 0;var observable_1=require("@daign/observable");var mathHelper_1=require("./mathHelper");var Vector1=function(_super){__extends(Vector1,_super);function Vector1(x){var _this=_super.call(this)||this;_this._x=x||0;_this.snapshot=undefined;return _this}Object.defineProperty(Vector1.prototype,"x",{get:function(){return this._x},set:function(value){if(this._x!==value){this._x=value;this.notifyObservers()}},enumerable:false,configurable:true});Vector1.prototype.setSilent=function(x){this._x=x;return this.getThis()};Vector1.prototype.copy=function(v){this.x=v.x;return this.getThis()};Vector1.prototype.equals=function(v){return this.x===v.x};Vector1.prototype.closeTo=function(v,delta){return mathHelper_1.MathHelper.closeTo(this.x,v.x,delta)};Vector1.prototype.add=function(v){this.x=this.x+v.x;return this.getThis()};Vector1.prototype.sub=function(v){this.x=this.x-v.x;return this.getThis()};Vector1.prototype.multiplyScalar=function(s){this.x=this.x*s;return this.getThis()};Vector1.prototype.abs=function(){this.x=Math.abs(this.x);return this.getThis()};Vector1.prototype.round=function(precision){if(precision){var factor=Math.pow(10,precision);var x=Math.round((this.x+Number.EPSILON)*factor)/factor;this.x=x}else{this.x=Math.round(this.x)}return this.getThis()};Vector1.prototype.clamp=function(min,max){this.x=Math.max(min,Math.min(max,this.x));return this.getThis()};Vector1.prototype.snap=function(){this.snapshot=this.clone();return this.getThis()};Vector1.prototype.drag=function(v){if(this.snapshot!==undefined){this.x=this.snapshot.x+v}return this.getThis()};return Vector1}(observable_1.Observable);exports.Vector1=Vector1},{"./mathHelper":137,"@daign/observable":150}],146:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Vector2=void 0;var observable_1=require("@daign/observable");var angle_1=require("./angle");var mathHelper_1=require("./mathHelper");var Vector2=function(_super){__extends(Vector2,_super);function Vector2(x,y){var _this=_super.call(this)||this;_this._x=x||0;_this._y=y||0;_this.snapshot=undefined;return _this}Object.defineProperty(Vector2.prototype,"x",{get:function(){return this._x},set:function(value){if(this._x!==value){this._x=value;this.notifyObservers()}},enumerable:false,configurable:true});Object.defineProperty(Vector2.prototype,"y",{get:function(){return this._y},set:function(value){if(this._y!==value){this._y=value;this.notifyObservers()}},enumerable:false,configurable:true});Vector2.prototype.set=function(x,y){if(this._x!==x||this._y!==y){this._x=x;this._y=y;this.notifyObservers()}return this};Vector2.prototype.setX=function(value){this.x=value;return this};Vector2.prototype.setY=function(value){this.y=value;return this};Vector2.prototype.setSilent=function(x,y){this._x=x;this._y=y;return this};Vector2.prototype.setFromEvent=function(event){if(event&&event.clientX!==undefined&&event.clientY!==undefined){this.set(event.clientX,event.clientY);return this}else{this.setFromTouchEvent(event,0);return this}};Vector2.prototype.setFromEventRelative=function(event){if(event&&event.offsetX!==undefined&&event.offsetY!==undefined){this.set(event.offsetX,event.offsetY);return this}else{this.setFromTouchEventRelative(event,0);return this}};Vector2.prototype.setFromTouchEvent=function(event,touchIndex){if(event&&event.touches&&event.touches[touchIndex]&&event.touches[touchIndex].clientX!==undefined&&event.touches[touchIndex].clientY!==undefined){this.set(event.touches[touchIndex].clientX,event.touches[touchIndex].clientY);return this}else{throw new Error("Unable to extract position from event.")}};Vector2.prototype.setFromTouchEventRelative=function(event,touchIndex){if(!event||!event.target||!event.target.getBoundingClientRect||!event.touches||!event.touches[touchIndex]||event.touches[touchIndex].pageX===undefined||event.touches[touchIndex].pageY===undefined){throw new Error("Unable to extract position from event.")}var rect=event.target.getBoundingClientRect();if(!rect||rect.left===undefined||rect.top===undefined){throw new Error("Unable to extract position from event.")}var x=event.touches[touchIndex].pageX-rect.left;var y=event.touches[touchIndex].pageY-rect.top;this.set(x,y);return this};Vector2.prototype.setFromScrollEvent=function(event){if(!event||event.deltaX===undefined&&event.deltaY===undefined){throw new Error("Unable to extract scroll value from event.")}var delta=new Vector2;if(event.deltaX!==undefined){delta.x=event.deltaX}if(event.deltaY!==undefined){delta.y=event.deltaY}this.copy(delta);return this};Vector2.prototype.copy=function(v){this.set(v.x,v.y);return this};Vector2.prototype.copySilent=function(v){this.setSilent(v.x,v.y);return this};Vector2.prototype.clone=function(){return new Vector2(this.x,this.y)};Vector2.prototype.equals=function(v){return this.x===v.x&&this.y===v.y};Vector2.prototype.closeTo=function(v,delta){return mathHelper_1.MathHelper.closeTo(this.x,v.x,delta)&&mathHelper_1.MathHelper.closeTo(this.y,v.y,delta)};Vector2.prototype.add=function(v){this.set(this.x+v.x,this.y+v.y);return this};Vector2.prototype.sub=function(v){this.set(this.x-v.x,this.y-v.y);return this};Vector2.prototype.multiply=function(v){this.set(this.x*v.x,this.y*v.y);return this};Vector2.prototype.divide=function(v){this.set(this.x/v.x,this.y/v.y);return this};Vector2.prototype.addScalar=function(s){this.set(this.x+s,this.y+s);return this};Vector2.prototype.multiplyScalar=function(s){this.set(this.x*s,this.y*s);return this};Vector2.prototype.modulo=function(s){this.set(this.x%s,this.y%s);return this};Vector2.prototype.transform=function(m){var a=m.elements;var x=a[0]*this.x+a[1]*this.y+a[2];var y=a[3]*this.x+a[4]*this.y+a[5];var w=a[6]*this.x+a[7]*this.y+a[8];this.set(x/w,y/w);return this};Vector2.prototype.min=function(v){this.set(Math.min(this.x,v.x),Math.min(this.y,v.y));return this};Vector2.prototype.max=function(v){this.set(Math.max(this.x,v.x),Math.max(this.y,v.y));return this};Vector2.prototype.abs=function(){this.set(Math.abs(this.x),Math.abs(this.y));return this};Vector2.prototype.round=function(precision){if(precision){var factor=Math.pow(10,precision);var x=Math.round((this.x+Number.EPSILON)*factor)/factor;var y=Math.round((this.y+Number.EPSILON)*factor)/factor;this.set(x,y)}else{this.set(Math.round(this.x),Math.round(this.y))}return this};Vector2.prototype.floor=function(){this.set(Math.floor(this.x),Math.floor(this.y));return this};Vector2.prototype.ceil=function(){this.set(Math.ceil(this.x),Math.ceil(this.y));return this};Vector2.prototype.clampInBox=function(b){this.min(b.max);this.max(b.min);return this};Vector2.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};Vector2.prototype.normalize=function(){var length=this.length();if(length!==0){this.multiplyScalar(1/length)}return this};Vector2.prototype.setLength=function(l){var oldLength=this.length();if(oldLength!==0){this.multiplyScalar(l/oldLength)}return this};Vector2.prototype.distanceTo=function(v){return Math.sqrt(Math.pow(this.x-v.x,2)+Math.pow(this.y-v.y,2))};Vector2.prototype.angle=function(){var angle=Math.atan2(this.y,this.x);if(angle<0){angle+=2*Math.PI}return new angle_1.Angle(angle)};Vector2.prototype.setAngle=function(a){var length=this.length();var x=Math.cos(a.radians);var y=Math.sin(a.radians);var v=new Vector2(x,y);v.setLength(length);this.copy(v);return this};Vector2.prototype.rotate=function(a){var endAngle=this.angle().add(a);this.setAngle(endAngle);return this};Vector2.prototype.angleTo=function(v){return v.angle().sub(this.angle()).normalize()};Vector2.prototype.dot=function(v){return this.x*v.x+this.y*v.y};Vector2.prototype.cross=function(v){return this.x*v.y-this.y*v.x};Vector2.prototype.snap=function(){this.snapshot=this.clone();return this};Vector2.prototype.drag=function(v){if(this.snapshot!==undefined){this.copy(this.snapshot.clone().add(v))}return this};Vector2.prototype.projectOnLine=function(l){var support=this.clone().sub(l.start);var direction=l.end.clone().sub(l.start);var directionN=direction.clone().normalize();var d=support.dot(directionN);return directionN.clone().multiplyScalar(d).add(l.start)};Vector2.prototype.projectOnLineSegment=function(l){var support=this.clone().sub(l.start);var direction=l.end.clone().sub(l.start);var directionN=direction.clone().normalize();var d=support.dot(directionN);if(mathHelper_1.MathHelper.withinOrCloseToLimits(d,0,direction.length())){return directionN.clone().multiplyScalar(d).add(l.start)}else{return null}};Vector2.prototype.perpendicular=function(){return new Vector2(this.y,-this.x)};return Vector2}(observable_1.Observable);exports.Vector2=Vector2},{"./angle":131,"./mathHelper":137,"@daign/observable":150}],147:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Vector2Array=void 0;var box2_1=require("./box2");var genericArray_1=require("./genericArray");var vector2_1=require("./vector2");var Vector2Array=function(_super){__extends(Vector2Array,_super);function Vector2Array(){return _super.call(this)||this}Vector2Array.prototype.initializeElements=function(n){var elements=[];for(var i=0;i<n;i+=1){elements.push(new vector2_1.Vector2)}this.elements=elements;return this};Vector2Array.prototype.copyElementWise=function(arr){if(this.length!==arr.length){throw new Error("Array lengths do not match.")}this.iterate(function(element,index){var sourceElement=arr.getElement(index);element.copy(sourceElement)});return this};Vector2Array.prototype.clone=function(){var arr=new Vector2Array;arr.elements=this.elements;return arr};Vector2Array.prototype.cloneDeep=function(){var arr=new Vector2Array;arr.elements=this.elements.map(function(element){return element.clone()});return arr};Vector2Array.prototype.transform=function(m){this.iterate(function(element){element.transform(m)});return this};Vector2Array.prototype.getBox=function(){var box=new box2_1.Box2;this.elements.forEach(function(element){box.expandByPoint(element)});return box};return Vector2Array}(genericArray_1.GenericArray);exports.Vector2Array=Vector2Array},{"./box2":132,"./genericArray":134,"./vector2":146}],148:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Vector3=void 0;var observable_1=require("@daign/observable");var Vector3=function(_super){__extends(Vector3,_super);function Vector3(x,y,z){var _this=_super.call(this)||this;_this._x=x||0;_this._y=y||0;_this._z=z||0;return _this}Object.defineProperty(Vector3.prototype,"x",{get:function(){return this._x},set:function(value){if(this._x!==value){this._x=value;this.notifyObservers()}},enumerable:false,configurable:true});Object.defineProperty(Vector3.prototype,"y",{get:function(){return this._y},set:function(value){if(this._y!==value){this._y=value;this.notifyObservers()}},enumerable:false,configurable:true});Object.defineProperty(Vector3.prototype,"z",{get:function(){return this._z},set:function(value){if(this._z!==value){this._z=value;this.notifyObservers()}},enumerable:false,configurable:true});Vector3.prototype.set=function(x,y,z){if(this._x!==x||this._y!==y||this._z!==z){this._x=x;this._y=y;this._z=z;this.notifyObservers()}return this};Vector3.prototype.setSilent=function(x,y,z){this._x=x;this._y=y;this._z=z;return this};Vector3.prototype.copy=function(v){this.set(v.x,v.y,v.z);return this};Vector3.prototype.clone=function(){return new Vector3(this.x,this.y,this.z)};Vector3.prototype.equals=function(v){return this.x===v.x&&this.y===v.y&&this.z===v.z};Vector3.prototype.add=function(v){this.set(this.x+v.x,this.y+v.y,this.z+v.z);return this};Vector3.prototype.sub=function(v){this.set(this.x-v.x,this.y-v.y,this.z-v.z);return this};Vector3.prototype.multiply=function(v){this.set(this.x*v.x,this.y*v.y,this.z*v.z);return this};Vector3.prototype.divide=function(v){this.set(this.x/v.x,this.y/v.y,this.z/v.z);return this};Vector3.prototype.addScalar=function(s){this.set(this.x+s,this.y+s,this.z+s);return this};Vector3.prototype.multiplyScalar=function(s){this.set(this.x*s,this.y*s,this.z*s);return this};Vector3.prototype.min=function(v){this.set(Math.min(this.x,v.x),Math.min(this.y,v.y),Math.min(this.z,v.z));return this};Vector3.prototype.max=function(v){this.set(Math.max(this.x,v.x),Math.max(this.y,v.y),Math.max(this.z,v.z));return this};return Vector3}(observable_1.Observable);exports.Vector3=Vector3},{"@daign/observable":150}],149:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.EventEmitter=void 0;var observable_1=require("./observable");var EventEmitter=function(_super){__extends(EventEmitter,_super);function EventEmitter(){return _super.call(this)||this}EventEmitter.prototype.emit=function(){this.notifyObservers()};return EventEmitter}(observable_1.Observable);exports.EventEmitter=EventEmitter},{"./observable":151}],150:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.UnicastObservable=exports.UnicastEventEmitter=exports.Observable=exports.EventEmitter=void 0;var eventEmitter_1=require("./eventEmitter");Object.defineProperty(exports,"EventEmitter",{enumerable:true,get:function(){return eventEmitter_1.EventEmitter}});var observable_1=require("./observable");Object.defineProperty(exports,"Observable",{enumerable:true,get:function(){return observable_1.Observable}});var unicastEventEmitter_1=require("./unicastEventEmitter");Object.defineProperty(exports,"UnicastEventEmitter",{enumerable:true,get:function(){return unicastEventEmitter_1.UnicastEventEmitter}});var unicastObservable_1=require("./unicastObservable");Object.defineProperty(exports,"UnicastObservable",{enumerable:true,get:function(){return unicastObservable_1.UnicastObservable}})},{"./eventEmitter":149,"./observable":151,"./unicastEventEmitter":152,"./unicastObservable":153}],151:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Observable=void 0;var Observable=function(){function Observable(){this.listeners=[]}Observable.prototype.subscribeToChanges=function(callback){var _this=this;this.listeners.push(callback);return function(){var i=_this.listeners.indexOf(callback);if(i>-1){_this.listeners.splice(i,1)}}};Observable.prototype.notifyObservers=function(){this.listeners.forEach(function(callback){callback()})};Observable.prototype.clearObservers=function(){this.listeners=[]};return Observable}();exports.Observable=Observable},{}],152:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.UnicastEventEmitter=void 0;var unicastObservable_1=require("./unicastObservable");var UnicastEventEmitter=function(_super){__extends(UnicastEventEmitter,_super);function UnicastEventEmitter(){return _super.call(this)||this}UnicastEventEmitter.prototype.emit=function(){this.notifyObserver()};return UnicastEventEmitter}(unicastObservable_1.UnicastObservable);exports.UnicastEventEmitter=UnicastEventEmitter},{"./unicastObservable":153}],153:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.UnicastObservable=void 0;var UnicastObservable=function(){function UnicastObservable(){this.listener=null}UnicastObservable.prototype.setObserver=function(callback){this.listener=callback};UnicastObservable.prototype.notifyObserver=function(){if(this.listener){this.listener()}};UnicastObservable.prototype.clearObserver=function(){this.listener=null};return UnicastObservable}();exports.UnicastObservable=UnicastObservable},{}],154:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Schedule=void 0;var schedule_1=require("./schedule");Object.defineProperty(exports,"Schedule",{enumerable:true,get:function(){return schedule_1.Schedule}})},{"./schedule":155}],155:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Schedule=void 0;var Schedule=function(){function Schedule(){}Schedule.postpone=function(callback,wait,context){if(context===void 0){context=null}return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}setTimeout(function(){callback.apply(context,args)},wait)}};Schedule.blockingThrottle=function(callback,wait,context){if(context===void 0){context=null}var blocked=false;return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}if(!blocked){blocked=true;callback.apply(context,args);setTimeout(function(){blocked=false},wait)}}};Schedule.deferringThrottle=function(callback,wait,context){if(context===void 0){context=null}var blocked=false;var deferredCalls=false;var lastArgs;var execute=function(args){callback.apply(context,args);setTimeout(function(){if(deferredCalls){deferredCalls=false;execute(lastArgs)}else{blocked=false}},wait)};return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}if(blocked){lastArgs=args;deferredCalls=true}else{blocked=true;deferredCalls=false;execute(args)}}};return Schedule}();exports.Schedule=Schedule},{}],156:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.StyleSheet=exports.StyleSelectorChain=exports.StyleSelector=exports.StyleRule=exports.StyleProcessor=void 0;var styleProcessor_1=require("./styleProcessor");Object.defineProperty(exports,"StyleProcessor",{enumerable:true,get:function(){return styleProcessor_1.StyleProcessor}});var styleRule_1=require("./styleRule");Object.defineProperty(exports,"StyleRule",{enumerable:true,get:function(){return styleRule_1.StyleRule}});var styleSelector_1=require("./styleSelector");Object.defineProperty(exports,"StyleSelector",{enumerable:true,get:function(){return styleSelector_1.StyleSelector}});var styleSelectorChain_1=require("./styleSelectorChain");Object.defineProperty(exports,"StyleSelectorChain",{enumerable:true,get:function(){return styleSelectorChain_1.StyleSelectorChain}});var styleSheet_1=require("./styleSheet");Object.defineProperty(exports,"StyleSheet",{enumerable:true,get:function(){return styleSheet_1.StyleSheet}})},{"./styleProcessor":157,"./styleRule":158,"./styleSelector":159,"./styleSelectorChain":160,"./styleSheet":161}],157:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.StyleProcessor=void 0;var StyleProcessor=function(){function StyleProcessor(){}StyleProcessor.prototype.calculateStyle=function(styleSheet,selectorChain,declarationType,elementStyle){var result=new declarationType;if(elementStyle){result.complementWith(elementStyle)}var _loop_1=function(i){var subChain=selectorChain.clone().dropSelectors(i);styleSheet.forEach(function(rule){if(subChain.matchFromEnd(rule.selectorChain)){result.complementWith(rule.declaration)}})};for(var i=0;i<selectorChain.length;i+=1){_loop_1(i)}return result};return StyleProcessor}();exports.StyleProcessor=StyleProcessor},{}],158:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.StyleRule=void 0;var StyleRule=function(){function StyleRule(selectorChain,declaration){this.selectorChain=selectorChain;this.declaration=declaration}StyleRule.prototype.comparePriority=function(secondRule){return this.selectorChain.comparePriority(secondRule.selectorChain)};return StyleRule}();exports.StyleRule=StyleRule},{}],159:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.StyleSelector=void 0;var StyleSelector=function(){function StyleSelector(s){this.classNames=[];if(s&&s.charAt(0)==="."){this.classNames=s.split(".").slice(1)}}StyleSelector.prototype.match=function(selector){var _this=this;if(selector.classNames.length>0){return selector.classNames.every(function(name){return _this.classNames.indexOf(name)!==-1})}else{return false}};StyleSelector.prototype.comparePriority=function(selector){var sign=function(x){return Number(x>0)-Number(x<0)};return sign(this.classNames.length-selector.classNames.length)};StyleSelector.prototype.printSelector=function(){return this.classNames.map(function(item){return".".concat(item)}).join("")};StyleSelector.prototype.printSelectorSpaced=function(){return this.classNames.join(" ")};return StyleSelector}();exports.StyleSelector=StyleSelector},{}],160:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.StyleSelectorChain=void 0;var StyleSelectorChain=function(){function StyleSelectorChain(){this.chain=[]}Object.defineProperty(StyleSelectorChain.prototype,"length",{get:function(){return this.chain.length},enumerable:false,configurable:true});StyleSelectorChain.prototype.clone=function(){var newChain=new StyleSelectorChain;newChain.chain=this.chain.slice();return newChain};StyleSelectorChain.prototype.addSelector=function(selector){this.chain.push(selector);return this};StyleSelectorChain.prototype.addSelectorToFront=function(selector){this.chain.unshift(selector);return this};StyleSelectorChain.prototype.dropSelectors=function(n){if(n>0){this.chain.splice(this.length-n,n)}return this};StyleSelectorChain.prototype.getSelector=function(index){if(index>=this.length){throw new Error("Selector index out of bounds.")}return this.chain[index]};StyleSelectorChain.prototype.matchFromEnd=function(ruleChain){if(this.length===0||ruleChain.length===0){return false}var ruleIndex=ruleChain.length-1;var endSelector=this.getSelector(this.length-1);if(!endSelector.match(ruleChain.getSelector(ruleIndex))){return false}for(var i=0;i<this.length;i+=1){var selector=this.getSelector(this.length-i-1);if(selector.match(ruleChain.getSelector(ruleIndex))){ruleIndex-=1;if(ruleIndex===-1){return true}}}return false};StyleSelectorChain.prototype.comparePriority=function(secondChain){var sign=function(x){return Number(x>0)-Number(x<0)};var result=sign(this.length-secondChain.length);if(result===0){for(var i=0;i<this.length;i+=1){var index=this.length-i-1;var innerResult=this.getSelector(index).comparePriority(secondChain.getSelector(index));if(innerResult!==0){return innerResult}}}return result};StyleSelectorChain.prototype.printSelectorChain=function(){return this.chain.map(function(selector){return selector.printSelector()}).join(" ")};return StyleSelectorChain}();exports.StyleSelectorChain=StyleSelectorChain},{}],161:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.StyleSheet=void 0;var styleRule_1=require("./styleRule");var styleSelector_1=require("./styleSelector");var styleSelectorChain_1=require("./styleSelectorChain");var selectorExpression=/^\s*(\.[a-z][\.\w\-]*)\ \{$/;var attributeExpression=/^\s*([a-z][a-z\-]*)\:\ (.+)\;$/;var ruleEndExpression=/^\s*\}$/;var commentExpression=/^\s*\/\/\ .+$/;var emptyLineExpression=/^\s*$/;var StyleSheet=function(){function StyleSheet(){this.rules=[]}StyleSheet.prototype.forEach=function(callback){this.rules.forEach(callback)};StyleSheet.prototype.parseFromString=function(input,declarationType){var _this=this;var lines=input.split("\n");var selectorChainStack=[new styleSelectorChain_1.StyleSelectorChain];var declarationStack=[];lines.forEach(function(line,index){var selectorMatch=line.match(selectorExpression);var attributeMatch=line.match(attributeExpression);var ruleEndMatch=line.match(ruleEndExpression);var commentMatch=line.match(commentExpression);var emptyLineMatch=line.match(emptyLineExpression);if(selectorMatch!==null){var selector=new styleSelector_1.StyleSelector(selectorMatch[1]);var newChain=selectorChainStack[0].clone().addSelector(selector);selectorChainStack.unshift(newChain);var newDeclaration=new declarationType;declarationStack.unshift(newDeclaration)}else if(attributeMatch!==null){var currentDeclaration=declarationStack[0];currentDeclaration.parseAttribute(attributeMatch[1],attributeMatch[2])}else if(ruleEndMatch!==null){var currentChain=selectorChainStack.shift();var currentDeclaration=declarationStack.shift();if(currentChain&&currentDeclaration){if(!currentDeclaration.isEmpty){var newRule=new styleRule_1.StyleRule(currentChain,currentDeclaration);_this.addRule(newRule)}}else{throw new Error("Too many closing brackets in style sheet.")}}else if(commentMatch!==null){}else if(emptyLineMatch!==null){}else{throw new Error("Line ".concat(index+1," in style sheet could not be parsed."))}});if(selectorChainStack.length>1&&declarationStack.length>0){throw new Error("Missing closing brackets in style sheet.")}};StyleSheet.prototype.addRule=function(rule){var index=0;var indexLimit=this.rules.length;var isLess=-1;while(index<indexLimit&&rule.comparePriority(this.rules[index])===isLess){index+=1}this.rules.splice(index,0,rule)};StyleSheet.prototype.printStyleSheet=function(){return this.rules.map(function(rule){return"".concat(rule.selectorChain.printSelectorChain()," {").concat(rule.declaration.printStyle(),"}")}).join("\n")};return StyleSheet}();exports.StyleSheet=StyleSheet},{"./styleRule":158,"./styleSelector":159,"./styleSelectorChain":160}]},{},[12])(12)});
